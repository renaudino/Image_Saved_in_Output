<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="32,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T2U3">Pbreak</span> = Breakthrough(<span class="var type1" id="S3T27U6">face</span>, <span class="var type1" id="S4T2U7">Pnneg_re</span>, <span class="var type1" id="S5T2U8">Pnpos_re</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="32,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% Calculates the breakthrough point in the face                                </span></span></span>
<span class="srcline"><span class="lineno"><a href="32,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% Pneg : point on the negative normal vector side                          </span></span></span>
<span class="srcline"><span class="lineno"><a href="32,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% Ppos : point on the positive normal vector side </span></span></span>
<span class="srcline"><span class="lineno"><a href="32,5" id="srcline5"> 5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="32,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% Authors: Francesco Mani &lt;francesco.mani@uclouvain.be&gt; and Mingming Gan &lt;gan@ftw.at&gt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="32,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">% History:  2011.9.19</span></span></span>
<span class="srcline"><span class="lineno"><a href="32,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="32,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% Updated by: Xuhong Li &lt;xuhong@ftw.at&gt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="32,10" id="srcline10">10</a></span><span class="line"><span class="comment">% History: 2013.08.01</span></span></span>
<span class="srcline"><span class="lineno"><a href="32,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="32,12" id="srcline12">12</a></span><span class="line"><span class="keyword">global</span> <span class="var type2" id="S6T0U10">wedges</span> <span class="var type2" id="S7T0U11">vnfaces</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo" id="T2:U5"><span class="var type1" id="S8T2U14">wedges_re</span> = <span class="mxinfo" id="T2:U7">zeros(<span class="mxinfo" id="T3:U8">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo" id="T2:U9"><span class="var type1" id="S10T2U21">Pnneg</span> = <span class="var type1" id="S4T2U22">Pnneg_re</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo" id="T2:U12"><span class="var type1" id="S11T2U25">Pnpos</span> = <span class="var type1" id="S5T2U26">Pnpos_re</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo" id="T2:U15"><span class="var type1" id="S2T2U29">Pbreak</span> = <span class="mxinfo" id="T2:U17">zeros(<span class="mxinfo" id="T3:U18">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo" id="T2:U19"><span class="var type1" id="S12T2U36">n</span> = <span class="mxinfo" id="T2:U21">zeros(<span class="mxinfo" id="T3:U22">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo" id="T2:U23"><span class="var type1" id="S13T2U43">rp</span> = <span class="mxinfo" id="T2:U25">zeros(<span class="mxinfo" id="T3:U26">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo" id="T2:U27"><span class="var type1" id="S14T2U50">ri</span> = <span class="mxinfo" id="T2:U29">zeros(<span class="mxinfo" id="T3:U30">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,20" id="srcline20">20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="32,21" id="srcline21">21</a></span><span class="line"><span class="comment">% if(face(1) == 0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="32,22" id="srcline22">22</a></span><span class="line"><span class="keyword">if</span>(<span class="mxinfo" id="T16:U31"><span class="mxinfo" id="T3:U32"><span class="var type1" id="S3T27U61">face</span>(<span class="mxinfo" id="T3:U34">1</span>)</span> == <span class="mxinfo" id="T3:U35">0</span></span> &amp;&amp; <span class="mxinfo" id="T16:U36"><span class="mxinfo" id="T3:U37"><span class="var type1" id="S3T27U66">face</span>(<span class="mxinfo" id="T3:U39">2</span>)</span> == <span class="mxinfo" id="T3:U40">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="32,23" id="srcline23">23</a></span><span class="line">    <span class="mxinfo" id="T2:U41"><span class="var type1" id="S12T2U71">n</span> = <span class="mxinfo" id="T2:U43">[<span class="mxinfo" id="T3:U44">0</span>;<span class="mxinfo" id="T3:U45">0</span>;<span class="mxinfo" id="T3:U46">1</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,24" id="srcline24">24</a></span><span class="line">    <span class="mxinfo" id="T2:U47"><span class="mxinfo" id="T2:U48"><span class="var type1" id="S13T2U82">rp</span>(:,<span class="mxinfo" id="T3:U50">1</span>)</span> = <span class="mxinfo" id="T2:U51">-<span class="mxinfo" id="T2:U52"><span class="var type1" id="S11T2U87">Pnpos</span>(:,<span class="mxinfo" id="T3:U54">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,25" id="srcline25">25</a></span><span class="line">    <span class="mxinfo" id="T2:U55"><span class="mxinfo" id="T2:U56"><span class="var type1" id="S14T2U93">ri</span>(:,<span class="mxinfo" id="T3:U58">1</span>)</span> = <span class="mxinfo" id="T2:U59"><span class="mxinfo" id="T2:U60"><span class="var type1" id="S10T2U98">Pnneg</span>(:,<span class="mxinfo" id="T3:U62">1</span>)</span> - <span class="mxinfo" id="T2:U63"><span class="var type1" id="S11T2U102">Pnpos</span>(:,<span class="mxinfo" id="T3:U65">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,26" id="srcline26">26</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="32,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo" id="T2:U66"><span class="mxinfo" id="T2:U67"><span class="var type1" id="S12T2U109">n</span>(:,<span class="mxinfo" id="T3:U69">1</span>)</span> = <span class="mxinfo" id="T38:U70"><span class="var type1" id="S7T1U113">vnfaces</span>(<span class="mxinfo" id="T3:U72"><span class="var type1" id="S3T27U115">face</span>(<span class="mxinfo" id="T3:U74">1</span>)</span>,<span class="mxinfo" id="T3:U75"><span class="var type1" id="S3T27U118">face</span>(<span class="mxinfo" id="T3:U77">2</span>)</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo" id="T2:U78"><span class="mxinfo" id="T2:U79"><span class="var type1" id="S8T2U124">wedges_re</span>(:,<span class="mxinfo" id="T3:U81">1</span>)</span> = <span class="mxinfo" id="T18:U82"><span class="var type1" id="S6T8U128">wedges</span>(<span class="mxinfo" id="T3:U84"><span class="var type1" id="S3T27U130">face</span>(<span class="mxinfo" id="T3:U86">1</span>)</span>,<span class="mxinfo" id="T3:U87"><span class="var type1" id="S3T27U133">face</span>(<span class="mxinfo" id="T3:U89">2</span>)</span>,<span class="mxinfo" id="T3:U90">3</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo" id="T2:U91"><span class="mxinfo" id="T2:U92"><span class="var type1" id="S13T2U140">rp</span>(:,<span class="mxinfo" id="T3:U94">1</span>)</span> = <span class="mxinfo" id="T2:U95"><span class="var type1" id="S8T2U144">wedges_re</span> - <span class="mxinfo" id="T2:U97"><span class="var type1" id="S11T2U146">Pnpos</span>(:,<span class="mxinfo" id="T3:U99">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo" id="T2:U100"><span class="mxinfo" id="T2:U101"><span class="var type1" id="S14T2U152">ri</span>(:,<span class="mxinfo" id="T3:U103">1</span>)</span> = <span class="mxinfo" id="T2:U104"><span class="mxinfo" id="T2:U105"><span class="var type1" id="S10T2U157">Pnneg</span>(:,<span class="mxinfo" id="T3:U107">1</span>)</span> - <span class="mxinfo" id="T2:U108"><span class="var type1" id="S11T2U161">Pnpos</span>(:,<span class="mxinfo" id="T3:U110">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,31" id="srcline31">31</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="32,32" id="srcline32">32</a></span><span class="line"><span class="comment">%num = dot(n,rp);</span></span></span>
<span class="srcline"><span class="lineno"><a href="32,33" id="srcline33">33</a></span><span class="line"><span class="comment">%den = dot(n,ri);</span></span></span>
<span class="srcline"><span class="lineno"><a href="32,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo" id="T3:U111"><span class="var type1" id="S15T3U166">num</span> = <span class="mxinfo" id="T3:U113"><span class="mxinfo" id="T19:U114"><span class="var type1" id="S12T2U169">n</span>'</span>*<span class="var type1" id="S13T2U170">rp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo" id="T3:U117"><span class="var type1" id="S16T3U173">den</span> = <span class="mxinfo" id="T3:U119"><span class="mxinfo" id="T19:U120"><span class="var type1" id="S12T2U176">n</span>'</span>*<span class="var type1" id="S14T2U177">ri</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo" id="T2:U123"><span class="mxinfo" id="T2:U124"><span class="var type1" id="S2T2U181">Pbreak</span>(:,<span class="mxinfo" id="T3:U126">1</span>)</span> = <span class="mxinfo" id="T2:U127"><span class="mxinfo" id="T2:U128"><span class="var type1" id="S11T2U186">Pnpos</span>(:,<span class="mxinfo" id="T3:U130">1</span>)</span> + <span class="mxinfo" id="T2:U131">(<span class="mxinfo" id="T3:U132"><span class="var type1" id="S15T3U192">num</span>/<span class="var type1" id="S16T3U193">den</span></span>)*<span class="mxinfo" id="T2:U135"><span class="var type1" id="S14T2U195">ri</span>(:,<span class="mxinfo" id="T3:U137">1</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="32,37" id="srcline37">37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="32,38" id="srcline38">38</a></span><span class="line">      </span></span>
</pre>
