<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="35,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T3U3">appface</span> = AppFace(<span class="var type1" id="S3T2U6">point_re</span>,<span class="var type1" id="S4T30U7">face</span>) <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% Calculates if the point belongs to the face</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,3" id="srcline3"> 3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% Authors: Francesco Mani &lt;francesco.mani@uclouvain.be&gt; and Mingming Gan &lt;gan@ftw.at&gt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% History:  2011.9.19</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,6" id="srcline6"> 6</a></span><span class="line"><span class="keyword">global</span> <span class="var type2" id="S5T0U9">wedges</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,7" id="srcline7"> 7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo" id="T2:U4"><span class="var type1" id="S6T2U12">point</span> = <span class="mxinfo" id="T2:U6">reshape(<span class="var type1" id="S3T2U15">point_re</span>,3,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo" id="T2:U8"><span class="var type1" id="S8T2U20">VectP1</span> = <span class="mxinfo" id="T2:U10">zeros(<span class="mxinfo" id="T3:U11">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo" id="T2:U12"><span class="var type1" id="S10T2U27">VectP2</span> = <span class="mxinfo" id="T2:U14">zeros(<span class="mxinfo" id="T3:U15">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,11" id="srcline11">11</a></span><span class="line"><span class="mxinfo" id="T2:U16"><span class="var type1" id="S11T2U34">VectP4</span> = <span class="mxinfo" id="T2:U18">zeros(<span class="mxinfo" id="T3:U19">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo" id="T2:U20"><span class="var type1" id="S12T2U41">u</span> = <span class="mxinfo" id="T2:U22">zeros(<span class="mxinfo" id="T3:U23">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo" id="T2:U24"><span class="var type1" id="S13T2U48">v</span> = <span class="mxinfo" id="T2:U26">zeros(<span class="mxinfo" id="T3:U27">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,14" id="srcline14">14</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,15" id="srcline15">15</a></span><span class="line"><span class="comment">%p1(:,1) = wedges(face(1),face(2),1,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,16" id="srcline16">16</a></span><span class="line"><span class="comment">%p2(:,1) = wedges(face(1),face(2),2,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,17" id="srcline17">17</a></span><span class="line"><span class="comment">%p3(:,1) = wedges(face(1),face(2),4,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,18" id="srcline18">18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo" id="T2:U28"><span class="var type1" id="S14T2U55">p1</span> = <span class="mxinfo" id="T2:U30">reshape(<span class="mxinfo" id="T18:U31"><span class="var type1" id="S5T8U59">wedges</span>(<span class="mxinfo" id="T3:U33"><span class="var type1" id="S4T30U61">face</span>(<span class="mxinfo" id="T3:U35">1</span>)</span>,<span class="mxinfo" id="T3:U36"><span class="var type1" id="S4T30U64">face</span>(<span class="mxinfo" id="T3:U38">2</span>)</span>,<span class="mxinfo" id="T3:U39">1</span>,:)</span>,3,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo" id="T2:U40"><span class="var type1" id="S15T2U72">p2</span> = <span class="mxinfo" id="T2:U42">reshape(<span class="mxinfo" id="T18:U43"><span class="var type1" id="S5T8U76">wedges</span>(<span class="mxinfo" id="T3:U45"><span class="var type1" id="S4T30U78">face</span>(<span class="mxinfo" id="T3:U47">1</span>)</span>,<span class="mxinfo" id="T3:U48"><span class="var type1" id="S4T30U81">face</span>(<span class="mxinfo" id="T3:U50">2</span>)</span>,<span class="mxinfo" id="T3:U51">2</span>,:)</span>,3,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo" id="T2:U52"><span class="var type1" id="S16T2U89">p3</span> = <span class="mxinfo" id="T2:U54">reshape(<span class="mxinfo" id="T18:U55"><span class="var type1" id="S5T8U93">wedges</span>(<span class="mxinfo" id="T3:U57"><span class="var type1" id="S4T30U95">face</span>(<span class="mxinfo" id="T3:U59">1</span>)</span>,<span class="mxinfo" id="T3:U60"><span class="var type1" id="S4T30U98">face</span>(<span class="mxinfo" id="T3:U62">2</span>)</span>,<span class="mxinfo" id="T3:U63">4</span>,:)</span>,3,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,22" id="srcline22">22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,23" id="srcline23">23</a></span><span class="line"><span class="comment">%u(:,1) = wedges(face(1),face(2),2,:) - wedges(face(1),face(2),1,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,24" id="srcline24">24</a></span><span class="line"><span class="comment">%v(:,1) = wedges(face(1),face(2),4,:) - wedges(face(1),face(2),1,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo" id="T2:U64"><span class="mxinfo" id="T2:U65"><span class="var type1" id="S12T2U107">u</span>(:,<span class="mxinfo" id="T3:U67">1</span>)</span> = <span class="mxinfo" id="T2:U68"><span class="var type1" id="S15T2U111">p2</span> - <span class="var type1" id="S14T2U112">p1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo" id="T2:U71"><span class="mxinfo" id="T2:U72"><span class="var type1" id="S13T2U116">v</span>(:,<span class="mxinfo" id="T3:U74">1</span>)</span> = <span class="mxinfo" id="T2:U75"><span class="var type1" id="S16T2U120">p3</span> - <span class="var type1" id="S14T2U121">p1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,27" id="srcline27">27</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="35,28" id="srcline28">28</a></span><span class="line"><span class="mxinfo" id="T2:U78"><span class="mxinfo" id="T2:U79"><span class="var type1" id="S8T2U125">VectP1</span>(:,<span class="mxinfo" id="T3:U81">1</span>)</span> = <span class="mxinfo" id="T2:U82"><span class="var type1" id="S14T2U129">p1</span> - <span class="var type1" id="S6T2U130">point</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,29" id="srcline29">29</a></span><span class="line"><span class="mxinfo" id="T2:U85"><span class="mxinfo" id="T2:U86"><span class="var type1" id="S10T2U134">VectP2</span>(:,<span class="mxinfo" id="T3:U88">1</span>)</span> = <span class="mxinfo" id="T2:U89"><span class="var type1" id="S15T2U138">p2</span> - <span class="var type1" id="S6T2U139">point</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo" id="T2:U92"><span class="mxinfo" id="T2:U93"><span class="var type1" id="S11T2U143">VectP4</span>(:,<span class="mxinfo" id="T3:U95">1</span>)</span> = <span class="mxinfo" id="T2:U96"><span class="var type1" id="S16T2U147">p3</span> - <span class="var type1" id="S6T2U148">point</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,31" id="srcline31">31</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,32" id="srcline32">32</a></span><span class="line"><span class="comment">%resu1 = dot(VectP1,u);</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,33" id="srcline33">33</a></span><span class="line"><span class="comment">%resu2 = dot(VectP2,u);</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo" id="T3:U99"><span class="var type1" id="S17T3U151">resu1</span> = <span class="mxinfo" id="T3:U101"><span class="mxinfo" id="T19:U102"><span class="var type1" id="S8T2U154">VectP1</span>'</span>*<span class="var type1" id="S12T2U155">u</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo" id="T3:U105"><span class="var type1" id="S18T3U158">resu2</span> = <span class="mxinfo" id="T3:U107"><span class="mxinfo" id="T19:U108"><span class="var type1" id="S10T2U161">VectP2</span>'</span>*<span class="var type1" id="S12T2U162">u</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo" id="T3:U111"><span class="var type1" id="S19T3U165">test1</span> = <span class="mxinfo" id="T3:U113"><span class="var type1" id="S17T3U167">resu1</span>*<span class="var type1" id="S18T3U168">resu2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,37" id="srcline37">37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,38" id="srcline38">38</a></span><span class="line"><span class="comment">%resu1 = dot(VectP1,v);</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,39" id="srcline39">39</a></span><span class="line"><span class="comment">%resu2 = dot(VectP4,v);</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,40" id="srcline40">40</a></span><span class="line"><span class="mxinfo" id="T3:U116"><span class="var type1" id="S17T3U171">resu1</span> = <span class="mxinfo" id="T3:U118"><span class="mxinfo" id="T19:U119"><span class="var type1" id="S8T2U174">VectP1</span>'</span>*<span class="var type1" id="S13T2U175">v</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,41" id="srcline41">41</a></span><span class="line"><span class="mxinfo" id="T3:U122"><span class="var type1" id="S18T3U178">resu2</span> = <span class="mxinfo" id="T3:U124"><span class="mxinfo" id="T19:U125"><span class="var type1" id="S11T2U181">VectP4</span>'</span>*<span class="var type1" id="S13T2U182">v</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,42" id="srcline42">42</a></span><span class="line"><span class="mxinfo" id="T3:U128"><span class="var type1" id="S20T3U185">test2</span> = <span class="mxinfo" id="T3:U130"><span class="var type1" id="S17T3U187">resu1</span>*<span class="var type1" id="S18T3U188">resu2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,43" id="srcline43">43</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,44" id="srcline44">44</a></span><span class="line"><span class="mxinfo" id="T3:U133"><span class="var type1" id="S21T3U191">det</span>  = <span class="mxinfo" id="T3:U135"><span class="mxinfo" id="T3:U136"><span class="mxinfo" id="T3:U137">(<span class="mxinfo" id="T3:U138"><span class="mxinfo" id="T3:U139">(<span class="mxinfo" id="T3:U140"><span class="mxinfo" id="T3:U141"><span class="var type1" id="S15T2U201">p2</span>(<span class="mxinfo" id="T3:U143">2</span>)</span>-<span class="mxinfo" id="T3:U144"><span class="var type1" id="S14T2U204">p1</span>(<span class="mxinfo" id="T3:U146">2</span>)</span></span>)*(<span class="mxinfo" id="T3:U147"><span class="mxinfo" id="T3:U148"><span class="var type1" id="S16T2U209">p3</span>(<span class="mxinfo" id="T3:U150">3</span>)</span>-<span class="mxinfo" id="T3:U151"><span class="var type1" id="S14T2U212">p1</span>(<span class="mxinfo" id="T3:U153">3</span>)</span></span>)</span>-<span class="mxinfo" id="T3:U154">(<span class="mxinfo" id="T3:U155"><span class="mxinfo" id="T3:U156"><span class="var type1" id="S16T2U218">p3</span>(<span class="mxinfo" id="T3:U158">2</span>)</span>-<span class="mxinfo" id="T3:U159"><span class="var type1" id="S14T2U221">p1</span>(<span class="mxinfo" id="T3:U161">2</span>)</span></span>)*(<span class="mxinfo" id="T3:U162"><span class="mxinfo" id="T3:U163"><span class="var type1" id="S15T2U226">p2</span>(<span class="mxinfo" id="T3:U165">3</span>)</span>-<span class="mxinfo" id="T3:U166"><span class="var type1" id="S14T2U229">p1</span>(<span class="mxinfo" id="T3:U168">3</span>)</span></span>)</span></span>)*(<span class="mxinfo" id="T3:U169"><span class="mxinfo" id="T3:U170"><span class="var type1" id="S6T2U234">point</span>(<span class="mxinfo" id="T3:U172">1</span>)</span>-<span class="mxinfo" id="T3:U173"><span class="var type1" id="S14T2U237">p1</span>(<span class="mxinfo" id="T3:U175">1</span>)</span></span>)</span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="35,45" id="srcline45">45</a></span><span class="line"><span class="mxinfo" id="T3:U133"><span class="mxinfo" id="T3:U135"><span class="mxinfo" id="T3:U136">       <span class="mxinfo" id="T3:U176">(<span class="mxinfo" id="T3:U177"><span class="mxinfo" id="T3:U178">(<span class="mxinfo" id="T3:U179"><span class="mxinfo" id="T3:U180"><span class="var type1" id="S15T2U246">p2</span>(<span class="mxinfo" id="T3:U182">3</span>)</span>-<span class="mxinfo" id="T3:U183"><span class="var type1" id="S14T2U249">p1</span>(<span class="mxinfo" id="T3:U185">3</span>)</span></span>)*(<span class="mxinfo" id="T3:U186"><span class="mxinfo" id="T3:U187"><span class="var type1" id="S16T2U254">p3</span>(<span class="mxinfo" id="T3:U189">1</span>)</span>-<span class="mxinfo" id="T3:U190"><span class="var type1" id="S14T2U257">p1</span>(<span class="mxinfo" id="T3:U192">1</span>)</span></span>)</span>-<span class="mxinfo" id="T3:U193">(<span class="mxinfo" id="T3:U194"><span class="mxinfo" id="T3:U195"><span class="var type1" id="S16T2U263">p3</span>(<span class="mxinfo" id="T3:U197">3</span>)</span>-<span class="mxinfo" id="T3:U198"><span class="var type1" id="S14T2U266">p1</span>(<span class="mxinfo" id="T3:U200">3</span>)</span></span>)*(<span class="mxinfo" id="T3:U201"><span class="mxinfo" id="T3:U202"><span class="var type1" id="S15T2U271">p2</span>(<span class="mxinfo" id="T3:U204">1</span>)</span>-<span class="mxinfo" id="T3:U205"><span class="var type1" id="S14T2U274">p1</span>(<span class="mxinfo" id="T3:U207">1</span>)</span></span>)</span></span>)*(<span class="mxinfo" id="T3:U208"><span class="mxinfo" id="T3:U209"><span class="var type1" id="S6T2U279">point</span>(<span class="mxinfo" id="T3:U211">2</span>)</span>-<span class="mxinfo" id="T3:U212"><span class="var type1" id="S14T2U282">p1</span>(<span class="mxinfo" id="T3:U214">2</span>)</span></span>)</span></span> + <span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="35,46" id="srcline46">46</a></span><span class="line"><span class="mxinfo" id="T3:U133"><span class="mxinfo" id="T3:U135">       <span class="mxinfo" id="T3:U215">(<span class="mxinfo" id="T3:U216"><span class="mxinfo" id="T3:U217">(<span class="mxinfo" id="T3:U218"><span class="mxinfo" id="T3:U219"><span class="var type1" id="S15T2U291">p2</span>(<span class="mxinfo" id="T3:U221">1</span>)</span>-<span class="mxinfo" id="T3:U222"><span class="var type1" id="S14T2U294">p1</span>(<span class="mxinfo" id="T3:U224">1</span>)</span></span>)*(<span class="mxinfo" id="T3:U225"><span class="mxinfo" id="T3:U226"><span class="var type1" id="S16T2U299">p3</span>(<span class="mxinfo" id="T3:U228">2</span>)</span>-<span class="mxinfo" id="T3:U229"><span class="var type1" id="S14T2U302">p1</span>(<span class="mxinfo" id="T3:U231">2</span>)</span></span>)</span>-<span class="mxinfo" id="T3:U232">(<span class="mxinfo" id="T3:U233"><span class="mxinfo" id="T3:U234"><span class="var type1" id="S16T2U308">p3</span>(<span class="mxinfo" id="T3:U236">1</span>)</span>-<span class="mxinfo" id="T3:U237"><span class="var type1" id="S14T2U311">p1</span>(<span class="mxinfo" id="T3:U239">1</span>)</span></span>)*(<span class="mxinfo" id="T3:U240"><span class="mxinfo" id="T3:U241"><span class="var type1" id="S15T2U316">p2</span>(<span class="mxinfo" id="T3:U243">2</span>)</span>-<span class="mxinfo" id="T3:U244"><span class="var type1" id="S14T2U319">p1</span>(<span class="mxinfo" id="T3:U246">2</span>)</span></span>)</span></span>)*(<span class="mxinfo" id="T3:U247"><span class="mxinfo" id="T3:U248"><span class="var type1" id="S6T2U324">point</span>(<span class="mxinfo" id="T3:U250">3</span>)</span>-<span class="mxinfo" id="T3:U251"><span class="var type1" id="S14T2U327">p1</span>(<span class="mxinfo" id="T3:U253">3</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,47" id="srcline47">47</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="35,48" id="srcline48">48</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo" id="T16:U254"><span class="var type1" id="S19T3U335">test1</span> &lt;= <span class="mxinfo" id="T3:U256">1.0e-10</span></span>) &amp;&amp; (<span class="mxinfo" id="T16:U257"><span class="var type1" id="S20T3U339">test2</span> &lt;= <span class="mxinfo" id="T3:U259">1.0e-10</span></span>) &amp;&amp; (<span class="mxinfo" id="T16:U260"><span class="mxinfo" id="T3:U261">abs(<span class="var type1" id="S21T3U345">det</span>)</span> &lt;= <span class="mxinfo" id="T3:U263">1.0e-8</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="35,49" id="srcline49">49</a></span><span class="line">    <span class="mxinfo" id="T3:U264"><span class="var type1" id="S2T3U349">appface</span> = <span class="mxinfo" id="T3:U266">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,50" id="srcline50">50</a></span><span class="line"><span class="keyword">else</span> </span></span>
<span class="srcline"><span class="lineno"><a href="35,51" id="srcline51">51</a></span><span class="line">    <span class="mxinfo" id="T3:U267"><span class="var type1" id="S2T3U354">appface</span> = <span class="mxinfo" id="T3:U269">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,52" id="srcline52">52</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
