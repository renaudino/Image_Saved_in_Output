<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">mmask</span>,<span class="var type1" id="S3T2U4">m</span>] = Masking(<span class="var type1" id="S4T7U7">P1_re</span>,<span class="var type1" id="S5T7U8">P2_re</span>) <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% Checks if it is blocked between P1 and P2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% Authors: Francesco Mani &lt;francesco.mani@uclouvain.be&gt; and Mingming Gan &lt;gan@ftw.at&gt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% History:  2011.9.28</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">% Updated by: Xuhong Li &lt;xuhong@ftw.at&gt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">% History: 2013.08.01</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% Unify the output size of 'm', adding 'mmask' as the second output</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line">coder.extrinsic(<span class="string">'exit'</span>) <span class="comment">% for code conversion</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line">coder.extrinsic(<span class="string">'disp'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="keyword">global</span> <span class="var type0" id="S7T0U22">Nblock</span> <span class="var type0" id="S8T0U23">eta</span> <span class="var type0" id="S9T0U24">vnfaces</span> <span class="var type0" id="S10T0U25">K</span> <span class="var type0" id="S11T0U26">wedges</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="mxinfo " id="T7:U5"><span class="var type1" id="S12T7U29">ehi</span> = <span class="mxinfo " id="T7:U7">zeros(<span class="mxinfo " id="T1:U8">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="mxinfo " id="T7:U9"><span class="var type1" id="S14T7U36">eti</span> = <span class="mxinfo " id="T7:U11">zeros(<span class="mxinfo " id="T1:U12">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="mxinfo " id="T7:U13"><span class="var type1" id="S15T7U43">ett</span> = <span class="mxinfo " id="T7:U15">zeros(<span class="mxinfo " id="T1:U16">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="mxinfo " id="T7:U17"><span class="var type1" id="S16T7U50">eht</span> = <span class="mxinfo " id="T7:U19">zeros(<span class="mxinfo " id="T1:U20">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="mxinfo " id="T7:U21"><span class="var type1" id="S17T7U57">eho</span> = <span class="mxinfo " id="T7:U23">zeros(<span class="mxinfo " id="T1:U24">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="mxinfo " id="T7:U25"><span class="var type1" id="S18T7U64">eto</span> = <span class="mxinfo " id="T7:U27">zeros(<span class="mxinfo " id="T1:U28">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="mxinfo " id="T7:U29"><span class="var type1" id="S19T7U71">etr</span> = <span class="mxinfo " id="T7:U31">zeros(<span class="mxinfo " id="T1:U32">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="mxinfo " id="T7:U33"><span class="var type1" id="S20T7U78">ehr</span> = <span class="mxinfo " id="T7:U35">zeros(<span class="mxinfo " id="T1:U36">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%--memory space assigned before being used,important for code conversion--%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="mxinfo " id="T8:U37"><span class="var type1" id="S21T8U85">ptemp</span>=<span class="mxinfo " id="T8:U39">zeros(<span class="mxinfo " id="T1:U40">2</span>,<span class="mxinfo " id="T1:U41">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="mxinfo " id="T9:U42"><span class="var type1" id="S22T9U92">ftemp</span>=<span class="mxinfo " id="T9:U44">zeros(<span class="mxinfo " id="T1:U45">2</span>,<span class="mxinfo " id="T1:U46">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="mxinfo " id="T7:U47"><span class="var type1" id="S23T7U99">tpp_re</span>=<span class="mxinfo " id="T7:U49">zeros(<span class="mxinfo " id="T1:U50">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="mxinfo " id="T7:U51"><span class="var type1" id="S24T7U106">vnfaces_re</span>=<span class="mxinfo " id="T7:U53">zeros(<span class="mxinfo " id="T1:U54">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="mxinfo " id="T7:U55"><span class="var type1" id="S25T7U113">tp</span>=<span class="mxinfo " id="T7:U57">zeros(<span class="mxinfo " id="T1:U58">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="mxinfo " id="T10:U59"><span class="var type1" id="S26T10U120">mflag</span>=<span class="mxinfo " id="T10:U61">zeros(<span class="mxinfo " id="T1:U62">2</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="mxinfo " id="T7:U63"><span class="var type1" id="S27T7U127">P1</span>=<span class="mxinfo " id="T7:U65">zeros(<span class="mxinfo " id="T1:U66">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="mxinfo " id="T7:U67"><span class="var type1" id="S28T7U134">P2</span>=<span class="mxinfo " id="T7:U69">zeros(<span class="mxinfo " id="T1:U70">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo " id="T1:U71"><span class="var type1" id="S29T1U141">NN</span> = <span class="mxinfo " id="T1:U73">1e4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="mxinfo " id="T6:U74"><span class="var type1" id="S30T6U145">mpflag</span>=<span class="mxinfo " id="T6:U76">zeros(<span class="var type1" id="S29T1U148">NN</span>,<span class="mxinfo " id="T1:U78">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="mxinfo " id="T4:U79"><span class="var type1" id="S31T4U152">mploss</span> = <span class="mxinfo " id="T4:U81">complex(<span class="mxinfo " id="T5:U82">zeros(<span class="var type1" id="S29T1U157">NN</span>,1)</span>,<span class="mxinfo " id="T5:U84">zeros(<span class="var type1" id="S29T1U161">NN</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="mxinfo " id="T5:U86"><span class="var type1" id="S33T5U165">mpd</span> = <span class="mxinfo " id="T5:U88">zeros(<span class="var type1" id="S29T1U168">NN</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="mxinfo " id="T5:U90"><span class="var type1" id="S34T5U172">mepd</span> = <span class="mxinfo " id="T5:U92">zeros(<span class="var type1" id="S29T1U175">NN</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="mxinfo " id="T3:U94"><span class="var type1" id="S35T3U179">msti</span> = <span class="mxinfo " id="T3:U96">zeros(<span class="var type1" id="S29T1U182">NN</span>,<span class="mxinfo " id="T1:U98">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="mxinfo " id="T3:U99"><span class="var type1" id="S36T3U186">mstt</span> = <span class="mxinfo " id="T3:U101">zeros(<span class="var type1" id="S29T1U189">NN</span>,<span class="mxinfo " id="T1:U103">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo " id="T11:U104"><span class="var type1" id="S37T11U193">tpp</span>=<span class="mxinfo " id="T11:U106">zeros(<span class="mxinfo " id="T1:U107">1000</span>,<span class="mxinfo " id="T1:U108">2</span>,<span class="mxinfo " id="T1:U109">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="mxinfo " id="T12:U110"><span class="var type1" id="S38T12U201">tff</span>=<span class="mxinfo " id="T12:U112">zeros(<span class="mxinfo " id="T1:U113">1000</span>,<span class="mxinfo " id="T1:U114">2</span>,<span class="mxinfo " id="T1:U115">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="mxinfo " id="T13:U116"><span class="var type1" id="S39T13U209">dist</span>=<span class="mxinfo " id="T13:U118">zeros(<span class="mxinfo " id="T1:U119">1</span>,<span class="var type1" id="S29T1U213">NN</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="mxinfo " id="T7:U121"><span class="var type1" id="S40T7U216">si</span>=<span class="mxinfo " id="T7:U123">zeros(<span class="mxinfo " id="T1:U124">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="mxinfo " id="T7:U125"><span class="var type1" id="S41T7U223">st</span>=<span class="mxinfo " id="T7:U127">zeros(<span class="mxinfo " id="T1:U128">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="mxinfo " id="T7:U129"><span class="var type1" id="S42T7U230">d1</span>=<span class="mxinfo " id="T7:U131">zeros(<span class="mxinfo " id="T1:U132">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="mxinfo " id="T3:U133"><span class="var type1" id="S43T3U237">mshi</span>= <span class="mxinfo " id="T3:U135">zeros(<span class="var type1" id="S29T1U240">NN</span>,<span class="mxinfo " id="T1:U137">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"><span class="mxinfo " id="T3:U138"><span class="var type1" id="S44T3U244">msht</span>= <span class="mxinfo " id="T3:U140">zeros(<span class="var type1" id="S29T1U247">NN</span>,<span class="mxinfo " id="T1:U142">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="mxinfo " id="T3:U143"><span class="var type1" id="S45T3U251">mstr</span>= <span class="mxinfo " id="T3:U145">zeros(<span class="var type1" id="S29T1U254">NN</span>,<span class="mxinfo " id="T1:U147">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"><span class="mxinfo " id="T3:U148"><span class="var type1" id="S46T3U258">msto</span>= <span class="mxinfo " id="T3:U150">zeros(<span class="var type1" id="S29T1U261">NN</span>,<span class="mxinfo " id="T1:U152">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="mxinfo " id="T3:U153"><span class="var type1" id="S47T3U265">mshr</span>= <span class="mxinfo " id="T3:U155">zeros(<span class="var type1" id="S29T1U268">NN</span>,<span class="mxinfo " id="T1:U157">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="mxinfo " id="T3:U158"><span class="var type1" id="S48T3U272">msho</span>= <span class="mxinfo " id="T3:U160">zeros(<span class="var type1" id="S29T1U275">NN</span>,<span class="mxinfo " id="T1:U162">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="mxinfo " id="T5:U163"><span class="var type1" id="S49T5U279">mnbpen</span>=<span class="mxinfo " id="T5:U165">zeros(<span class="var type1" id="S29T1U282">NN</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="mxinfo " id="T1:U167"><span class="var type1" id="S50T1U286">fe</span>=<span class="mxinfo " id="T1:U169">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="mxinfo " id="T14:U170"><span class="var type1" id="S51T14U290">teps</span>=<span class="mxinfo " id="T1:U172">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"><span class="mxinfo " id="T4:U173"><span class="var type1" id="S52T4U294">mTti</span> = <span class="mxinfo " id="T4:U175">complex(<span class="mxinfo " id="T5:U176">zeros(<span class="var type1" id="S29T1U299">NN</span>,1)</span>,<span class="mxinfo " id="T5:U178">zeros(<span class="var type1" id="S29T1U303">NN</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="mxinfo " id="T4:U180"><span class="var type1" id="S53T4U307">mThi</span>= <span class="mxinfo " id="T4:U182">complex(<span class="mxinfo " id="T5:U183">zeros(<span class="var type1" id="S29T1U312">NN</span>,1)</span>,<span class="mxinfo " id="T5:U185">zeros(<span class="var type1" id="S29T1U316">NN</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="mxinfo " id="T4:U187"><span class="var type1" id="S54T4U320">mTtt</span>= <span class="mxinfo " id="T4:U189">complex(<span class="mxinfo " id="T5:U190">zeros(<span class="var type1" id="S29T1U325">NN</span>,1)</span>,<span class="mxinfo " id="T5:U192">zeros(<span class="var type1" id="S29T1U329">NN</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"><span class="mxinfo " id="T4:U194"><span class="var type1" id="S55T4U333">mTht</span>= <span class="mxinfo " id="T4:U196">complex(<span class="mxinfo " id="T5:U197">zeros(<span class="var type1" id="S29T1U338">NN</span>,1)</span>,<span class="mxinfo " id="T5:U199">zeros(<span class="var type1" id="S29T1U342">NN</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="mxinfo " id="T14:U201"><span class="var type1" id="S56T14U346">sti2</span>=<span class="mxinfo " id="T14:U203"><span class="mxinfo " id="T1:U204">0</span>+<span class="mxinfo " id="T14:U205">0i</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"><span class="mxinfo " id="T14:U206"><span class="var type1" id="S57T14U352">cti</span>=<span class="mxinfo " id="T14:U208"><span class="mxinfo " id="T1:U209">0</span>+<span class="mxinfo " id="T14:U210">0i</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line"><span class="mxinfo " id="T14:U211"><span class="var type1" id="S58T14U358">str2</span>=<span class="mxinfo " id="T14:U213"><span class="mxinfo " id="T1:U214">0</span>+<span class="mxinfo " id="T14:U215">0i</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"><span class="mxinfo " id="T14:U216"><span class="var type1" id="S59T14U364">ctr</span>=<span class="mxinfo " id="T14:U218"><span class="mxinfo " id="T1:U219">0</span>+<span class="mxinfo " id="T14:U220">0i</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"><span class="comment">%-------------------------------------------------------------------------%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"><span class="mxinfo " id="T7:U221"><span class="mxinfo " id="T7:U222"><span class="var type1" id="S27T7U371">P1</span>(<span class="mxinfo " id="T15:U224">:</span>,<span class="mxinfo " id="T16:U225">1</span>)</span> = <span class="var type1" id="S4T7U374">P1_re</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"><span class="mxinfo " id="T7:U227"><span class="mxinfo " id="T7:U228"><span class="var type1" id="S28T7U378">P2</span>(<span class="mxinfo " id="T15:U230">:</span>,<span class="mxinfo " id="T16:U231">1</span>)</span> = <span class="var type1" id="S5T7U381">P2_re</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"><span class="mxinfo " id="T17:U233"><span class="var type1" id="S60T17U384">ppt</span> = <span class="mxinfo " id="T17:U235">zeros(<span class="mxinfo " id="T1:U236">3</span>,<span class="mxinfo " id="T1:U237">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"><span class="mxinfo " id="T9:U238"><span class="var type1" id="S61T9U391">nb</span> = <span class="mxinfo " id="T9:U240">zeros(<span class="mxinfo " id="T1:U241">2</span>,<span class="mxinfo " id="T1:U242">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"><span class="mxinfo " id="T7:U243"><span class="var type1" id="S62T7U398">n</span> = <span class="mxinfo " id="T7:U245">zeros(<span class="mxinfo " id="T1:U246">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"><span class="mxinfo " id="T10:U247"><span class="var type1" id="S63T10U405">face</span> = <span class="mxinfo " id="T10:U249">zeros(<span class="mxinfo " id="T1:U250">2</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"><span class="mxinfo " id="T1:U251"><span class="var type1" id="S64T1U412">msk</span> = <span class="mxinfo " id="T1:U253">0</span></span>;    <span class="comment">% no masking</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"><span class="mxinfo " id="T7:U254"><span class="var type1" id="S65T7U416">dP</span> = <span class="mxinfo " id="T7:U256"><span class="var type1" id="S28T7U418">P2</span> - <span class="var type1" id="S27T7U419">P1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"><span class="mxinfo " id="T1:U259"><span class="var type1" id="S66T1U422">dt</span> = <span class="mxinfo " id="T1:U261">norm(<span class="var type1" id="S65T7U425">dP</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line"><span class="mxinfo " id="T7:U263"><span class="var type1" id="S68T7U428">sdp</span> = <span class="mxinfo " id="T7:U265"><span class="mxinfo " id="T1:U266"><span class="mxinfo " id="T1:U267">1</span>/<span class="var type1" id="S66T1U432">dt</span></span>*<span class="var type1" id="S65T7U433">dP</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line"><span class="mxinfo " id="T1:U270"><span class="var type1" id="S69T1U436">cnt</span> = <span class="mxinfo " id="T1:U272">0</span></span>;    <span class="comment">% count the number of penertration per path</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line"><span class="mxinfo " id="T1:U273"><span class="var type1" id="S70T1U440">i</span> = <span class="mxinfo " id="T1:U275">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line"><span class="mxinfo " id="T14:U276"><span class="var type1" id="S71T14U444">uno</span> = <span class="mxinfo " id="T14:U278">complex(1,0)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line"><span class="keyword">while</span> (<span class="mxinfo " id="T18:U279"><span class="var type1" id="S70T1U453">i</span> &lt;= <span class="var type1" id="S7T1U454">Nblock</span></span>) &amp;&amp; (<span class="var type1" id="S64T1U457">msk</span> ~= 1)   <span class="comment">% continue until the end of the blocks or until it is masked</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">    <span class="mxinfo " id="T1:U283"><span class="var type1" id="S72T1U461">count</span> = <span class="mxinfo " id="T1:U285">0</span></span>;    <span class="comment">% count the number of intersection point</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">    <span class="mxinfo " id="T1:U286"><span class="var type1" id="S73T1U465">j</span> = <span class="mxinfo " id="T1:U288">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">    <span class="keyword">while</span> (<span class="mxinfo " id="T18:U289"><span class="var type1" id="S73T1U472">j</span> &lt;= <span class="mxinfo " id="T1:U291">6</span></span>) &amp;&amp; (<span class="var type1" id="S64T1U476">msk</span> ~= 1) &amp;&amp; (<span class="mxinfo " id="T18:U293"><span class="var type1" id="S72T1U480">count</span> &lt; <span class="mxinfo " id="T1:U295">2</span></span>)    <span class="comment">% for each block continue until the end of the faces or until it is masked or both the input and output point are found</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">        <span class="mxinfo " id="T1:U296"><span class="mxinfo " id="T1:U297"><span class="var type1" id="S63T10U485">face</span>(<span class="mxinfo " id="T16:U299">1</span>)</span> = <span class="var type1" id="S70T1U487">i</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">        <span class="mxinfo " id="T1:U301"><span class="mxinfo " id="T1:U302"><span class="var type1" id="S63T10U491">face</span>(<span class="mxinfo " id="T16:U304">2</span>)</span> = <span class="var type1" id="S73T1U493">j</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">        <span class="mxinfo " id="T7:U306"><span class="mxinfo " id="T7:U307"><span class="var type1" id="S62T7U497">n</span>(<span class="mxinfo " id="T15:U309">:</span>,<span class="mxinfo " id="T16:U310">1</span>)</span> = <span class="mxinfo " id="T19:U311"><span class="var type1" id="S9T20U501">vnfaces</span>(<span class="var type1" id="S70T1U502">i</span>,<span class="var type1" id="S73T1U503">j</span>,<span class="mxinfo " id="T15:U315">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">        <span class="comment">%c = dot(dP,n);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">        <span class="mxinfo " id="T1:U316"><span class="var type1" id="S74T1U507">c</span> = <span class="mxinfo " id="T1:U318"><span class="mxinfo " id="T21:U319"><span class="var type1" id="S65T7U510">dP</span>'</span>*<span class="var type1" id="S62T7U511">n</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U322"><span class="mxinfo " id="T1:U323">abs(<span class="var type1" id="S74T1U518">c</span>)</span> &gt; <span class="mxinfo " id="T1:U325">1.0e-3</span></span>)    <span class="comment">% if the path is not parallel to the face look for the intersections</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">            <span class="mxinfo " id="T1:U326"><span class="var type1" id="S76T1U522">x1</span> = <span class="mxinfo " id="T1:U328"><span class="var type1" id="S11T22U524">wedges</span>(<span class="var type1" id="S70T1U525">i</span>,<span class="var type1" id="S73T1U526">j</span>,<span class="mxinfo " id="T1:U332">1</span>,<span class="mxinfo " id="T1:U333">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">            <span class="mxinfo " id="T1:U334"><span class="var type1" id="S77T1U531">y1</span> = <span class="mxinfo " id="T1:U336"><span class="var type1" id="S11T22U533">wedges</span>(<span class="var type1" id="S70T1U534">i</span>,<span class="var type1" id="S73T1U535">j</span>,<span class="mxinfo " id="T1:U340">1</span>,<span class="mxinfo " id="T1:U341">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">            <span class="mxinfo " id="T1:U342"><span class="var type1" id="S78T1U540">z1</span> = <span class="mxinfo " id="T1:U344"><span class="var type1" id="S11T22U542">wedges</span>(<span class="var type1" id="S70T1U543">i</span>,<span class="var type1" id="S73T1U544">j</span>,<span class="mxinfo " id="T1:U348">1</span>,<span class="mxinfo " id="T1:U349">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">            <span class="mxinfo " id="T1:U350"><span class="var type1" id="S79T1U549">x2</span> = <span class="mxinfo " id="T1:U352"><span class="var type1" id="S11T22U551">wedges</span>(<span class="var type1" id="S70T1U552">i</span>,<span class="var type1" id="S73T1U553">j</span>,<span class="mxinfo " id="T1:U356">2</span>,<span class="mxinfo " id="T1:U357">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">            <span class="mxinfo " id="T1:U358"><span class="var type1" id="S80T1U558">y2</span> = <span class="mxinfo " id="T1:U360"><span class="var type1" id="S11T22U560">wedges</span>(<span class="var type1" id="S70T1U561">i</span>,<span class="var type1" id="S73T1U562">j</span>,<span class="mxinfo " id="T1:U364">2</span>,<span class="mxinfo " id="T1:U365">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">            <span class="mxinfo " id="T1:U366"><span class="var type1" id="S81T1U567">z2</span> = <span class="mxinfo " id="T1:U368"><span class="var type1" id="S11T22U569">wedges</span>(<span class="var type1" id="S70T1U570">i</span>,<span class="var type1" id="S73T1U571">j</span>,<span class="mxinfo " id="T1:U372">2</span>,<span class="mxinfo " id="T1:U373">3</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">            <span class="mxinfo " id="T1:U374"><span class="var type1" id="S82T1U576">x0</span> = <span class="mxinfo " id="T1:U376"><span class="var type1" id="S11T22U578">wedges</span>(<span class="var type1" id="S70T1U579">i</span>,<span class="var type1" id="S73T1U580">j</span>,<span class="mxinfo " id="T1:U380">3</span>,<span class="mxinfo " id="T1:U381">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">            <span class="mxinfo " id="T1:U382"><span class="var type1" id="S83T1U585">y0</span> = <span class="mxinfo " id="T1:U384"><span class="var type1" id="S11T22U587">wedges</span>(<span class="var type1" id="S70T1U588">i</span>,<span class="var type1" id="S73T1U589">j</span>,<span class="mxinfo " id="T1:U388">3</span>,<span class="mxinfo " id="T1:U389">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">            <span class="mxinfo " id="T1:U390"><span class="var type1" id="S84T1U594">z0</span> = <span class="mxinfo " id="T1:U392"><span class="var type1" id="S11T22U596">wedges</span>(<span class="var type1" id="S70T1U597">i</span>,<span class="var type1" id="S73T1U598">j</span>,<span class="mxinfo " id="T1:U396">3</span>,<span class="mxinfo " id="T1:U397">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">            <span class="mxinfo " id="T1:U398"><span class="var type1" id="S85T1U603">dtr</span> = <span class="mxinfo " id="T1:U400"><span class="mxinfo " id="T1:U401"><span class="mxinfo " id="T1:U402">(<span class="mxinfo " id="T1:U403"><span class="mxinfo " id="T1:U404"><span class="var type1" id="S27T7U610">P1</span>(<span class="mxinfo " id="T16:U406">1</span>)</span>-<span class="mxinfo " id="T1:U407"><span class="var type1" id="S28T7U613">P2</span>(<span class="mxinfo " id="T1:U409">1</span>)</span></span>)*(<span class="mxinfo " id="T1:U410"><span class="mxinfo " id="T1:U411">(<span class="mxinfo " id="T1:U412"><span class="var type1" id="S77T1U620">y1</span>-<span class="var type1" id="S83T1U621">y0</span></span>)*(<span class="mxinfo " id="T1:U415"><span class="var type1" id="S81T1U624">z2</span>-<span class="var type1" id="S84T1U625">z0</span></span>)</span>-<span class="mxinfo " id="T1:U418">(<span class="mxinfo " id="T1:U419"><span class="var type1" id="S80T1U629">y2</span>-<span class="var type1" id="S83T1U630">y0</span></span>)*(<span class="mxinfo " id="T1:U422"><span class="var type1" id="S78T1U633">z1</span>-<span class="var type1" id="S84T1U634">z0</span></span>)</span></span>)</span>-<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">                  <span class="mxinfo " id="T1:U425">(<span class="mxinfo " id="T1:U426"><span class="mxinfo " id="T1:U427"><span class="var type1" id="S27T7U639">P1</span>(<span class="mxinfo " id="T1:U429">2</span>)</span>-<span class="mxinfo " id="T1:U430"><span class="var type1" id="S28T7U642">P2</span>(<span class="mxinfo " id="T1:U432">2</span>)</span></span>)*(<span class="mxinfo " id="T1:U433"><span class="mxinfo " id="T1:U434">(<span class="mxinfo " id="T1:U435"><span class="var type1" id="S76T1U649">x1</span>-<span class="var type1" id="S82T1U650">x0</span></span>)*(<span class="mxinfo " id="T1:U438"><span class="var type1" id="S81T1U653">z2</span>-<span class="var type1" id="S84T1U654">z0</span></span>)</span>-<span class="mxinfo " id="T1:U441">(<span class="mxinfo " id="T1:U442"><span class="var type1" id="S79T1U658">x2</span>-<span class="var type1" id="S82T1U659">x0</span></span>)*(<span class="mxinfo " id="T1:U445"><span class="var type1" id="S78T1U662">z1</span>-<span class="var type1" id="S84T1U663">z0</span></span>)</span></span>)</span></span>+<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">                  <span class="mxinfo " id="T1:U448">(<span class="mxinfo " id="T1:U449"><span class="mxinfo " id="T1:U450"><span class="var type1" id="S27T7U668">P1</span>(<span class="mxinfo " id="T1:U452">3</span>)</span>-<span class="mxinfo " id="T1:U453"><span class="var type1" id="S28T7U671">P2</span>(<span class="mxinfo " id="T1:U455">3</span>)</span></span>)*(<span class="mxinfo " id="T1:U456"><span class="mxinfo " id="T1:U457">(<span class="mxinfo " id="T1:U458"><span class="var type1" id="S76T1U678">x1</span>-<span class="var type1" id="S82T1U679">x0</span></span>)*(<span class="mxinfo " id="T1:U461"><span class="var type1" id="S80T1U682">y2</span>-<span class="var type1" id="S83T1U683">y0</span></span>)</span>-<span class="mxinfo " id="T1:U464">(<span class="mxinfo " id="T1:U465"><span class="var type1" id="S79T1U687">x2</span>-<span class="var type1" id="S82T1U688">x0</span></span>)*(<span class="mxinfo " id="T1:U468"><span class="var type1" id="S77T1U691">y1</span>-<span class="var type1" id="S83T1U692">y0</span></span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T18:U471"><span class="var type1" id="S85T1U697">dtr</span> == <span class="mxinfo " id="T1:U473">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">                <span class="mxinfo " id="T23:U474"><span class="extrinsicFcn" id="F232N5:B701">disp</span>(<span class="mxinfo " id="T24:U475"><span class="string">'Error: the determinant is equal to zero in bloking function!'</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">                <span class="mxinfo " id="T23:U476"><span class="extrinsicFcn" id="F233N6:B705">exit</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">            <span class="keyword">else</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">                <span class="mxinfo " id="T1:U477"><span class="var type1" id="S88T1U709">t</span> = <span class="mxinfo " id="T1:U479">(<span class="mxinfo " id="T1:U480"><span class="mxinfo " id="T1:U481"><span class="mxinfo " id="T1:U482">(<span class="mxinfo " id="T1:U483"><span class="mxinfo " id="T1:U484"><span class="var type1" id="S27T7U718">P1</span>(<span class="mxinfo " id="T16:U486">1</span>)</span>-<span class="var type1" id="S82T1U720">x0</span></span>)*(<span class="mxinfo " id="T1:U488"><span class="mxinfo " id="T1:U489">(<span class="mxinfo " id="T1:U490"><span class="var type1" id="S77T1U726">y1</span>-<span class="var type1" id="S83T1U727">y0</span></span>)*(<span class="mxinfo " id="T1:U493"><span class="var type1" id="S81T1U730">z2</span>-<span class="var type1" id="S84T1U731">z0</span></span>)</span>-<span class="mxinfo " id="T1:U496">(<span class="mxinfo " id="T1:U497"><span class="var type1" id="S80T1U735">y2</span>-<span class="var type1" id="S83T1U736">y0</span></span>)*(<span class="mxinfo " id="T1:U500"><span class="var type1" id="S78T1U739">z1</span>-<span class="var type1" id="S84T1U740">z0</span></span>)</span></span>)</span>+<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">                    <span class="mxinfo " id="T1:U503">(<span class="mxinfo " id="T1:U504"><span class="mxinfo " id="T1:U505"><span class="var type1" id="S27T7U745">P1</span>(<span class="mxinfo " id="T1:U507">2</span>)</span>-<span class="var type1" id="S83T1U747">y0</span></span>)*(<span class="mxinfo " id="T1:U509"><span class="mxinfo " id="T1:U510">(<span class="mxinfo " id="T1:U511"><span class="var type1" id="S79T1U753">x2</span>-<span class="var type1" id="S82T1U754">x0</span></span>)*(<span class="mxinfo " id="T1:U514"><span class="var type1" id="S78T1U757">z1</span>-<span class="var type1" id="S84T1U758">z0</span></span>)</span>-<span class="mxinfo " id="T1:U517">(<span class="mxinfo " id="T1:U518"><span class="var type1" id="S76T1U762">x1</span>-<span class="var type1" id="S82T1U763">x0</span></span>)*(<span class="mxinfo " id="T1:U521"><span class="var type1" id="S81T1U766">z2</span>-<span class="var type1" id="S84T1U767">z0</span></span>)</span></span>)</span></span>+<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">                    <span class="mxinfo " id="T1:U524">(<span class="mxinfo " id="T1:U525"><span class="mxinfo " id="T1:U526"><span class="var type1" id="S27T7U772">P1</span>(<span class="mxinfo " id="T1:U528">3</span>)</span>-<span class="var type1" id="S84T1U774">z0</span></span>)*(<span class="mxinfo " id="T1:U530"><span class="mxinfo " id="T1:U531">(<span class="mxinfo " id="T1:U532"><span class="var type1" id="S76T1U780">x1</span>-<span class="var type1" id="S82T1U781">x0</span></span>)*(<span class="mxinfo " id="T1:U535"><span class="var type1" id="S80T1U784">y2</span>-<span class="var type1" id="S83T1U785">y0</span></span>)</span>-<span class="mxinfo " id="T1:U538">(<span class="mxinfo " id="T1:U539"><span class="var type1" id="S79T1U789">x2</span>-<span class="var type1" id="S82T1U790">x0</span></span>)*(<span class="mxinfo " id="T1:U542"><span class="var type1" id="S77T1U793">y1</span>-<span class="var type1" id="S83T1U794">y0</span></span>)</span></span>)</span></span>)/<span class="var type1" id="S85T1U795">dtr</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">                <span class="keyword">if</span> (<span class="mxinfo " id="T18:U546"><span class="var type1" id="S88T1U801">t</span> &gt; (<span class="mxinfo " id="T1:U548">-<span class="mxinfo " id="T1:U549">1.0e-6</span></span>)</span>) &amp;&amp; (<span class="mxinfo " id="T18:U550"><span class="var type1" id="S88T1U807">t</span> &lt; (<span class="mxinfo " id="T1:U552"><span class="mxinfo " id="T1:U553">1</span>+(<span class="mxinfo " id="T1:U554">1.0e-6</span>)</span>)</span>)    <span class="comment">% if t&gt;0 &amp;&amp; t&lt;1 intersection point is in between P1 and P2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">                    <span class="mxinfo " id="T7:U555"><span class="var type1" id="S89T7U815">ip</span> = <span class="mxinfo " id="T7:U557"><span class="var type1" id="S28T7U817">P2</span> - <span class="var type1" id="S27T7U818">P1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">                    <span class="mxinfo " id="T7:U560"><span class="var type1" id="S89T7U821">ip</span> = <span class="mxinfo " id="T7:U562"><span class="var type1" id="S27T7U823">P1</span> + <span class="mxinfo " id="T7:U564"><span class="var type1" id="S88T1U825">t</span>*<span class="var type1" id="S89T7U826">ip</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">                    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line"><span class="comment">%                     af = AppFace(ip,face);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">                    <span class="mxinfo " id="T1:U567"><span class="var type1" id="S90T1U829">af</span> = <span class="mxinfo " id="T1:U569"><span class="fcn" id="F158N2:B831">AppFace2</span>(<span class="var type1" id="S89T7U832">ip</span>,<span class="mxinfo " id="T25:U571"><span class="mxinfo " id="T26:U572">reshape(<span class="mxinfo " id="T27:U573"><span class="var type1" id="S11T22U837">wedges</span>(<span class="mxinfo " id="T1:U575"><span class="var type1" id="S63T10U839">face</span>(<span class="mxinfo " id="T16:U577">1</span>)</span>,<span class="mxinfo " id="T1:U578"><span class="var type1" id="S63T10U842">face</span>(<span class="mxinfo " id="T16:U580">2</span>)</span>,<span class="mxinfo " id="T28:U581">:</span>,<span class="mxinfo " id="T15:U582">:</span>)</span>,[],3)</span>.'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">                    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">                    <span class="keyword">if</span> (<span class="mxinfo " id="T18:U583"><span class="var type1" id="S90T1U853">af</span> == <span class="mxinfo " id="T1:U585">1</span></span>)   <span class="comment">% intersection point is found</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">                        <span class="mxinfo " id="T1:U586"><span class="var type1" id="S72T1U857">count</span> = <span class="mxinfo " id="T1:U588"><span class="var type1" id="S72T1U859">count</span>+<span class="mxinfo " id="T1:U590">1</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">                        <span class="mxinfo " id="T7:U591"><span class="mxinfo " id="T7:U592"><span class="var type1" id="S60T17U864">ppt</span>(<span class="mxinfo " id="T15:U594">:</span>,<span class="var type1" id="S72T1U866">count</span>)</span> = <span class="var type1" id="S89T7U867">ip</span></span>;    <span class="comment">% coordinates of the intersection point</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">                        <span class="mxinfo " id="T1:U597"><span class="mxinfo " id="T1:U598"><span class="var type1" id="S61T9U871">nb</span>(<span class="mxinfo " id="T1:U600">1</span>,<span class="var type1" id="S72T1U873">count</span>)</span> = <span class="var type1" id="S70T1U874">i</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">                        <span class="mxinfo " id="T1:U603"><span class="mxinfo " id="T1:U604"><span class="var type1" id="S61T9U878">nb</span>(<span class="mxinfo " id="T1:U606">2</span>,<span class="var type1" id="S72T1U880">count</span>)</span> = <span class="var type1" id="S73T1U881">j</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U609"><span class="var type1" id="S72T1U887">count</span> == <span class="mxinfo " id="T1:U611">2</span></span>) &amp;&amp; (<span class="var type1" id="S64T1U891">msk</span> ~= 1)    <span class="comment">% if the two intersection points are found and there is no masking</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">            <span class="mxinfo " id="T7:U613"><span class="var type1" id="S42T7U895">d1</span> = <span class="mxinfo " id="T7:U615"><span class="var type1" id="S27T7U897">P1</span>-<span class="mxinfo " id="T7:U617"><span class="var type1" id="S60T17U899">ppt</span>(<span class="mxinfo " id="T15:U619">:</span>,<span class="mxinfo " id="T1:U620">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">            <span class="mxinfo " id="T7:U621"><span class="var type1" id="S93T7U904">d2</span> = <span class="mxinfo " id="T7:U623"><span class="var type1" id="S27T7U906">P1</span>-<span class="mxinfo " id="T7:U625"><span class="var type1" id="S60T17U908">ppt</span>(<span class="mxinfo " id="T15:U627">:</span>,<span class="mxinfo " id="T1:U628">2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">            <span class="mxinfo " id="T1:U629"><span class="mxinfo " id="T1:U630"><span class="var type1" id="S39T13U914">dist</span>(<span class="mxinfo " id="T16:U632">1</span>)</span> = <span class="mxinfo " id="T1:U633">norm(<span class="var type1" id="S42T7U918">d1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">            <span class="mxinfo " id="T1:U635"><span class="mxinfo " id="T1:U636"><span class="var type1" id="S39T13U922">dist</span>(<span class="mxinfo " id="T16:U638">2</span>)</span> = <span class="mxinfo " id="T1:U639">norm(<span class="var type1" id="S93T7U926">d2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T18:U641"><span class="mxinfo " id="T1:U642">abs(<span class="mxinfo " id="T1:U643"><span class="mxinfo " id="T1:U644"><span class="var type1" id="S39T13U935">dist</span>(<span class="mxinfo " id="T16:U646">1</span>)</span>-<span class="mxinfo " id="T1:U647"><span class="var type1" id="S39T13U938">dist</span>(<span class="mxinfo " id="T1:U649">2</span>)</span></span>)</span>&gt;<span class="mxinfo " id="T1:U650">1.0e-8</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">                <span class="mxinfo " id="T1:U651"><span class="var type1" id="S69T1U943">cnt</span> = <span class="mxinfo " id="T1:U653"><span class="var type1" id="S69T1U945">cnt</span>+<span class="mxinfo " id="T1:U655">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">                <span class="keyword">if</span> (<span class="mxinfo " id="T18:U656"><span class="mxinfo " id="T1:U657"><span class="var type1" id="S39T13U952">dist</span>(<span class="mxinfo " id="T16:U659">2</span>)</span>&lt;<span class="mxinfo " id="T1:U660"><span class="var type1" id="S39T13U955">dist</span>(<span class="mxinfo " id="T1:U662">1</span>)</span></span>)    <span class="comment">% order the intersection points from the closer to the virtual transmitter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">                    <span class="mxinfo " id="T19:U663"><span class="mxinfo " id="T19:U664"><span class="var type1" id="S37T11U960">tpp</span>(<span class="var type1" id="S69T1U961">cnt</span>,<span class="mxinfo " id="T1:U667">1</span>,<span class="mxinfo " id="T15:U668">:</span>)</span> = <span class="mxinfo " id="T7:U669"><span class="var type1" id="S60T17U965">ppt</span>(<span class="mxinfo " id="T15:U671">:</span>,<span class="mxinfo " id="T1:U672">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">                    <span class="mxinfo " id="T19:U673"><span class="mxinfo " id="T19:U674"><span class="var type1" id="S37T11U971">tpp</span>(<span class="var type1" id="S69T1U972">cnt</span>,<span class="mxinfo " id="T1:U677">2</span>,<span class="mxinfo " id="T15:U678">:</span>)</span> = <span class="mxinfo " id="T7:U679"><span class="var type1" id="S60T17U976">ppt</span>(<span class="mxinfo " id="T15:U681">:</span>,<span class="mxinfo " id="T1:U682">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">                    <span class="mxinfo " id="T29:U683"><span class="mxinfo " id="T29:U684"><span class="var type1" id="S38T12U982">tff</span>(<span class="var type1" id="S69T1U983">cnt</span>,<span class="mxinfo " id="T1:U687">1</span>,<span class="mxinfo " id="T30:U688">:</span>)</span> = <span class="mxinfo " id="T10:U689"><span class="var type1" id="S61T9U987">nb</span>(<span class="mxinfo " id="T30:U691">:</span>,<span class="mxinfo " id="T1:U692">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line">                    <span class="mxinfo " id="T29:U693"><span class="mxinfo " id="T29:U694"><span class="var type1" id="S38T12U993">tff</span>(<span class="var type1" id="S69T1U994">cnt</span>,<span class="mxinfo " id="T1:U697">2</span>,<span class="mxinfo " id="T30:U698">:</span>)</span> = <span class="mxinfo " id="T10:U699"><span class="var type1" id="S61T9U998">nb</span>(<span class="mxinfo " id="T30:U701">:</span>,<span class="mxinfo " id="T1:U702">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">                <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">                    <span class="mxinfo " id="T19:U703"><span class="mxinfo " id="T19:U704"><span class="var type1" id="S37T11U1005">tpp</span>(<span class="var type1" id="S69T1U1006">cnt</span>,<span class="mxinfo " id="T1:U707">1</span>,<span class="mxinfo " id="T15:U708">:</span>)</span> = <span class="mxinfo " id="T7:U709"><span class="var type1" id="S60T17U1010">ppt</span>(<span class="mxinfo " id="T15:U711">:</span>,<span class="mxinfo " id="T1:U712">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">                    <span class="mxinfo " id="T19:U713"><span class="mxinfo " id="T19:U714"><span class="var type1" id="S37T11U1016">tpp</span>(<span class="var type1" id="S69T1U1017">cnt</span>,<span class="mxinfo " id="T1:U717">2</span>,<span class="mxinfo " id="T15:U718">:</span>)</span> = <span class="mxinfo " id="T7:U719"><span class="var type1" id="S60T17U1021">ppt</span>(<span class="mxinfo " id="T15:U721">:</span>,<span class="mxinfo " id="T1:U722">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">                    <span class="mxinfo " id="T29:U723"><span class="mxinfo " id="T29:U724"><span class="var type1" id="S38T12U1027">tff</span>(<span class="var type1" id="S69T1U1028">cnt</span>,<span class="mxinfo " id="T1:U727">1</span>,<span class="mxinfo " id="T30:U728">:</span>)</span> = <span class="mxinfo " id="T10:U729"><span class="var type1" id="S61T9U1032">nb</span>(<span class="mxinfo " id="T30:U731">:</span>,<span class="mxinfo " id="T1:U732">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">                    <span class="mxinfo " id="T29:U733"><span class="mxinfo " id="T29:U734"><span class="var type1" id="S38T12U1038">tff</span>(<span class="var type1" id="S69T1U1039">cnt</span>,<span class="mxinfo " id="T1:U737">2</span>,<span class="mxinfo " id="T30:U738">:</span>)</span> = <span class="mxinfo " id="T10:U739"><span class="var type1" id="S61T9U1043">nb</span>(<span class="mxinfo " id="T30:U741">:</span>,<span class="mxinfo " id="T1:U742">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">                <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">            <span class="keyword">end</span>      </span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">        <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">        <span class="mxinfo " id="T1:U743"><span class="var type1" id="S73T1U1048">j</span> = <span class="mxinfo " id="T1:U745"><span class="var type1" id="S73T1U1050">j</span>+<span class="mxinfo " id="T1:U747">1</span></span></span>;   </span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line">    <span class="mxinfo " id="T1:U748"><span class="var type1" id="S70T1U1054">i</span> = <span class="mxinfo " id="T1:U750"><span class="var type1" id="S70T1U1056">i</span>+<span class="mxinfo " id="T1:U752">1</span></span></span>;                     </span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line"><span class="keyword">if</span> (<span class="var type1" id="S64T1U1062">msk</span> ~= 1)</span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S94T1U1066">k</span> = <span class="mxinfo " id="T1:U755">1</span>:<span class="var type1" id="S69T1U1069">cnt</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line">        <span class="mxinfo " id="T7:U757"><span class="mxinfo " id="T7:U758"><span class="var type1" id="S23T7U1073">tpp_re</span>(<span class="mxinfo " id="T15:U760">:</span>,<span class="mxinfo " id="T1:U761">1</span>)</span> = <span class="mxinfo " id="T19:U762"><span class="var type1" id="S37T11U1077">tpp</span>(<span class="var type1" id="S94T1U1078">k</span>,<span class="mxinfo " id="T1:U765">1</span>,<span class="mxinfo " id="T15:U766">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line">        <span class="mxinfo " id="T7:U767"><span class="mxinfo " id="T7:U768"><span class="var type1" id="S42T7U1084">d1</span>(<span class="mxinfo " id="T15:U770">:</span>,<span class="mxinfo " id="T16:U771">1</span>)</span> = <span class="mxinfo " id="T7:U772"><span class="var type1" id="S27T7U1088">P1</span>-<span class="var type1" id="S23T7U1089">tpp_re</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line">        <span class="mxinfo " id="T1:U775"><span class="mxinfo " id="T1:U776"><span class="var type1" id="S39T13U1093">dist</span>(<span class="var type1" id="S94T1U1094">k</span>)</span> = <span class="mxinfo " id="T1:U779">norm(<span class="var type1" id="S42T7U1097">d1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line"><span class="comment">% if more than one penetration is found during the path they are ordered from beginning from the closest to P1 - insertion sort</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T18:U781"><span class="var type1" id="S69T1U1102">cnt</span> &gt; <span class="mxinfo " id="T1:U783">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S95T1U1106">a</span> = <span class="mxinfo " id="T1:U785">2</span>:<span class="var type1" id="S69T1U1109">cnt</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line">            <span class="mxinfo " id="T21:U787"><span class="mxinfo " id="T21:U788"><span class="var type1" id="S21T8U1113">ptemp</span>(<span class="mxinfo " id="T1:U790">1</span>,<span class="mxinfo " id="T15:U791">:</span>)</span> = <span class="mxinfo " id="T19:U792"><span class="var type1" id="S37T11U1117">tpp</span>(<span class="var type1" id="S95T1U1118">a</span>,<span class="mxinfo " id="T1:U795">1</span>,<span class="mxinfo " id="T15:U796">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line">            <span class="mxinfo " id="T21:U797"><span class="mxinfo " id="T21:U798"><span class="var type1" id="S21T8U1124">ptemp</span>(<span class="mxinfo " id="T1:U800">2</span>,<span class="mxinfo " id="T15:U801">:</span>)</span> = <span class="mxinfo " id="T19:U802"><span class="var type1" id="S37T11U1128">tpp</span>(<span class="var type1" id="S95T1U1129">a</span>,<span class="mxinfo " id="T1:U805">2</span>,<span class="mxinfo " id="T15:U806">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line">            <span class="mxinfo " id="T31:U807"><span class="mxinfo " id="T31:U808"><span class="var type1" id="S22T9U1135">ftemp</span>(<span class="mxinfo " id="T1:U810">1</span>,<span class="mxinfo " id="T30:U811">:</span>)</span> = <span class="mxinfo " id="T29:U812"><span class="var type1" id="S38T12U1139">tff</span>(<span class="var type1" id="S95T1U1140">a</span>,<span class="mxinfo " id="T1:U815">1</span>,<span class="mxinfo " id="T30:U816">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line">            <span class="mxinfo " id="T31:U817"><span class="mxinfo " id="T31:U818"><span class="var type1" id="S22T9U1146">ftemp</span>(<span class="mxinfo " id="T1:U820">2</span>,<span class="mxinfo " id="T30:U821">:</span>)</span> = <span class="mxinfo " id="T29:U822"><span class="var type1" id="S38T12U1150">tff</span>(<span class="var type1" id="S95T1U1151">a</span>,<span class="mxinfo " id="T1:U825">2</span>,<span class="mxinfo " id="T30:U826">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line">            <span class="mxinfo " id="T1:U827"><span class="var type1" id="S96T1U1156">index</span> = <span class="mxinfo " id="T1:U829"><span class="var type1" id="S39T13U1158">dist</span>(<span class="var type1" id="S95T1U1159">a</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line">            <span class="mxinfo " id="T1:U832"><span class="var type1" id="S97T1U1162">b</span> = <span class="var type1" id="S95T1U1163">a</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line">            <span class="keyword">while</span> (<span class="mxinfo " id="T18:U835"><span class="var type1" id="S97T1U1168">b</span> &gt; <span class="mxinfo " id="T1:U837">1</span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U838"><span class="mxinfo " id="T1:U839"><span class="var type1" id="S39T13U1173">dist</span>(<span class="mxinfo " id="T1:U841"><span class="var type1" id="S97T1U1175">b</span>-<span class="mxinfo " id="T1:U843">1</span></span>)</span>&gt; <span class="var type1" id="S96T1U1177">index</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line">                <span class="mxinfo " id="T19:U845"><span class="mxinfo " id="T19:U846"><span class="var type1" id="S37T11U1181">tpp</span>(<span class="var type1" id="S97T1U1182">b</span>,<span class="mxinfo " id="T1:U849">1</span>,<span class="mxinfo " id="T15:U850">:</span>)</span> = <span class="mxinfo " id="T19:U851"><span class="var type1" id="S37T11U1186">tpp</span>(<span class="mxinfo " id="T1:U853"><span class="var type1" id="S97T1U1188">b</span>-<span class="mxinfo " id="T1:U855">1</span></span>,<span class="mxinfo " id="T1:U856">1</span>,<span class="mxinfo " id="T15:U857">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line">                <span class="mxinfo " id="T19:U858"><span class="mxinfo " id="T19:U859"><span class="var type1" id="S37T11U1195">tpp</span>(<span class="var type1" id="S97T1U1196">b</span>,<span class="mxinfo " id="T1:U862">2</span>,<span class="mxinfo " id="T15:U863">:</span>)</span> = <span class="mxinfo " id="T19:U864"><span class="var type1" id="S37T11U1200">tpp</span>(<span class="mxinfo " id="T1:U866"><span class="var type1" id="S97T1U1202">b</span>-<span class="mxinfo " id="T1:U868">1</span></span>,<span class="mxinfo " id="T1:U869">2</span>,<span class="mxinfo " id="T15:U870">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line">                <span class="mxinfo " id="T29:U871"><span class="mxinfo " id="T29:U872"><span class="var type1" id="S38T12U1209">tff</span>(<span class="var type1" id="S97T1U1210">b</span>,<span class="mxinfo " id="T1:U875">1</span>,<span class="mxinfo " id="T30:U876">:</span>)</span> = <span class="mxinfo " id="T29:U877"><span class="var type1" id="S38T12U1214">tff</span>(<span class="mxinfo " id="T1:U879"><span class="var type1" id="S97T1U1216">b</span>-<span class="mxinfo " id="T1:U881">1</span></span>,<span class="mxinfo " id="T1:U882">1</span>,<span class="mxinfo " id="T30:U883">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line">                <span class="mxinfo " id="T29:U884"><span class="mxinfo " id="T29:U885"><span class="var type1" id="S38T12U1223">tff</span>(<span class="var type1" id="S97T1U1224">b</span>,<span class="mxinfo " id="T1:U888">2</span>,<span class="mxinfo " id="T30:U889">:</span>)</span> = <span class="mxinfo " id="T29:U890"><span class="var type1" id="S38T12U1228">tff</span>(<span class="mxinfo " id="T1:U892"><span class="var type1" id="S97T1U1230">b</span>-<span class="mxinfo " id="T1:U894">1</span></span>,<span class="mxinfo " id="T1:U895">2</span>,<span class="mxinfo " id="T30:U896">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line">                <span class="mxinfo " id="T1:U897"><span class="mxinfo " id="T1:U898"><span class="var type1" id="S39T13U1237">dist</span>(<span class="var type1" id="S97T1U1238">b</span>)</span> = <span class="mxinfo " id="T1:U901"><span class="var type1" id="S39T13U1240">dist</span>(<span class="mxinfo " id="T1:U903"><span class="var type1" id="S97T1U1242">b</span>-<span class="mxinfo " id="T1:U905">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line">                <span class="mxinfo " id="T1:U906"><span class="var type1" id="S97T1U1246">b</span> = <span class="mxinfo " id="T1:U908"><span class="var type1" id="S97T1U1248">b</span>-<span class="mxinfo " id="T1:U910">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line">            <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line">            <span class="mxinfo " id="T19:U911"><span class="mxinfo " id="T19:U912"><span class="var type1" id="S37T11U1253">tpp</span>(<span class="var type1" id="S97T1U1254">b</span>,<span class="mxinfo " id="T1:U915">1</span>,<span class="mxinfo " id="T15:U916">:</span>)</span> = <span class="mxinfo " id="T21:U917"><span class="var type1" id="S21T8U1258">ptemp</span>(<span class="mxinfo " id="T1:U919">1</span>,<span class="mxinfo " id="T15:U920">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line">            <span class="mxinfo " id="T19:U921"><span class="mxinfo " id="T19:U922"><span class="var type1" id="S37T11U1264">tpp</span>(<span class="var type1" id="S97T1U1265">b</span>,<span class="mxinfo " id="T1:U925">2</span>,<span class="mxinfo " id="T15:U926">:</span>)</span> = <span class="mxinfo " id="T21:U927"><span class="var type1" id="S21T8U1269">ptemp</span>(<span class="mxinfo " id="T1:U929">2</span>,<span class="mxinfo " id="T15:U930">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line">            <span class="mxinfo " id="T29:U931"><span class="mxinfo " id="T29:U932"><span class="var type1" id="S38T12U1275">tff</span>(<span class="var type1" id="S97T1U1276">b</span>,<span class="mxinfo " id="T1:U935">1</span>,<span class="mxinfo " id="T30:U936">:</span>)</span> = <span class="mxinfo " id="T31:U937"><span class="var type1" id="S22T9U1280">ftemp</span>(<span class="mxinfo " id="T1:U939">1</span>,<span class="mxinfo " id="T30:U940">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line">            <span class="mxinfo " id="T29:U941"><span class="mxinfo " id="T29:U942"><span class="var type1" id="S38T12U1286">tff</span>(<span class="var type1" id="S97T1U1287">b</span>,<span class="mxinfo " id="T1:U945">2</span>,<span class="mxinfo " id="T30:U946">:</span>)</span> = <span class="mxinfo " id="T31:U947"><span class="var type1" id="S22T9U1291">ftemp</span>(<span class="mxinfo " id="T1:U949">2</span>,<span class="mxinfo " id="T30:U950">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line">            <span class="mxinfo " id="T1:U951"><span class="mxinfo " id="T1:U952"><span class="var type1" id="S39T13U1297">dist</span>(<span class="var type1" id="S97T1U1298">b</span>)</span> = <span class="var type1" id="S96T1U1299">index</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line"><span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line"><span class="mxinfo " id="T1:U956"><span class="var type1" id="S98T1U1302">l</span> = <span class="mxinfo " id="T1:U958">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line"><span class="comment">% computing the parameters of penetration</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line"><span class="keyword">while</span> (<span class="mxinfo " id="T18:U959"><span class="var type1" id="S98T1U1308">l</span> &lt;= <span class="var type1" id="S69T1U1309">cnt</span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U962"><span class="var type1" id="S64T1U1312">msk</span> ~= <span class="mxinfo " id="T1:U964">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line">    <span class="mxinfo " id="T10:U965"><span class="mxinfo " id="T10:U966"><span class="var type1" id="S26T10U1317">mflag</span>(<span class="mxinfo " id="T30:U968">:</span>,<span class="mxinfo " id="T1:U969">1</span>)</span> = <span class="mxinfo " id="T10:U970">[<span class="mxinfo " id="T1:U971">0</span>;<span class="mxinfo " id="T1:U972">0</span>]</span></span>;    <span class="comment">% the value of mflag(1,1) could be 1,2,3; the value of mflag(2,1) could be 4,5,6</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line">    <span class="mxinfo " id="T1:U973"><span class="var type1" id="S99T1U1327">f1</span> = <span class="mxinfo " id="T1:U975"><span class="fcn" id="F159N3:B1329">BlockCheck</span>(<span class="mxinfo " id="T1:U976"><span class="var type1" id="S38T12U1331">tff</span>(<span class="var type1" id="S98T1U1332">l</span>,<span class="mxinfo " id="T16:U979">1</span>,<span class="mxinfo " id="T16:U980">1</span>)</span>,<span class="mxinfo " id="T19:U981"><span class="var type1" id="S37T11U1336">tpp</span>(<span class="var type1" id="S98T1U1337">l</span>,<span class="mxinfo " id="T16:U984">1</span>,<span class="mxinfo " id="T15:U985">:</span>)</span>)</span></span>;    <span class="comment">% it checks if the 1st penetration point belongs to some other block (-1 if not)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T18:U986"><span class="var type1" id="S98T1U1346">l</span> &gt; <span class="mxinfo " id="T1:U988">1</span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U989"><span class="var type1" id="S99T1U1350">f1</span> == <span class="mxinfo " id="T1:U991">-<span class="mxinfo " id="T1:U992">1</span></span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U993"><span class="var type1" id="S50T1U1355">fe</span> == <span class="mxinfo " id="T1:U995">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line">        <span class="mxinfo " id="T23:U996"><span class="extrinsicFcn" id="F234N5:B1359">disp</span>(<span class="mxinfo " id="T32:U997"><span class="string">'Error: No input for previous output!'</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line">        <span class="mxinfo " id="T23:U998"><span class="extrinsicFcn" id="F235N6:B1363">exit</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T18:U999"><span class="var type1" id="S98T1U1370">l</span> &gt; <span class="mxinfo " id="T1:U1001">1</span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U1002"><span class="var type1" id="S50T1U1374">fe</span> == <span class="mxinfo " id="T1:U1004">0</span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U1005"><span class="var type1" id="S99T1U1378">f1</span> ~= <span class="mxinfo " id="T1:U1007">-<span class="mxinfo " id="T1:U1008">1</span></span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197">197</a></span><span class="line">        <span class="mxinfo " id="T23:U1009"><span class="extrinsicFcn" id="F236N5:B1383">disp</span>(<span class="mxinfo " id="T33:U1010"><span class="string">'Error: No previous output for this input!'</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198">198</a></span><span class="line">        <span class="mxinfo " id="T23:U1011"><span class="extrinsicFcn" id="F237N6:B1387">exit</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199">199</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200">200</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1012"><span class="var type1" id="S99T1U1394">f1</span> ~= <span class="mxinfo " id="T1:U1014">-<span class="mxinfo " id="T1:U1015">1</span></span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U1016"><span class="var type1" id="S98T1U1399">l</span> == <span class="mxinfo " id="T1:U1018">1</span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U1019"><span class="mxinfo " id="T1:U1020"><span class="var type1" id="S39T13U1404">dist</span>(<span class="var type1" id="S98T1U1405">l</span>)</span> &gt; <span class="mxinfo " id="T1:U1023">0.005</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201">201</a></span><span class="line">        <span class="mxinfo " id="T23:U1024"><span class="extrinsicFcn" id="F238N5:B1409">disp</span>(<span class="mxinfo " id="T34:U1025"><span class="string">'Error: Cannot be 1st penetration!'</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,202" id="srcline202">202</a></span><span class="line">        <span class="mxinfo " id="T1:U1026"><span class="var type1" id="S64T1U1413">msk</span> = <span class="mxinfo " id="T1:U1028">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,203" id="srcline203">203</a></span><span class="line">        <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,204" id="srcline204">204</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205">205</a></span><span class="line">    <span class="mxinfo " id="T1:U1029"><span class="var type1" id="S101T1U1418">f2</span> = <span class="mxinfo " id="T1:U1031"><span class="fcn" id="F159N3:B1420">BlockCheck</span>(<span class="mxinfo " id="T1:U1032"><span class="var type1" id="S38T12U1422">tff</span>(<span class="var type1" id="S98T1U1423">l</span>,<span class="mxinfo " id="T16:U1035">2</span>,<span class="mxinfo " id="T16:U1036">1</span>)</span>,<span class="mxinfo " id="T19:U1037"><span class="var type1" id="S37T11U1427">tpp</span>(<span class="var type1" id="S98T1U1428">l</span>,<span class="mxinfo " id="T16:U1040">2</span>,<span class="mxinfo " id="T15:U1041">:</span>)</span>)</span></span>;    <span class="comment">% it checks if the 2nd penetration point belongs to some other block (-1 if not)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206">206</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1042"><span class="var type1" id="S101T1U1436">f2</span> ~= <span class="mxinfo " id="T1:U1044">-<span class="mxinfo " id="T1:U1045">1</span></span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U1046"><span class="var type1" id="S98T1U1441">l</span> == <span class="var type1" id="S69T1U1442">cnt</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207">207</a></span><span class="line">        <span class="mxinfo " id="T7:U1049"><span class="mxinfo " id="T7:U1050"><span class="var type1" id="S23T7U1446">tpp_re</span>(<span class="mxinfo " id="T15:U1052">:</span>,<span class="mxinfo " id="T1:U1053">1</span>)</span> = <span class="mxinfo " id="T19:U1054"><span class="var type1" id="S37T11U1450">tpp</span>(<span class="var type1" id="S98T1U1451">l</span>,<span class="mxinfo " id="T1:U1057">2</span>,<span class="mxinfo " id="T15:U1058">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208">208</a></span><span class="line">        <span class="mxinfo " id="T7:U1059"><span class="var type1" id="S93T7U1456">d2</span> = <span class="mxinfo " id="T7:U1061"><span class="var type1" id="S28T7U1458">P2</span> - <span class="var type1" id="S23T7U1459">tpp_re</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209">209</a></span><span class="line">	    <span class="mxinfo " id="T1:U1064"><span class="var type1" id="S102T1U1462">dist2</span> = <span class="mxinfo " id="T1:U1066">norm(<span class="var type1" id="S93T7U1465">d2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210">210</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,211" id="srcline211">211</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1068"><span class="var type1" id="S102T1U1470">dist2</span> &gt; <span class="mxinfo " id="T1:U1070">0.005</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,212" id="srcline212">212</a></span><span class="line">			<span class="mxinfo " id="T23:U1071"><span class="extrinsicFcn" id="F239N5:B1474">disp</span>(<span class="mxinfo " id="T35:U1072"><span class="string">'Error: Cannot be last penetration!'</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,213" id="srcline213">213</a></span><span class="line">			<span class="mxinfo " id="T1:U1073"><span class="var type1" id="S64T1U1478">msk</span> = <span class="mxinfo " id="T1:U1075">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,214" id="srcline214">214</a></span><span class="line">			<span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,215" id="srcline215">215</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,216" id="srcline216">216</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,217" id="srcline217">217</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1076"><span class="var type1" id="S101T1U1485">f2</span> ~= <span class="mxinfo " id="T1:U1078">-<span class="mxinfo " id="T1:U1079">1</span></span></span>)    <span class="comment">% fe==1 means that the output penetration point belongs to another block -&gt; to be used in next loop execution</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,218" id="srcline218">218</a></span><span class="line">		<span class="mxinfo " id="T1:U1080"><span class="var type1" id="S50T1U1490">fe</span> = <span class="mxinfo " id="T1:U1082">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,219" id="srcline219">219</a></span><span class="line">	<span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,220" id="srcline220">220</a></span><span class="line">		<span class="mxinfo " id="T1:U1083"><span class="var type1" id="S50T1U1495">fe</span> = <span class="mxinfo " id="T1:U1085">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,221" id="srcline221">221</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,222" id="srcline222">222</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223">223</a></span><span class="line">    <span class="mxinfo " id="T7:U1086"><span class="mxinfo " id="T7:U1087"><span class="var type1" id="S23T7U1500">tpp_re</span>(<span class="mxinfo " id="T15:U1089">:</span>,<span class="mxinfo " id="T1:U1090">1</span>)</span> = <span class="mxinfo " id="T19:U1091"><span class="var type1" id="S37T11U1504">tpp</span>(<span class="var type1" id="S98T1U1505">l</span>,<span class="mxinfo " id="T1:U1094">2</span>,<span class="mxinfo " id="T15:U1095">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224">224</a></span><span class="line">	<span class="mxinfo " id="T7:U1096"><span class="var type1" id="S93T7U1510">d2</span> = <span class="mxinfo " id="T7:U1098"><span class="var type1" id="S27T7U1512">P1</span>-<span class="var type1" id="S23T7U1513">tpp_re</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,225" id="srcline225">225</a></span><span class="line">    <span class="mxinfo " id="T1:U1101"><span class="var type1" id="S102T1U1516">dist2</span> = <span class="mxinfo " id="T1:U1103">norm(<span class="var type1" id="S93T7U1519">d2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,226" id="srcline226">226</a></span><span class="line">	<span class="mxinfo " id="T1:U1105"><span class="var type1" id="S103T1U1522">dp</span> = <span class="mxinfo " id="T1:U1107">abs(<span class="mxinfo " id="T1:U1108"><span class="mxinfo " id="T1:U1109"><span class="var type1" id="S39T13U1527">dist</span>(<span class="var type1" id="S98T1U1528">l</span>)</span>-<span class="var type1" id="S102T1U1529">dist2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,227" id="srcline227">227</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,228" id="srcline228">228</a></span><span class="line">	<span class="keyword">if</span> (<span class="mxinfo " id="T18:U1113"><span class="var type1" id="S99T1U1535">f1</span>~=<span class="mxinfo " id="T1:U1115">-<span class="mxinfo " id="T1:U1116">1</span></span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U1117"><span class="var type1" id="S98T1U1540">l</span>==<span class="mxinfo " id="T1:U1119">1</span></span>) </span></span>
<span class="srcline"><span class="lineno"><a href="1,229" id="srcline229">229</a></span><span class="line">        <span class="keyword">if</span> ((<span class="mxinfo " id="T18:U1120"><span class="var type1" id="S99T1U1548">f1</span>~=<span class="mxinfo " id="T1:U1122">0</span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U1123">(<span class="mxinfo " id="T1:U1124">real(<span class="mxinfo " id="T14:U1125"><span class="var type1" id="S8T36U1556">eta</span>(<span class="mxinfo " id="T1:U1127"><span class="var type1" id="S38T12U1558">tff</span>(<span class="var type1" id="S98T1U1559">l</span>,<span class="mxinfo " id="T16:U1130">1</span>,<span class="mxinfo " id="T16:U1131">1</span>)</span>)</span>)</span>) == (<span class="mxinfo " id="T1:U1132">real(<span class="mxinfo " id="T14:U1133"><span class="var type1" id="S8T36U1566">eta</span>(<span class="var type1" id="S99T1U1567">f1</span>)</span>)</span>)</span>)) <span class="comment">%|| ((f1==0) &amp;&amp; ((real(eta(tff(l,1,1)))) == (real(Geta)))) </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,230" id="srcline230">230</a></span><span class="line">            <span class="mxinfo " id="T1:U1136"><span class="var type1" id="S64T1U1570">msk</span> = <span class="mxinfo " id="T1:U1138">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,231" id="srcline231">231</a></span><span class="line">			<span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,232" id="srcline232">232</a></span><span class="line">        <span class="keyword">else</span>     <span class="comment">% mflag(1) to distinguish different possibilities when f1 ~= -1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,233" id="srcline233">233</a></span><span class="line">			<span class="mxinfo " id="T1:U1139"><span class="mxinfo " id="T1:U1140"><span class="var type1" id="S26T10U1577">mflag</span>(<span class="mxinfo " id="T1:U1142">1</span>)</span> = <span class="mxinfo " id="T1:U1143">1</span></span>;    <span class="comment">% 1st penetration point is P1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,234" id="srcline234">234</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,235" id="srcline235">235</a></span><span class="line">	<span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,236" id="srcline236">236</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1144"><span class="var type1" id="S99T1U1586">f1</span> ~= <span class="mxinfo " id="T1:U1146">-<span class="mxinfo " id="T1:U1147">1</span></span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U1148"><span class="var type1" id="S98T1U1591">l</span> &gt; <span class="mxinfo " id="T1:U1150">1</span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U1151"><span class="var type1" id="S50T1U1595">fe</span> == <span class="mxinfo " id="T1:U1153">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,237" id="srcline237">237</a></span><span class="line">        <span class="keyword">if</span> ((<span class="mxinfo " id="T18:U1154"><span class="var type1" id="S99T1U1603">f1</span>~=<span class="mxinfo " id="T1:U1156">0</span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U1157">(<span class="mxinfo " id="T1:U1158">real(<span class="mxinfo " id="T14:U1159"><span class="var type1" id="S8T36U1611">eta</span>(<span class="mxinfo " id="T1:U1161"><span class="var type1" id="S38T12U1613">tff</span>(<span class="var type1" id="S98T1U1614">l</span>,<span class="mxinfo " id="T16:U1164">1</span>,<span class="mxinfo " id="T16:U1165">1</span>)</span>)</span>)</span>) == (<span class="mxinfo " id="T1:U1166">real(<span class="mxinfo " id="T14:U1167"><span class="var type1" id="S8T36U1621">eta</span>(<span class="var type1" id="S99T1U1622">f1</span>)</span>)</span>)</span>)) <span class="comment">%|| ((f1==0) &amp;&amp; ((real(eta(tff(l,1,1)))) == (real(Geta)))) % should update here</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,238" id="srcline238">238</a></span><span class="line">            <span class="mxinfo " id="T1:U1170"><span class="mxinfo " id="T1:U1171"><span class="var type1" id="S26T10U1626">mflag</span>(<span class="mxinfo " id="T1:U1173">1</span>)</span> = <span class="mxinfo " id="T1:U1174">2</span></span>;	<span class="comment">% input penetration point is an output penetration point of a previous penetration in the same path - same epsilon</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,239" id="srcline239">239</a></span><span class="line">		<span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,240" id="srcline240">240</a></span><span class="line">			<span class="mxinfo " id="T1:U1175"><span class="mxinfo " id="T1:U1176"><span class="var type1" id="S26T10U1633">mflag</span>(<span class="mxinfo " id="T1:U1178">1</span>)</span> = <span class="mxinfo " id="T1:U1179">3</span></span>;	<span class="comment">% as above but different epsilon</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,241" id="srcline241">241</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,242" id="srcline242">242</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,243" id="srcline243">243</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1180"><span class="mxinfo " id="T1:U1181"><span class="var type1" id="S26T10U1642">mflag</span>(<span class="mxinfo " id="T16:U1183">1</span>)</span> == <span class="mxinfo " id="T1:U1184">0</span></span>) || (<span class="mxinfo " id="T18:U1185"><span class="mxinfo " id="T1:U1186"><span class="var type1" id="S26T10U1648">mflag</span>(<span class="mxinfo " id="T16:U1188">1</span>)</span> == <span class="mxinfo " id="T1:U1189">3</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,244" id="srcline244">244</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1190"><span class="mxinfo " id="T1:U1191"><span class="var type1" id="S26T10U1656">mflag</span>(<span class="mxinfo " id="T16:U1193">1</span>)</span> == <span class="mxinfo " id="T1:U1194">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,245" id="srcline245">245</a></span><span class="line">			<span class="mxinfo " id="T7:U1195"><span class="var type1" id="S40T7U1661">si</span> = <span class="var type1" id="S68T7U1662">sdp</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,246" id="srcline246">246</a></span><span class="line">        <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,247" id="srcline247">247</a></span><span class="line">        <span class="mxinfo " id="T7:U1198"><span class="mxinfo " id="T7:U1199"><span class="var type1" id="S24T7U1666">vnfaces_re</span>(<span class="mxinfo " id="T15:U1201">:</span>,<span class="mxinfo " id="T16:U1202">1</span>)</span> = <span class="mxinfo " id="T19:U1203"><span class="var type1" id="S9T20U1670">vnfaces</span>(<span class="mxinfo " id="T1:U1205"><span class="var type1" id="S38T12U1672">tff</span>(<span class="var type1" id="S98T1U1673">l</span>,<span class="mxinfo " id="T16:U1208">1</span>,<span class="mxinfo " id="T16:U1209">1</span>)</span>,<span class="mxinfo " id="T1:U1210"><span class="var type1" id="S38T12U1677">tff</span>(<span class="var type1" id="S98T1U1678">l</span>,<span class="mxinfo " id="T16:U1213">1</span>,<span class="mxinfo " id="T16:U1214">2</span>)</span>,<span class="mxinfo " id="T15:U1215">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,248" id="srcline248">248</a></span><span class="line">	    <span class="mxinfo " id="T7:U1216"><span class="var type1" id="S105T7U1684">et</span> = <span class="mxinfo " id="T7:U1218">cross(<span class="var type1" id="S40T7U1687">si</span>,<span class="var type1" id="S24T7U1688">vnfaces_re</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,249" id="srcline249">249</a></span><span class="line">		<span class="mxinfo " id="T14:U1221"><span class="var type1" id="S56T14U1691">sti2</span> = <span class="mxinfo " id="T14:U1223">complex(<span class="mxinfo " id="T1:U1224"><span class="mxinfo " id="T1:U1225">norm(<span class="var type1" id="S105T7U1697">et</span>)</span>^2</span>,<span class="mxinfo " id="T1:U1227">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,250" id="srcline250">250</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1228"><span class="mxinfo " id="T1:U1229"><span class="var type1" id="S26T10U1705">mflag</span>(<span class="mxinfo " id="T16:U1231">1</span>)</span> == <span class="mxinfo " id="T1:U1232">3</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,251" id="srcline251">251</a></span><span class="line"><span class="comment">%             if f1 == 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,252" id="srcline252">252</a></span><span class="line"><span class="comment">%                 teps = sqrt(eta(tff(l,1,1))/Geta);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,253" id="srcline253">253</a></span><span class="line"><span class="comment">%             else </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,254" id="srcline254">254</a></span><span class="line">			    <span class="mxinfo " id="T14:U1233"><span class="var type1" id="S51T14U1710">teps</span> = <span class="mxinfo " id="T14:U1235">sqrt(<span class="mxinfo " id="T14:U1236"><span class="mxinfo " id="T14:U1237"><span class="var type1" id="S8T36U1715">eta</span>(<span class="mxinfo " id="T1:U1239"><span class="var type1" id="S38T12U1717">tff</span>(<span class="var type1" id="S98T1U1718">l</span>,<span class="mxinfo " id="T16:U1242">1</span>,<span class="mxinfo " id="T16:U1243">1</span>)</span>)</span>/<span class="mxinfo " id="T14:U1244"><span class="var type1" id="S8T36U1722">eta</span>(<span class="var type1" id="S99T1U1723">f1</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,255" id="srcline255">255</a></span><span class="line"><span class="comment">%             end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,256" id="srcline256">256</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,257" id="srcline257">257</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1247"><span class="mxinfo " id="T1:U1248">norm(<span class="var type1" id="S105T7U1730">et</span>)</span> &gt; <span class="mxinfo " id="T1:U1250">real(<span class="var type1" id="S51T14U1733">teps</span>)</span></span>)    <span class="comment">% total internal reflection</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,258" id="srcline258">258</a></span><span class="line">                <span class="mxinfo " id="T1:U1252"><span class="var type1" id="S64T1U1736">msk</span> = <span class="mxinfo " id="T1:U1254">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,259" id="srcline259">259</a></span><span class="line">				<span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,260" id="srcline260">260</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,261" id="srcline261">261</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,262" id="srcline262">262</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,263" id="srcline263">263</a></span><span class="line">		<span class="mxinfo " id="T14:U1255"><span class="var type1" id="S57T14U1741">cti</span> = <span class="mxinfo " id="T14:U1257">complex(<span class="mxinfo " id="T1:U1258">sqrt(<span class="mxinfo " id="T1:U1259"><span class="mxinfo " id="T1:U1260">1</span>-<span class="mxinfo " id="T1:U1261">real(<span class="var type1" id="S56T14U1750">sti2</span>)</span></span>)</span>,<span class="mxinfo " id="T1:U1263">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,264" id="srcline264">264</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,265" id="srcline265">265</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1264"><span class="mxinfo " id="T1:U1265">norm(<span class="var type1" id="S105T7U1758">et</span>)</span> &lt;= <span class="mxinfo " id="T1:U1267">1.0e-6</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,266" id="srcline266">266</a></span><span class="line">			<span class="mxinfo " id="T7:U1268"><span class="var type1" id="S14T7U1762">eti</span> = <span class="mxinfo " id="T7:U1270">[<span class="mxinfo " id="T1:U1271">0</span>;<span class="mxinfo " id="T1:U1272">0</span>;<span class="mxinfo " id="T1:U1273">1</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,267" id="srcline267">267</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,268" id="srcline268">268</a></span><span class="line">            <span class="mxinfo " id="T7:U1274"><span class="var type1" id="S14T7U1773">eti</span> = <span class="mxinfo " id="T7:U1276"><span class="mxinfo " id="T1:U1277"><span class="mxinfo " id="T1:U1278">1</span>/<span class="mxinfo " id="T1:U1279">norm(<span class="var type1" id="S105T7U1779">et</span>)</span></span>*<span class="var type1" id="S105T7U1780">et</span></span></span>;    <span class="comment">% 'eti' is the unitary vector of perpendicular vector (incident field)--- 1st interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,269" id="srcline269">269</a></span><span class="line">        <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,270" id="srcline270">270</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,271" id="srcline271">271</a></span><span class="line">	    <span class="mxinfo " id="T7:U1282"><span class="var type1" id="S12T7U1783">ehi</span> = <span class="mxinfo " id="T7:U1284">cross(<span class="var type1" id="S14T7U1786">eti</span>,<span class="var type1" id="S40T7U1787">si</span>)</span></span>;    <span class="comment">% 'ehi' is the unitary vector of parallel vector (incident field) --- 1st interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,272" id="srcline272">272</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,273" id="srcline273">273</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1287"><span class="mxinfo " id="T1:U1288"><span class="var type1" id="S26T10U1793">mflag</span>(<span class="mxinfo " id="T16:U1290">1</span>)</span> == <span class="mxinfo " id="T1:U1291">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,274" id="srcline274">274</a></span><span class="line">			<span class="mxinfo " id="T14:U1292"><span class="var type1" id="S108T14U1798">eoe</span> = <span class="mxinfo " id="T14:U1294">sqrt(<span class="mxinfo " id="T14:U1295">1/<span class="mxinfo " id="T14:U1296"><span class="var type1" id="S8T36U1804">eta</span>(<span class="mxinfo " id="T1:U1298"><span class="var type1" id="S38T12U1806">tff</span>(<span class="var type1" id="S98T1U1807">l</span>,<span class="mxinfo " id="T16:U1301">1</span>,<span class="mxinfo " id="T16:U1302">1</span>)</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,275" id="srcline275">275</a></span><span class="line">		<span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,276" id="srcline276">276</a></span><span class="line">			<span class="mxinfo " id="T14:U1303"><span class="var type1" id="S108T14U1813">eoe</span> = <span class="var type1" id="S51T14U1814">teps</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,277" id="srcline277">277</a></span><span class="line">        <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,278" id="srcline278">278</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,279" id="srcline279">279</a></span><span class="line">		<span class="mxinfo " id="T14:U1306"><span class="var type1" id="S109T14U1817">stt</span> = <span class="mxinfo " id="T14:U1308"><span class="mxinfo " id="T1:U1309">norm(<span class="var type1" id="S105T7U1821">et</span>)</span>*<span class="var type1" id="S108T14U1822">eoe</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,280" id="srcline280">280</a></span><span class="line">		<span class="mxinfo " id="T1:U1312"><span class="var type1" id="S110T1U1825">rstt</span> = <span class="mxinfo " id="T1:U1314">real(<span class="var type1" id="S109T14U1828">stt</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,281" id="srcline281">281</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,282" id="srcline282">282</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1316"><span class="mxinfo " id="T1:U1317">real(<span class="var type1" id="S109T14U1835">stt</span>)</span> &gt; <span class="mxinfo " id="T1:U1319">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,283" id="srcline283">283</a></span><span class="line">            <span class="mxinfo " id="T1:U1320"><span class="var type1" id="S64T1U1839">msk</span> = <span class="mxinfo " id="T1:U1322">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,284" id="srcline284">284</a></span><span class="line">			<span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,285" id="srcline285">285</a></span><span class="line">        <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,286" id="srcline286">286</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,287" id="srcline287">287</a></span><span class="line">		<span class="mxinfo " id="T1:U1323"><span class="var type1" id="S111T1U1844">ctt</span> = <span class="mxinfo " id="T1:U1325">sqrt(<span class="mxinfo " id="T1:U1326"><span class="mxinfo " id="T1:U1327">1</span>-<span class="mxinfo " id="T1:U1328"><span class="var type1" id="S110T1U1850">rstt</span>^2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,288" id="srcline288">288</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,289" id="srcline289">289</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1330"><span class="mxinfo " id="T1:U1331">norm(<span class="var type1" id="S105T7U1858">et</span>)</span> &lt;= <span class="mxinfo " id="T1:U1333">1.0e-6</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,290" id="srcline290">290</a></span><span class="line">            <span class="mxinfo " id="T7:U1334"><span class="var type1" id="S41T7U1862">st</span> = <span class="var type1" id="S40T7U1863">si</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,291" id="srcline291">291</a></span><span class="line">			<span class="mxinfo " id="T7:U1337"><span class="var type1" id="S15T7U1866">ett</span> = <span class="var type1" id="S14T7U1867">eti</span></span>;    <span class="comment">% 'ett' is the unitary vector of perpendicular vector (transmission field) --- 1st interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,292" id="srcline292">292</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,293" id="srcline293">293</a></span><span class="line">		    <span class="mxinfo " id="T1:U1340"><span class="var type1" id="S112T1U1871">ksi</span> = <span class="mxinfo " id="T1:U1342">real(<span class="var type1" id="S108T14U1874">eoe</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,294" id="srcline294">294</a></span><span class="line">		    <span class="mxinfo " id="T1:U1344"><span class="var type1" id="S113T1U1877">kn</span> = <span class="mxinfo " id="T1:U1346"><span class="mxinfo " id="T1:U1347">sqrt(<span class="mxinfo " id="T1:U1348"><span class="mxinfo " id="T1:U1349">1</span>-(<span class="mxinfo " id="T1:U1350">(<span class="mxinfo " id="T1:U1351"><span class="var type1" id="S112T1U1887">ksi</span>*<span class="mxinfo " id="T1:U1353">sqrt(<span class="mxinfo " id="T1:U1354">real(<span class="var type1" id="S56T14U1892">sti2</span>)</span>)</span></span>)^2</span>)</span>)</span> + (<span class="mxinfo " id="T1:U1356"><span class="var type1" id="S112T1U1896">ksi</span>*<span class="mxinfo " id="T1:U1358">real(<span class="var type1" id="S57T14U1899">cti</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,295" id="srcline295">295</a></span><span class="line">            <span class="mxinfo " id="T7:U1360"><span class="mxinfo " id="T7:U1361"><span class="var type1" id="S24T7U1903">vnfaces_re</span>(<span class="mxinfo " id="T15:U1363">:</span>,<span class="mxinfo " id="T16:U1364">1</span>)</span> = <span class="mxinfo " id="T19:U1365"><span class="var type1" id="S9T20U1907">vnfaces</span>(<span class="mxinfo " id="T1:U1367"><span class="var type1" id="S38T12U1909">tff</span>(<span class="var type1" id="S98T1U1910">l</span>,<span class="mxinfo " id="T16:U1370">1</span>,<span class="mxinfo " id="T16:U1371">1</span>)</span>,<span class="mxinfo " id="T1:U1372"><span class="var type1" id="S38T12U1914">tff</span>(<span class="var type1" id="S98T1U1915">l</span>,<span class="mxinfo " id="T16:U1375">1</span>,<span class="mxinfo " id="T16:U1376">2</span>)</span>,<span class="mxinfo " id="T15:U1377">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,296" id="srcline296">296</a></span><span class="line">			<span class="mxinfo " id="T7:U1378"><span class="var type1" id="S41T7U1921">st</span> = <span class="mxinfo " id="T7:U1380"><span class="mxinfo " id="T7:U1381"><span class="var type1" id="S112T1U1924">ksi</span>*<span class="var type1" id="S40T7U1925">si</span></span>-<span class="mxinfo " id="T7:U1384"><span class="var type1" id="S113T1U1927">kn</span>*<span class="var type1" id="S24T7U1928">vnfaces_re</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,297" id="srcline297">297</a></span><span class="line">			<span class="mxinfo " id="T7:U1387"><span class="var type1" id="S15T7U1931">ett</span> = <span class="var type1" id="S14T7U1932">eti</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,298" id="srcline298">298</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,299" id="srcline299">299</a></span><span class="line">	    <span class="mxinfo " id="T7:U1390"><span class="var type1" id="S41T7U1935">st</span> = <span class="mxinfo " id="T7:U1392"><span class="mxinfo " id="T1:U1393"><span class="mxinfo " id="T1:U1394">1</span>/<span class="mxinfo " id="T1:U1395">norm(<span class="var type1" id="S41T7U1941">st</span>)</span></span>*<span class="var type1" id="S41T7U1942">st</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,300" id="srcline300">300</a></span><span class="line">		<span class="mxinfo " id="T7:U1398"><span class="var type1" id="S16T7U1945">eht</span> = <span class="mxinfo " id="T7:U1400">cross(<span class="var type1" id="S15T7U1948">ett</span>,<span class="var type1" id="S41T7U1949">st</span>)</span></span>;    <span class="comment">% 'eht' is the unitary vector of parallel vector (transmission field) --- 1st interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,301" id="srcline301">301</a></span><span class="line">    <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,302" id="srcline302">302</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1403"><span class="mxinfo " id="T1:U1404"><span class="var type1" id="S26T10U1955">mflag</span>(<span class="mxinfo " id="T16:U1406">1</span>)</span> == <span class="mxinfo " id="T1:U1407">2</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,303" id="srcline303">303</a></span><span class="line">        <span class="mxinfo " id="T7:U1408"><span class="var type1" id="S41T7U1960">st</span> = <span class="var type1" id="S40T7U1961">si</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,304" id="srcline304">304</a></span><span class="line">    <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,305" id="srcline305">305</a></span><span class="line">	<span class="keyword">if</span> (<span class="mxinfo " id="T18:U1411"><span class="mxinfo " id="T1:U1412"><span class="var type1" id="S26T10U1967">mflag</span>(<span class="mxinfo " id="T16:U1414">1</span>)</span> == <span class="mxinfo " id="T1:U1415">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,306" id="srcline306">306</a></span><span class="line">		<span class="mxinfo " id="T7:U1416"><span class="var type1" id="S41T7U1972">st</span> = <span class="var type1" id="S68T7U1973">sdp</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,307" id="srcline307">307</a></span><span class="line">    <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,308" id="srcline308">308</a></span><span class="line">	<span class="keyword">if</span> (<span class="mxinfo " id="T18:U1419"><span class="var type1" id="S101T1U1979">f2</span> ~= <span class="mxinfo " id="T1:U1421">-<span class="mxinfo " id="T1:U1422">1</span></span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U1423"><span class="var type1" id="S98T1U1984">l</span> == <span class="var type1" id="S69T1U1985">cnt</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,309" id="srcline309">309</a></span><span class="line">		<span class="keyword">if</span> ((<span class="mxinfo " id="T18:U1426"><span class="var type1" id="S101T1U1992">f2</span>~=<span class="mxinfo " id="T1:U1428">0</span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U1429">(<span class="mxinfo " id="T1:U1430">real(<span class="mxinfo " id="T14:U1431"><span class="var type1" id="S8T36U2000">eta</span>(<span class="mxinfo " id="T1:U1433"><span class="var type1" id="S38T12U2002">tff</span>(<span class="var type1" id="S98T1U2003">l</span>,<span class="mxinfo " id="T16:U1436">2</span>,<span class="mxinfo " id="T16:U1437">1</span>)</span>)</span>)</span>) == (<span class="mxinfo " id="T1:U1438">real(<span class="mxinfo " id="T14:U1439"><span class="var type1" id="S8T36U2010">eta</span>(<span class="var type1" id="S101T1U2011">f2</span>)</span>)</span>)</span>)) <span class="comment">%|| ((f2==0) &amp;&amp; ((real(eta(tff(l,2,1)))) == real(Geta)))</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,310" id="srcline310">310</a></span><span class="line">			<span class="mxinfo " id="T1:U1442"><span class="var type1" id="S64T1U2014">msk</span> = <span class="mxinfo " id="T1:U1444">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,311" id="srcline311">311</a></span><span class="line">			<span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,312" id="srcline312">312</a></span><span class="line">        <span class="keyword">else</span>    <span class="comment">% mflag(2) to distinguish different possibilities when f2 ~= -1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,313" id="srcline313">313</a></span><span class="line">			<span class="mxinfo " id="T1:U1445"><span class="mxinfo " id="T1:U1446"><span class="var type1" id="S26T10U2021">mflag</span>(<span class="mxinfo " id="T1:U1448">2</span>)</span> = <span class="mxinfo " id="T1:U1449">4</span></span>;    <span class="comment">% 2nd penetration point is P2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,314" id="srcline314">314</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,315" id="srcline315">315</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,316" id="srcline316">316</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1450"><span class="var type1" id="S101T1U2030">f2</span> ~= <span class="mxinfo " id="T1:U1452">-<span class="mxinfo " id="T1:U1453">1</span></span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U1454"><span class="var type1" id="S98T1U2035">l</span>&gt;<span class="mxinfo " id="T1:U1456">1</span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U1457"><span class="var type1" id="S98T1U2039">l</span> ~= <span class="var type1" id="S69T1U2040">cnt</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,317" id="srcline317">317</a></span><span class="line">	    <span class="keyword">if</span> ((<span class="mxinfo " id="T18:U1460"><span class="var type1" id="S101T1U2047">f2</span>~=<span class="mxinfo " id="T1:U1462">0</span></span>) &amp;&amp; (<span class="mxinfo " id="T18:U1463">(<span class="mxinfo " id="T1:U1464">real(<span class="mxinfo " id="T14:U1465"><span class="var type1" id="S8T36U2055">eta</span>(<span class="mxinfo " id="T1:U1467"><span class="var type1" id="S38T12U2057">tff</span>(<span class="var type1" id="S98T1U2058">l</span>,<span class="mxinfo " id="T16:U1470">2</span>,<span class="mxinfo " id="T16:U1471">1</span>)</span>)</span>)</span>) == (<span class="mxinfo " id="T1:U1472">real(<span class="mxinfo " id="T14:U1473"><span class="var type1" id="S8T36U2065">eta</span>(<span class="var type1" id="S101T1U2066">f2</span>)</span>)</span>)</span>)) <span class="comment">%|| ((f2==0) &amp;&amp; ((real(eta(tff(l,2,1)))) == real(Geta)))</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,318" id="srcline318">318</a></span><span class="line">			<span class="mxinfo " id="T1:U1476"><span class="mxinfo " id="T1:U1477"><span class="var type1" id="S26T10U2070">mflag</span>(<span class="mxinfo " id="T1:U1479">2</span>)</span> = <span class="mxinfo " id="T1:U1480">5</span></span>;    <span class="comment">% output penetration point is an input penetration point of a following penetration in the same path -  same epsilon</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,319" id="srcline319">319</a></span><span class="line">		<span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,320" id="srcline320">320</a></span><span class="line">			<span class="mxinfo " id="T1:U1481"><span class="mxinfo " id="T1:U1482"><span class="var type1" id="S26T10U2077">mflag</span>(<span class="mxinfo " id="T1:U1484">2</span>)</span> = <span class="mxinfo " id="T1:U1485">6</span></span>;    <span class="comment">% as above but different epsilon</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,321" id="srcline321">321</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,322" id="srcline322">322</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,323" id="srcline323">323</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1486"><span class="mxinfo " id="T1:U1487"><span class="var type1" id="S26T10U2086">mflag</span>(<span class="mxinfo " id="T16:U1489">2</span>)</span> == <span class="mxinfo " id="T1:U1490">0</span></span>) || (<span class="mxinfo " id="T18:U1491"><span class="mxinfo " id="T1:U1492"><span class="var type1" id="S26T10U2092">mflag</span>(<span class="mxinfo " id="T16:U1494">2</span>)</span> == <span class="mxinfo " id="T1:U1495">6</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,324" id="srcline324">324</a></span><span class="line">		<span class="mxinfo " id="T7:U1496"><span class="mxinfo " id="T7:U1497"><span class="var type1" id="S25T7U2098">tp</span>(<span class="mxinfo " id="T15:U1499">:</span>,<span class="mxinfo " id="T16:U1500">1</span>)</span> = <span class="mxinfo " id="T19:U1501">-<span class="mxinfo " id="T19:U1502"><span class="var type1" id="S9T20U2103">vnfaces</span>(<span class="mxinfo " id="T1:U1504"><span class="var type1" id="S38T12U2105">tff</span>(<span class="var type1" id="S98T1U2106">l</span>,<span class="mxinfo " id="T16:U1507">2</span>,<span class="mxinfo " id="T16:U1508">1</span>)</span>,<span class="mxinfo " id="T1:U1509"><span class="var type1" id="S38T12U2110">tff</span>(<span class="var type1" id="S98T1U2111">l</span>,<span class="mxinfo " id="T16:U1512">2</span>,<span class="mxinfo " id="T16:U1513">2</span>)</span>,<span class="mxinfo " id="T15:U1514">:</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,325" id="srcline325">325</a></span><span class="line">		<span class="mxinfo " id="T7:U1515"><span class="var type1" id="S105T7U2117">et</span> = <span class="mxinfo " id="T7:U1517">cross(<span class="var type1" id="S41T7U2120">st</span>,<span class="var type1" id="S25T7U2121">tp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,326" id="srcline326">326</a></span><span class="line">		<span class="mxinfo " id="T14:U1520"><span class="var type1" id="S58T14U2124">str2</span> = <span class="mxinfo " id="T14:U1522">complex(<span class="mxinfo " id="T1:U1523"><span class="mxinfo " id="T1:U1524">norm(<span class="var type1" id="S105T7U2130">et</span>)</span>^2</span>,<span class="mxinfo " id="T1:U1526">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,327" id="srcline327">327</a></span><span class="line">		<span class="mxinfo " id="T14:U1527"><span class="var type1" id="S59T14U2135">ctr</span> = <span class="mxinfo " id="T14:U1529">complex(<span class="mxinfo " id="T1:U1530">sqrt(<span class="mxinfo " id="T1:U1531"><span class="mxinfo " id="T1:U1532">1</span>-<span class="mxinfo " id="T1:U1533">real(<span class="var type1" id="S58T14U2144">str2</span>)</span></span>)</span>,<span class="mxinfo " id="T1:U1535">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,328" id="srcline328">328</a></span><span class="line">		<span class="keyword">if</span> (<span class="mxinfo " id="T18:U1536"><span class="mxinfo " id="T1:U1537"><span class="var type1" id="S26T10U2151">mflag</span>(<span class="mxinfo " id="T16:U1539">2</span>)</span> == <span class="mxinfo " id="T1:U1540">6</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,329" id="srcline329">329</a></span><span class="line"><span class="comment">%             if f2 == 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,330" id="srcline330">330</a></span><span class="line"><span class="comment">%                 eoe = sqrt(Geta/eta(tff(l,2,1)));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,331" id="srcline331">331</a></span><span class="line"><span class="comment">%             else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,332" id="srcline332">332</a></span><span class="line">                <span class="mxinfo " id="T14:U1541"><span class="var type1" id="S108T14U2156">eoe</span> = <span class="mxinfo " id="T14:U1543">sqrt(<span class="mxinfo " id="T14:U1544"><span class="mxinfo " id="T14:U1545"><span class="var type1" id="S8T36U2161">eta</span>(<span class="var type1" id="S101T1U2162">f2</span>)</span>/<span class="mxinfo " id="T14:U1548"><span class="var type1" id="S8T36U2164">eta</span>(<span class="mxinfo " id="T1:U1550"><span class="var type1" id="S38T12U2166">tff</span>(<span class="var type1" id="S98T1U2167">l</span>,<span class="mxinfo " id="T16:U1553">2</span>,<span class="mxinfo " id="T16:U1554">1</span>)</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,333" id="srcline333">333</a></span><span class="line"><span class="comment">%             end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,334" id="srcline334">334</a></span><span class="line">		<span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,335" id="srcline335">335</a></span><span class="line">			<span class="mxinfo " id="T14:U1555"><span class="var type1" id="S108T14U2173">eoe</span> = <span class="mxinfo " id="T14:U1557">sqrt(<span class="mxinfo " id="T14:U1558">1/<span class="mxinfo " id="T14:U1559"><span class="var type1" id="S8T36U2179">eta</span>(<span class="mxinfo " id="T1:U1561"><span class="var type1" id="S38T12U2181">tff</span>(<span class="var type1" id="S98T1U2182">l</span>,<span class="mxinfo " id="T16:U1564">2</span>,<span class="mxinfo " id="T16:U1565">1</span>)</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,336" id="srcline336">336</a></span><span class="line">        <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,337" id="srcline337">337</a></span><span class="line">		<span class="keyword">if</span> (<span class="mxinfo " id="T18:U1566"><span class="mxinfo " id="T1:U1567">norm(<span class="var type1" id="S105T7U2191">et</span>)</span> &gt; <span class="mxinfo " id="T1:U1569">real(<span class="var type1" id="S108T14U2194">eoe</span>)</span></span>)    <span class="comment">% total internal reflection</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,338" id="srcline338">338</a></span><span class="line">			<span class="mxinfo " id="T1:U1571"><span class="var type1" id="S64T1U2197">msk</span> = <span class="mxinfo " id="T1:U1573">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,339" id="srcline339">339</a></span><span class="line">			<span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,340" id="srcline340">340</a></span><span class="line">        <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,341" id="srcline341">341</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1574"><span class="mxinfo " id="T1:U1575">norm(<span class="var type1" id="S105T7U2206">et</span>)</span> &lt;= <span class="mxinfo " id="T1:U1577">1.0e-6</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,342" id="srcline342">342</a></span><span class="line">			<span class="mxinfo " id="T7:U1578"><span class="var type1" id="S19T7U2210">etr</span> = <span class="mxinfo " id="T7:U1580">[<span class="mxinfo " id="T1:U1581">0</span>;<span class="mxinfo " id="T1:U1582">0</span>;<span class="mxinfo " id="T1:U1583">1</span>]</span></span>;    <span class="comment">% 'etr' is the unitary vector of perpendicular vector (incident field) --- 2nd interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,343" id="srcline343">343</a></span><span class="line">		<span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,344" id="srcline344">344</a></span><span class="line">			<span class="mxinfo " id="T7:U1584"><span class="var type1" id="S19T7U2221">etr</span> = <span class="mxinfo " id="T7:U1586"><span class="mxinfo " id="T1:U1587"><span class="mxinfo " id="T1:U1588">1</span>/<span class="mxinfo " id="T1:U1589">norm(<span class="var type1" id="S105T7U2227">et</span>)</span></span>*<span class="var type1" id="S105T7U2228">et</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,345" id="srcline345">345</a></span><span class="line">			<span class="mxinfo " id="T7:U1592"><span class="var type1" id="S20T7U2231">ehr</span> = <span class="mxinfo " id="T7:U1594">cross(<span class="var type1" id="S19T7U2234">etr</span>,<span class="var type1" id="S41T7U2235">st</span>)</span></span>;    <span class="comment">% 'ehr' is the unitary vector of parallel vector (incident field) --- 2nd interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,346" id="srcline346">346</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,347" id="srcline347">347</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1597"><span class="mxinfo " id="T1:U1598"><span class="var type1" id="S26T10U2241">mflag</span>(<span class="mxinfo " id="T16:U1600">2</span>)</span> == <span class="mxinfo " id="T1:U1601">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,348" id="srcline348">348</a></span><span class="line">			<span class="mxinfo " id="T7:U1602"><span class="var type1" id="S40T7U2246">si</span> = <span class="var type1" id="S68T7U2247">sdp</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,349" id="srcline349">349</a></span><span class="line">            <span class="mxinfo " id="T7:U1605"><span class="mxinfo " id="T7:U1606"><span class="var type1" id="S24T7U2251">vnfaces_re</span>(<span class="mxinfo " id="T15:U1608">:</span>,<span class="mxinfo " id="T16:U1609">1</span>)</span> = <span class="mxinfo " id="T19:U1610"><span class="var type1" id="S9T20U2255">vnfaces</span>(<span class="mxinfo " id="T1:U1612"><span class="var type1" id="S38T12U2257">tff</span>(<span class="var type1" id="S98T1U2258">l</span>,<span class="mxinfo " id="T16:U1615">2</span>,<span class="mxinfo " id="T16:U1616">1</span>)</span>,<span class="mxinfo " id="T1:U1617"><span class="var type1" id="S38T12U2262">tff</span>(<span class="var type1" id="S98T1U2263">l</span>,<span class="mxinfo " id="T16:U1620">2</span>,<span class="mxinfo " id="T16:U1621">2</span>)</span>,<span class="mxinfo " id="T15:U1622">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,350" id="srcline350">350</a></span><span class="line">			<span class="mxinfo " id="T7:U1623"><span class="var type1" id="S105T7U2269">et</span> = <span class="mxinfo " id="T7:U1625">cross(<span class="var type1" id="S40T7U2272">si</span>,<span class="var type1" id="S24T7U2273">vnfaces_re</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,351" id="srcline351">351</a></span><span class="line">			<span class="keyword">if</span> (<span class="mxinfo " id="T18:U1628"><span class="mxinfo " id="T1:U1629">norm(<span class="var type1" id="S105T7U2280">et</span>)</span> &lt;= <span class="mxinfo " id="T1:U1631">1.0e-6</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,352" id="srcline352">352</a></span><span class="line">				<span class="mxinfo " id="T7:U1632"><span class="var type1" id="S18T7U2284">eto</span> = <span class="mxinfo " id="T7:U1634">[<span class="mxinfo " id="T1:U1635">0</span>;<span class="mxinfo " id="T1:U1636">0</span>;<span class="mxinfo " id="T1:U1637">1</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,353" id="srcline353">353</a></span><span class="line">		    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,354" id="srcline354">354</a></span><span class="line">				<span class="mxinfo " id="T7:U1638"><span class="var type1" id="S18T7U2295">eto</span> = <span class="mxinfo " id="T7:U1640"><span class="mxinfo " id="T1:U1641"><span class="mxinfo " id="T1:U1642">1</span>/<span class="mxinfo " id="T1:U1643">norm(<span class="var type1" id="S105T7U2301">et</span>)</span></span>*<span class="var type1" id="S105T7U2302">et</span></span></span>;    <span class="comment">% 'eto' is the unitary vector of perpendicular vector (transmission field) --- 2nd interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,355" id="srcline355">355</a></span><span class="line">            <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,356" id="srcline356">356</a></span><span class="line">			<span class="mxinfo " id="T7:U1646"><span class="var type1" id="S17T7U2305">eho</span> = <span class="mxinfo " id="T7:U1648">cross(<span class="var type1" id="S18T7U2308">eto</span>,<span class="var type1" id="S40T7U2309">si</span>)</span></span>;    <span class="comment">% 'eho' is the unitary vector of parallel vector (transmission field) --- 2nd interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,357" id="srcline357">357</a></span><span class="line">        <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,358" id="srcline358">358</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1651"><span class="mxinfo " id="T1:U1652"><span class="var type1" id="S26T10U2315">mflag</span>(<span class="mxinfo " id="T16:U1654">2</span>)</span> == <span class="mxinfo " id="T1:U1655">6</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,359" id="srcline359">359</a></span><span class="line">			<span class="mxinfo " id="T14:U1656"><span class="var type1" id="S109T14U2320">stt</span> = <span class="mxinfo " id="T14:U1658"><span class="mxinfo " id="T1:U1659">norm(<span class="var type1" id="S105T7U2324">et</span>)</span>*<span class="var type1" id="S108T14U2325">eoe</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,360" id="srcline360">360</a></span><span class="line">		    <span class="mxinfo " id="T1:U1662"><span class="var type1" id="S110T1U2328">rstt</span> = <span class="mxinfo " id="T1:U1664">real(<span class="var type1" id="S109T14U2331">stt</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,361" id="srcline361">361</a></span><span class="line">			</span></span>
<span class="srcline"><span class="lineno"><a href="1,362" id="srcline362">362</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1666"><span class="mxinfo " id="T1:U1667">real(<span class="var type1" id="S109T14U2338">stt</span>)</span> &gt; <span class="mxinfo " id="T1:U1669">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,363" id="srcline363">363</a></span><span class="line">				<span class="mxinfo " id="T1:U1670"><span class="var type1" id="S64T1U2342">msk</span> = <span class="mxinfo " id="T1:U1672">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,364" id="srcline364">364</a></span><span class="line">				<span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,365" id="srcline365">365</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,366" id="srcline366">366</a></span><span class="line">            <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,367" id="srcline367">367</a></span><span class="line">			<span class="mxinfo " id="T1:U1673"><span class="var type1" id="S111T1U2347">ctt</span> = <span class="mxinfo " id="T1:U1675">sqrt(<span class="mxinfo " id="T1:U1676"><span class="mxinfo " id="T1:U1677">1</span>-<span class="mxinfo " id="T1:U1678"><span class="var type1" id="S110T1U2353">rstt</span>^2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,368" id="srcline368">368</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1680"><span class="mxinfo " id="T1:U1681">norm(<span class="var type1" id="S105T7U2361">et</span>)</span> &lt;= <span class="mxinfo " id="T1:U1683">1.0e-6</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,369" id="srcline369">369</a></span><span class="line">				<span class="mxinfo " id="T7:U1684"><span class="var type1" id="S40T7U2365">si</span> = <span class="var type1" id="S41T7U2366">st</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,370" id="srcline370">370</a></span><span class="line">			    <span class="mxinfo " id="T7:U1687"><span class="var type1" id="S18T7U2369">eto</span> = <span class="var type1" id="S19T7U2370">etr</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,371" id="srcline371">371</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,372" id="srcline372">372</a></span><span class="line">                <span class="mxinfo " id="T1:U1690"><span class="var type1" id="S112T1U2374">ksi</span> = <span class="mxinfo " id="T1:U1692">real(<span class="var type1" id="S108T14U2377">eoe</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,373" id="srcline373">373</a></span><span class="line">				<span class="mxinfo " id="T1:U1694"><span class="var type1" id="S113T1U2380">kn</span> = <span class="mxinfo " id="T1:U1696"><span class="mxinfo " id="T1:U1697">sqrt(<span class="mxinfo " id="T1:U1698"><span class="mxinfo " id="T1:U1699">1</span>-<span class="mxinfo " id="T1:U1700">(<span class="mxinfo " id="T1:U1701"><span class="var type1" id="S112T1U2389">ksi</span>*<span class="var type1" id="S110T1U2390">rstt</span></span>)^2</span></span>)</span>+(<span class="mxinfo " id="T1:U1704"><span class="var type1" id="S112T1U2394">ksi</span>*<span class="var type1" id="S111T1U2395">ctt</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,374" id="srcline374">374</a></span><span class="line">                <span class="mxinfo " id="T7:U1707"><span class="mxinfo " id="T7:U1708"><span class="var type1" id="S24T7U2399">vnfaces_re</span>(<span class="mxinfo " id="T15:U1710">:</span>,<span class="mxinfo " id="T16:U1711">1</span>)</span> = <span class="mxinfo " id="T19:U1712"><span class="var type1" id="S9T20U2403">vnfaces</span>(<span class="mxinfo " id="T1:U1714"><span class="var type1" id="S38T12U2405">tff</span>(<span class="var type1" id="S98T1U2406">l</span>,<span class="mxinfo " id="T16:U1717">1</span>,<span class="mxinfo " id="T16:U1718">1</span>)</span>,<span class="mxinfo " id="T1:U1719"><span class="var type1" id="S38T12U2410">tff</span>(<span class="var type1" id="S98T1U2411">l</span>,<span class="mxinfo " id="T16:U1722">1</span>,<span class="mxinfo " id="T16:U1723">2</span>)</span>,<span class="mxinfo " id="T15:U1724">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,375" id="srcline375">375</a></span><span class="line">				<span class="mxinfo " id="T7:U1725"><span class="var type1" id="S41T7U2417">st</span> = <span class="mxinfo " id="T7:U1727">(<span class="mxinfo " id="T7:U1728"><span class="var type1" id="S112T1U2421">ksi</span>*<span class="var type1" id="S40T7U2422">si</span></span>)-(<span class="mxinfo " id="T7:U1731"><span class="var type1" id="S113T1U2425">kn</span>*<span class="var type1" id="S24T7U2426">vnfaces_re</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,376" id="srcline376">376</a></span><span class="line">				<span class="mxinfo " id="T7:U1734"><span class="var type1" id="S18T7U2429">eto</span> = <span class="var type1" id="S19T7U2430">etr</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,377" id="srcline377">377</a></span><span class="line">            <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,378" id="srcline378">378</a></span><span class="line">            <span class="mxinfo " id="T7:U1737"><span class="var type1" id="S40T7U2433">si</span> = <span class="mxinfo " id="T7:U1739"><span class="mxinfo " id="T1:U1740"><span class="mxinfo " id="T1:U1741">1</span>/<span class="mxinfo " id="T1:U1742">norm(<span class="var type1" id="S40T7U2439">si</span>)</span></span>*<span class="var type1" id="S40T7U2440">si</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,379" id="srcline379">379</a></span><span class="line">            <span class="mxinfo " id="T7:U1745"><span class="var type1" id="S17T7U2443">eho</span> = <span class="mxinfo " id="T7:U1747">cross(<span class="var type1" id="S18T7U2446">eto</span>,<span class="var type1" id="S40T7U2447">si</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,380" id="srcline380">380</a></span><span class="line">        <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,381" id="srcline381">381</a></span><span class="line">    <span class="keyword">else</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,382" id="srcline382">382</a></span><span class="line">        <span class="mxinfo " id="T7:U1750"><span class="mxinfo " id="T7:U1751"><span class="var type1" id="S25T7U2452">tp</span>(<span class="mxinfo " id="T15:U1753">:</span>,<span class="mxinfo " id="T16:U1754">1</span>)</span> = <span class="mxinfo " id="T19:U1755">-<span class="mxinfo " id="T19:U1756"><span class="var type1" id="S9T20U2457">vnfaces</span>(<span class="mxinfo " id="T1:U1758"><span class="var type1" id="S38T12U2459">tff</span>(<span class="var type1" id="S98T1U2460">l</span>,<span class="mxinfo " id="T16:U1761">2</span>,<span class="mxinfo " id="T16:U1762">1</span>)</span>,<span class="mxinfo " id="T1:U1763"><span class="var type1" id="S38T12U2464">tff</span>(<span class="var type1" id="S98T1U2465">l</span>,<span class="mxinfo " id="T16:U1766">2</span>,<span class="mxinfo " id="T16:U1767">2</span>)</span>,<span class="mxinfo " id="T15:U1768">:</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,383" id="srcline383">383</a></span><span class="line">		<span class="mxinfo " id="T7:U1769"><span class="var type1" id="S105T7U2471">et</span> = <span class="mxinfo " id="T7:U1771">cross(<span class="var type1" id="S41T7U2474">st</span>,<span class="var type1" id="S25T7U2475">tp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,384" id="srcline384">384</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,385" id="srcline385">385</a></span><span class="line">		<span class="keyword">if</span> (<span class="mxinfo " id="T18:U1774"><span class="mxinfo " id="T1:U1775">norm(<span class="var type1" id="S105T7U2482">et</span>)</span> &lt;= <span class="mxinfo " id="T1:U1777">1.0e-6</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,386" id="srcline386">386</a></span><span class="line">			<span class="mxinfo " id="T7:U1778"><span class="var type1" id="S19T7U2486">etr</span> = <span class="mxinfo " id="T7:U1780">[<span class="mxinfo " id="T1:U1781">0</span>;<span class="mxinfo " id="T1:U1782">0</span>;<span class="mxinfo " id="T1:U1783">1</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,387" id="srcline387">387</a></span><span class="line">		<span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,388" id="srcline388">388</a></span><span class="line">			<span class="mxinfo " id="T7:U1784"><span class="var type1" id="S19T7U2497">etr</span> = <span class="mxinfo " id="T7:U1786"><span class="mxinfo " id="T1:U1787"><span class="mxinfo " id="T1:U1788">1</span>/<span class="mxinfo " id="T1:U1789">norm(<span class="var type1" id="S105T7U2503">et</span>)</span></span>*<span class="var type1" id="S105T7U2504">et</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,389" id="srcline389">389</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,390" id="srcline390">390</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,391" id="srcline391">391</a></span><span class="line">		<span class="mxinfo " id="T7:U1792"><span class="var type1" id="S20T7U2507">ehr</span> = <span class="mxinfo " id="T7:U1794">cross(<span class="var type1" id="S19T7U2510">etr</span>,<span class="var type1" id="S40T7U2511">si</span>)</span></span>;            </span></span>
<span class="srcline"><span class="lineno"><a href="1,392" id="srcline392">392</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,393" id="srcline393">393</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1797"><span class="mxinfo " id="T1:U1798"><span class="var type1" id="S26T10U2517">mflag</span>(<span class="mxinfo " id="T16:U1800">2</span>)</span> == <span class="mxinfo " id="T1:U1801">5</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,394" id="srcline394">394</a></span><span class="line">	    <span class="mxinfo " id="T7:U1802"><span class="var type1" id="S40T7U2522">si</span> = <span class="var type1" id="S41T7U2523">st</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,395" id="srcline395">395</a></span><span class="line">    <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,396" id="srcline396">396</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1805"><span class="var type1" id="S64T1U2528">msk</span> ~= <span class="mxinfo " id="T1:U1807">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,397" id="srcline397">397</a></span><span class="line">		<span class="mxinfo " id="T14:U1808"><span class="var type1" id="S114T14U2532">sqreta</span> = <span class="mxinfo " id="T14:U1810">sqrt(<span class="mxinfo " id="T14:U1811"><span class="var type1" id="S8T36U2536">eta</span>(<span class="mxinfo " id="T1:U1813"><span class="var type1" id="S38T12U2538">tff</span>(<span class="var type1" id="S98T1U2539">l</span>,<span class="mxinfo " id="T16:U1816">1</span>,<span class="mxinfo " id="T16:U1817">1</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,398" id="srcline398">398</a></span><span class="line">		<span class="mxinfo " id="T14:U1818"><span class="var type1" id="S115T14U2544">sqrem1</span> = <span class="mxinfo " id="T14:U1820"><span class="var type1" id="S71T14U2546">uno</span> - <span class="var type1" id="S114T14U2547">sqreta</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,399" id="srcline399">399</a></span><span class="line">		<span class="mxinfo " id="T14:U1823"><span class="var type1" id="S116T14U2550">kdp</span> = <span class="mxinfo " id="T14:U1825">complex(<span class="mxinfo " id="T1:U1826">0</span>,<span class="mxinfo " id="T1:U1827"><span class="var type1" id="S10T1U2555">K</span>*<span class="var type1" id="S103T1U2556">dp</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,400" id="srcline400">400</a></span><span class="line">        <span class="mxinfo " id="T1:U1830"><span class="mxinfo " id="T1:U1831"><span class="var type1" id="S49T5U2560">mnbpen</span>(<span class="var type1" id="S98T1U2561">l</span>,<span class="mxinfo " id="T16:U1834">:</span>)</span> = <span class="mxinfo " id="T1:U1835"><span class="var type1" id="S38T12U2564">tff</span>(<span class="var type1" id="S98T1U2565">l</span>,<span class="mxinfo " id="T1:U1838">1</span>,<span class="mxinfo " id="T1:U1839">1</span>)</span></span>;    <span class="comment">% block number</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,401" id="srcline401">401</a></span><span class="line">	    <span class="mxinfo " id="T31:U1840"><span class="mxinfo " id="T31:U1841"><span class="var type1" id="S30T6U2571">mpflag</span>(<span class="var type1" id="S98T1U2572">l</span>,<span class="mxinfo " id="T30:U1844">:</span>)</span> = <span class="mxinfo " id="T10:U1845"><span class="var type1" id="S26T10U2575">mflag</span>(<span class="mxinfo " id="T31:U1847"><span class="mxinfo " id="T1:U1848">1</span>:<span class="mxinfo " id="T1:U1849">2</span></span>)</span></span>;    <span class="comment">% vector mflag </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,402" id="srcline402">402</a></span><span class="line">		<span class="mxinfo " id="T14:U1850"><span class="mxinfo " id="T14:U1851"><span class="var type1" id="S31T4U2582">mploss</span>(<span class="var type1" id="S98T1U2583">l</span>,<span class="mxinfo " id="T16:U1854">:</span>)</span> = <span class="mxinfo " id="T14:U1855">exp(<span class="mxinfo " id="T14:U1856"><span class="var type1" id="S116T14U2588">kdp</span>*<span class="var type1" id="S115T14U2589">sqrem1</span></span>)</span></span>;    <span class="comment">% penetration loss</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,403" id="srcline403">403</a></span><span class="line">		<span class="mxinfo " id="T1:U1859"><span class="mxinfo " id="T1:U1860"><span class="var type1" id="S33T5U2593">mpd</span>(<span class="var type1" id="S98T1U2594">l</span>,<span class="mxinfo " id="T16:U1863">:</span>)</span> = <span class="var type1" id="S103T1U2596">dp</span></span>;    <span class="comment">% lenght of the penetration path</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,404" id="srcline404">404</a></span><span class="line">        <span class="mxinfo " id="T1:U1865"><span class="mxinfo " id="T1:U1866"><span class="var type1" id="S34T5U2600">mepd</span>(<span class="var type1" id="S98T1U2601">l</span>,<span class="mxinfo " id="T16:U1869">:</span>)</span> = <span class="mxinfo " id="T1:U1870"><span class="var type1" id="S103T1U2604">dp</span>*<span class="mxinfo " id="T1:U1872">sqrt(<span class="mxinfo " id="T1:U1873">real(<span class="mxinfo " id="T14:U1874"><span class="var type1" id="S8T36U2610">eta</span>(<span class="mxinfo " id="T1:U1876"><span class="var type1" id="S38T12U2612">tff</span>(<span class="var type1" id="S98T1U2613">l</span>,<span class="mxinfo " id="T16:U1879">1</span>,<span class="mxinfo " id="T16:U1880">1</span>)</span>)</span>)</span>)</span></span></span>;	  <span class="comment">% effective lenght of the penetration path    </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,405" id="srcline405">405</a></span><span class="line">        <span class="mxinfo " id="T21:U1881"><span class="mxinfo " id="T21:U1882"><span class="var type1" id="S35T3U2619">msti</span>(<span class="var type1" id="S98T1U2620">l</span>,<span class="mxinfo " id="T15:U1885">:</span>)</span> = <span class="var type1" id="S14T7U2622">eti</span></span>;    <span class="comment">% perpendicular and parallel polarization vectors at each interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,406" id="srcline406">406</a></span><span class="line">        <span class="mxinfo " id="T21:U1887"><span class="mxinfo " id="T21:U1888"><span class="var type1" id="S36T3U2626">mstt</span>(<span class="var type1" id="S98T1U2627">l</span>,<span class="mxinfo " id="T15:U1891">:</span>)</span> = <span class="var type1" id="S15T7U2629">ett</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,407" id="srcline407">407</a></span><span class="line">      	<span class="mxinfo " id="T21:U1893"><span class="mxinfo " id="T21:U1894"><span class="var type1" id="S43T3U2633">mshi</span>(<span class="var type1" id="S98T1U2634">l</span>,<span class="mxinfo " id="T15:U1897">:</span>)</span> = <span class="var type1" id="S12T7U2636">ehi</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,408" id="srcline408">408</a></span><span class="line">   		<span class="mxinfo " id="T21:U1899"><span class="mxinfo " id="T21:U1900"><span class="var type1" id="S44T3U2640">msht</span>(<span class="var type1" id="S98T1U2641">l</span>,<span class="mxinfo " id="T15:U1903">:</span>)</span> = <span class="var type1" id="S16T7U2643">eht</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,409" id="srcline409">409</a></span><span class="line">        <span class="mxinfo " id="T21:U1905"><span class="mxinfo " id="T21:U1906"><span class="var type1" id="S45T3U2647">mstr</span>(<span class="var type1" id="S98T1U2648">l</span>,<span class="mxinfo " id="T15:U1909">:</span>)</span> = <span class="var type1" id="S19T7U2650">etr</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,410" id="srcline410">410</a></span><span class="line">        <span class="mxinfo " id="T21:U1911"><span class="mxinfo " id="T21:U1912"><span class="var type1" id="S46T3U2654">msto</span>(<span class="var type1" id="S98T1U2655">l</span>,<span class="mxinfo " id="T15:U1915">:</span>)</span> = <span class="var type1" id="S18T7U2657">eto</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,411" id="srcline411">411</a></span><span class="line">      	<span class="mxinfo " id="T21:U1917"><span class="mxinfo " id="T21:U1918"><span class="var type1" id="S47T3U2661">mshr</span>(<span class="var type1" id="S98T1U2662">l</span>,<span class="mxinfo " id="T15:U1921">:</span>)</span> = <span class="var type1" id="S20T7U2664">ehr</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,412" id="srcline412">412</a></span><span class="line">  		<span class="mxinfo " id="T21:U1923"><span class="mxinfo " id="T21:U1924"><span class="var type1" id="S48T3U2668">msho</span>(<span class="var type1" id="S98T1U2669">l</span>,<span class="mxinfo " id="T15:U1927">:</span>)</span> = <span class="var type1" id="S17T7U2671">eho</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,413" id="srcline413">413</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,414" id="srcline414">414</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1929"><span class="mxinfo " id="T1:U1930"><span class="var type1" id="S26T10U2677">mflag</span>(<span class="mxinfo " id="T16:U1932">1</span>)</span> == <span class="mxinfo " id="T1:U1933">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,415" id="srcline415">415</a></span><span class="line">            <span class="mxinfo " id="T14:U1934"><span class="mxinfo " id="T14:U1935"><span class="var type1" id="S52T4U2683">mTti</span>(<span class="var type1" id="S98T1U2684">l</span>,<span class="mxinfo " id="T16:U1938">:</span>)</span> = <span class="mxinfo " id="T1:U1939">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,416" id="srcline416">416</a></span><span class="line">            <span class="mxinfo " id="T14:U1940"><span class="mxinfo " id="T14:U1941"><span class="var type1" id="S53T4U2690">mThi</span>(<span class="var type1" id="S98T1U2691">l</span>,<span class="mxinfo " id="T16:U1944">:</span>)</span> = <span class="mxinfo " id="T1:U1945">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,417" id="srcline417">417</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,418" id="srcline418">418</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1946"><span class="mxinfo " id="T1:U1947"><span class="var type1" id="S26T10U2699">mflag</span>(<span class="mxinfo " id="T16:U1949">2</span>)</span> == <span class="mxinfo " id="T1:U1950">4</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,419" id="srcline419">419</a></span><span class="line">            <span class="mxinfo " id="T14:U1951"><span class="mxinfo " id="T14:U1952"><span class="var type1" id="S54T4U2705">mTtt</span>(<span class="var type1" id="S98T1U2706">l</span>,<span class="mxinfo " id="T16:U1955">:</span>)</span> = <span class="mxinfo " id="T1:U1956">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,420" id="srcline420">420</a></span><span class="line">            <span class="mxinfo " id="T14:U1957"><span class="mxinfo " id="T14:U1958"><span class="var type1" id="S55T4U2712">mTht</span>(<span class="var type1" id="S98T1U2713">l</span>,<span class="mxinfo " id="T16:U1961">:</span>)</span> = <span class="mxinfo " id="T1:U1962">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,421" id="srcline421">421</a></span><span class="line">        <span class="keyword">end</span>        </span></span>
<span class="srcline"><span class="lineno"><a href="1,422" id="srcline422">422</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1963"><span class="mxinfo " id="T1:U1964"><span class="var type1" id="S26T10U2722">mflag</span>(<span class="mxinfo " id="T16:U1966">1</span>)</span> == <span class="mxinfo " id="T1:U1967">0</span></span>) || (<span class="mxinfo " id="T18:U1968"><span class="mxinfo " id="T1:U1969"><span class="var type1" id="S26T10U2728">mflag</span>(<span class="mxinfo " id="T16:U1971">1</span>)</span> == <span class="mxinfo " id="T1:U1972">3</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,423" id="srcline423">423</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T18:U1973"><span class="mxinfo " id="T1:U1974"><span class="var type1" id="S26T10U2736">mflag</span>(<span class="mxinfo " id="T16:U1976">1</span>)</span> == <span class="mxinfo " id="T1:U1977">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,424" id="srcline424">424</a></span><span class="line">                <span class="mxinfo " id="T14:U1978"><span class="var type1" id="S118T14U2741">sqes</span> = <span class="mxinfo " id="T14:U1980">sqrt(<span class="mxinfo " id="T14:U1981"><span class="mxinfo " id="T14:U1982"><span class="var type1" id="S8T36U2746">eta</span>(<span class="mxinfo " id="T1:U1984"><span class="var type1" id="S38T12U2748">tff</span>(<span class="var type1" id="S98T1U2749">l</span>,<span class="mxinfo " id="T16:U1987">1</span>,<span class="mxinfo " id="T16:U1988">1</span>)</span>)</span>-<span class="var type1" id="S56T14U2752">sti2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,425" id="srcline425">425</a></span><span class="line">                <span class="mxinfo " id="T14:U1990"><span class="var type1" id="S119T14U2755">inveta</span> = <span class="mxinfo " id="T14:U1992">1/<span class="mxinfo " id="T14:U1993"><span class="var type1" id="S8T36U2759">eta</span>(<span class="mxinfo " id="T1:U1995"><span class="var type1" id="S38T12U2761">tff</span>(<span class="var type1" id="S98T1U2762">l</span>,<span class="mxinfo " id="T16:U1998">1</span>,<span class="mxinfo " id="T16:U1999">1</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,426" id="srcline426">426</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,427" id="srcline427">427</a></span><span class="line"><span class="comment">%                 if (f1 == 0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,428" id="srcline428">428</a></span><span class="line"><span class="comment">%                     sqes = sqrt(eta(tff(l,1,1))/Geta-sti2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,429" id="srcline429">429</a></span><span class="line"><span class="comment">%                     inveta = Geta/eta(tff(l,1,1));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,430" id="srcline430">430</a></span><span class="line"><span class="comment">%                 else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,431" id="srcline431">431</a></span><span class="line">                    <span class="mxinfo " id="T14:U2000"><span class="var type1" id="S118T14U2768">sqes</span> = <span class="mxinfo " id="T14:U2002">sqrt(<span class="mxinfo " id="T14:U2003"><span class="mxinfo " id="T14:U2004"><span class="mxinfo " id="T14:U2005"><span class="var type1" id="S8T36U2774">eta</span>(<span class="mxinfo " id="T1:U2007"><span class="var type1" id="S38T12U2776">tff</span>(<span class="var type1" id="S98T1U2777">l</span>,<span class="mxinfo " id="T16:U2010">1</span>,<span class="mxinfo " id="T16:U2011">1</span>)</span>)</span>/<span class="mxinfo " id="T14:U2012"><span class="var type1" id="S8T36U2781">eta</span>(<span class="var type1" id="S99T1U2782">f1</span>)</span></span>-<span class="var type1" id="S56T14U2783">sti2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,432" id="srcline432">432</a></span><span class="line">                    <span class="mxinfo " id="T14:U2016"><span class="var type1" id="S119T14U2786">inveta</span> = <span class="mxinfo " id="T14:U2018"><span class="mxinfo " id="T14:U2019"><span class="var type1" id="S8T36U2789">eta</span>(<span class="var type1" id="S99T1U2790">f1</span>)</span>/<span class="mxinfo " id="T14:U2022"><span class="var type1" id="S8T36U2792">eta</span>(<span class="mxinfo " id="T1:U2024"><span class="var type1" id="S38T12U2794">tff</span>(<span class="var type1" id="S98T1U2795">l</span>,<span class="mxinfo " id="T16:U2027">1</span>,<span class="mxinfo " id="T16:U2028">1</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,433" id="srcline433">433</a></span><span class="line"><span class="comment">%                 end </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,434" id="srcline434">434</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,435" id="srcline435">435</a></span><span class="line">            <span class="mxinfo " id="T14:U2029"><span class="mxinfo " id="T14:U2030"><span class="var type1" id="S52T4U2801">mTti</span>(<span class="var type1" id="S98T1U2802">l</span>,<span class="mxinfo " id="T16:U2033">:</span>)</span> = <span class="mxinfo " id="T14:U2034">(<span class="mxinfo " id="T14:U2035"><span class="mxinfo " id="T1:U2036">2</span>*<span class="var type1" id="S57T14U2808">cti</span></span>)/(<span class="mxinfo " id="T14:U2038"><span class="var type1" id="S57T14U2811">cti</span>+<span class="var type1" id="S118T14U2812">sqes</span></span>)</span></span>;    <span class="comment">% parallel and perpendicular transmission coefficient at 1st interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,436" id="srcline436">436</a></span><span class="line">            <span class="mxinfo " id="T14:U2041"><span class="mxinfo " id="T14:U2042"><span class="var type1" id="S53T4U2816">mThi</span>(<span class="var type1" id="S98T1U2817">l</span>,<span class="mxinfo " id="T16:U2045">:</span>)</span> = <span class="mxinfo " id="T14:U2046">(<span class="mxinfo " id="T14:U2047"><span class="mxinfo " id="T14:U2048"><span class="mxinfo " id="T1:U2049">2</span>*<span class="mxinfo " id="T14:U2050">sqrt(<span class="var type1" id="S119T14U2826">inveta</span>)</span></span>*<span class="var type1" id="S57T14U2827">cti</span></span>)/(<span class="mxinfo " id="T14:U2053"><span class="var type1" id="S57T14U2830">cti</span>+<span class="mxinfo " id="T14:U2055"><span class="mxinfo " id="T14:U2056">sqrt(<span class="var type1" id="S119T14U2834">inveta</span>)</span>*<span class="mxinfo " id="T14:U2058">sqrt(<span class="mxinfo " id="T14:U2059"><span class="var type1" id="S71T14U2838">uno</span>-<span class="mxinfo " id="T14:U2061"><span class="var type1" id="S119T14U2840">inveta</span>*<span class="var type1" id="S56T14U2841">sti2</span></span></span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,437" id="srcline437">437</a></span><span class="line">        <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,438" id="srcline438">438</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T18:U2064"><span class="mxinfo " id="T1:U2065"><span class="var type1" id="S26T10U2848">mflag</span>(<span class="mxinfo " id="T16:U2067">2</span>)</span> == <span class="mxinfo " id="T1:U2068">0</span></span>) || (<span class="mxinfo " id="T18:U2069"><span class="mxinfo " id="T1:U2070"><span class="var type1" id="S26T10U2854">mflag</span>(<span class="mxinfo " id="T16:U2072">2</span>)</span> == <span class="mxinfo " id="T1:U2073">6</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,439" id="srcline439">439</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T18:U2074"><span class="mxinfo " id="T1:U2075"><span class="var type1" id="S26T10U2862">mflag</span>(<span class="mxinfo " id="T16:U2077">2</span>)</span> == <span class="mxinfo " id="T1:U2078">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,440" id="srcline440">440</a></span><span class="line">                <span class="mxinfo " id="T14:U2079"><span class="var type1" id="S118T14U2867">sqes</span> = <span class="mxinfo " id="T14:U2081">sqrt(<span class="mxinfo " id="T14:U2082"><span class="mxinfo " id="T14:U2083">1/<span class="mxinfo " id="T14:U2084"><span class="var type1" id="S8T36U2874">eta</span>(<span class="mxinfo " id="T1:U2086"><span class="var type1" id="S38T12U2876">tff</span>(<span class="var type1" id="S98T1U2877">l</span>,<span class="mxinfo " id="T16:U2089">1</span>,<span class="mxinfo " id="T16:U2090">1</span>)</span>)</span></span>-<span class="var type1" id="S58T14U2880">str2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,441" id="srcline441">441</a></span><span class="line">                <span class="mxinfo " id="T14:U2092"><span class="var type1" id="S119T14U2883">inveta</span> = <span class="mxinfo " id="T14:U2094"><span class="var type1" id="S8T36U2885">eta</span>(<span class="mxinfo " id="T1:U2096"><span class="var type1" id="S38T12U2887">tff</span>(<span class="var type1" id="S98T1U2888">l</span>,<span class="mxinfo " id="T16:U2099">1</span>,<span class="mxinfo " id="T16:U2100">1</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,442" id="srcline442">442</a></span><span class="line">            <span class="keyword">else</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,443" id="srcline443">443</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,444" id="srcline444">444</a></span><span class="line"><span class="comment">%                 if (f2 == 0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,445" id="srcline445">445</a></span><span class="line"><span class="comment">%                     sqes = sqrt(Geta/eta(tff(l,2,1))-str2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,446" id="srcline446">446</a></span><span class="line"><span class="comment">%                     inveta = eta(tff(l,2,1))/Geta;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,447" id="srcline447">447</a></span><span class="line"><span class="comment">%                 else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,448" id="srcline448">448</a></span><span class="line">                    <span class="mxinfo " id="T14:U2101"><span class="var type1" id="S118T14U2894">sqes</span> = <span class="mxinfo " id="T14:U2103">sqrt(<span class="mxinfo " id="T14:U2104"><span class="mxinfo " id="T14:U2105"><span class="mxinfo " id="T14:U2106"><span class="var type1" id="S8T36U2900">eta</span>(<span class="var type1" id="S101T1U2901">f2</span>)</span>/<span class="mxinfo " id="T14:U2109"><span class="var type1" id="S8T36U2903">eta</span>(<span class="mxinfo " id="T1:U2111"><span class="var type1" id="S38T12U2905">tff</span>(<span class="var type1" id="S98T1U2906">l</span>,<span class="mxinfo " id="T16:U2114">2</span>,<span class="mxinfo " id="T16:U2115">1</span>)</span>)</span></span>-<span class="var type1" id="S58T14U2909">str2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,449" id="srcline449">449</a></span><span class="line">                    <span class="mxinfo " id="T14:U2117"><span class="var type1" id="S119T14U2912">inveta</span> = <span class="mxinfo " id="T14:U2119"><span class="mxinfo " id="T14:U2120"><span class="var type1" id="S8T36U2915">eta</span>(<span class="mxinfo " id="T1:U2122"><span class="var type1" id="S38T12U2917">tff</span>(<span class="var type1" id="S98T1U2918">l</span>,<span class="mxinfo " id="T16:U2125">2</span>,<span class="mxinfo " id="T16:U2126">1</span>)</span>)</span>/<span class="mxinfo " id="T14:U2127"><span class="var type1" id="S8T36U2922">eta</span>(<span class="var type1" id="S101T1U2923">f2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,450" id="srcline450">450</a></span><span class="line"><span class="comment">%                 end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,451" id="srcline451">451</a></span><span class="line">            <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,452" id="srcline452">452</a></span><span class="line">            <span class="mxinfo " id="T14:U2130"><span class="mxinfo " id="T14:U2131"><span class="var type1" id="S54T4U2927">mTtt</span>(<span class="var type1" id="S98T1U2928">l</span>,<span class="mxinfo " id="T16:U2134">:</span>)</span> = <span class="mxinfo " id="T14:U2135">(<span class="mxinfo " id="T14:U2136"><span class="mxinfo " id="T1:U2137">2</span>*<span class="var type1" id="S59T14U2934">ctr</span></span>)/(<span class="mxinfo " id="T14:U2139"><span class="var type1" id="S59T14U2937">ctr</span>+<span class="var type1" id="S118T14U2938">sqes</span></span>)</span></span>;    <span class="comment">% parallel and perpendicular transmission coefficient at 2nd interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,453" id="srcline453">453</a></span><span class="line">            <span class="mxinfo " id="T14:U2142"><span class="mxinfo " id="T14:U2143"><span class="var type1" id="S55T4U2942">mTht</span>(<span class="var type1" id="S98T1U2943">l</span>,<span class="mxinfo " id="T16:U2146">:</span>)</span> = <span class="mxinfo " id="T14:U2147">(<span class="mxinfo " id="T14:U2148"><span class="mxinfo " id="T14:U2149"><span class="mxinfo " id="T1:U2150">2</span>*<span class="mxinfo " id="T14:U2151">sqrt(<span class="var type1" id="S119T14U2952">inveta</span>)</span></span>*<span class="var type1" id="S59T14U2953">ctr</span></span>)/(<span class="mxinfo " id="T14:U2154"><span class="var type1" id="S59T14U2956">ctr</span>+<span class="mxinfo " id="T14:U2156"><span class="mxinfo " id="T14:U2157">sqrt(<span class="var type1" id="S119T14U2960">inveta</span>)</span>*<span class="mxinfo " id="T14:U2159">sqrt(<span class="mxinfo " id="T14:U2160"><span class="var type1" id="S71T14U2964">uno</span>-<span class="mxinfo " id="T14:U2162"><span class="var type1" id="S119T14U2966">inveta</span>*<span class="var type1" id="S58T14U2967">str2</span></span></span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,454" id="srcline454">454</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,455" id="srcline455">455</a></span><span class="line">        <span class="mxinfo " id="T1:U2165"><span class="var type1" id="S64T1U2970">msk</span> = <span class="mxinfo " id="T1:U2167">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,456" id="srcline456">456</a></span><span class="line">    <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,457" id="srcline457">457</a></span><span class="line">    <span class="mxinfo " id="T1:U2168"><span class="var type1" id="S98T1U2974">l</span> = <span class="mxinfo " id="T1:U2170"><span class="var type1" id="S98T1U2976">l</span>+<span class="mxinfo " id="T1:U2172">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,458" id="srcline458">458</a></span><span class="line"><span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,459" id="srcline459">459</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,460" id="srcline460">460</a></span><span class="line"><span class="mxinfo " id="T1:U2173"><span class="var type1" id="S2T1U2980">mmask</span> = <span class="var type1" id="S64T1U2981">msk</span></span>;    <span class="comment">% 1 means masking, 2 means penetration and 0 means nothing</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,461" id="srcline461">461</a></span><span class="line"><span class="mxinfo " id="T1:U2176"><span class="var type1" id="S120T1U2984">mnpb</span> = <span class="var type1" id="S69T1U2985">cnt</span></span>;    <span class="comment">% number of penetration per path</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,462" id="srcline462">462</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,463" id="srcline463">463</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo " id="T18:U2179"><span class="var type1" id="S2T1U2990">mmask</span> == <span class="mxinfo " id="T1:U2181">2</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,464" id="srcline464">464</a></span><span class="line">   <span class="mxinfo " id="T2:U2182"><span class="var type1" id="S3T2U2994">m</span> = struct(<span class="string">'shi'</span>,<span class="var type1" id="S43T3U2998">mshi</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,465" id="srcline465">465</a></span><span class="line">              <span class="string">'sti'</span>,<span class="var type1" id="S35T3U3000">msti</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,466" id="srcline466">466</a></span><span class="line">              <span class="string">'stt'</span>,<span class="var type1" id="S36T3U3002">mstt</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,467" id="srcline467">467</a></span><span class="line">              <span class="string">'sht'</span>,<span class="var type1" id="S44T3U3004">msht</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,468" id="srcline468">468</a></span><span class="line">              <span class="string">'sho'</span>,<span class="var type1" id="S48T3U3006">msho</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,469" id="srcline469">469</a></span><span class="line">              <span class="string">'sto'</span>,<span class="var type1" id="S46T3U3008">msto</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,470" id="srcline470">470</a></span><span class="line">              <span class="string">'str'</span>,<span class="var type1" id="S45T3U3010">mstr</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,471" id="srcline471">471</a></span><span class="line">              <span class="string">'shr'</span>,<span class="var type1" id="S47T3U3012">mshr</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,472" id="srcline472">472</a></span><span class="line">              <span class="string">'Tti'</span>,<span class="var type1" id="S52T4U3014">mTti</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,473" id="srcline473">473</a></span><span class="line">              <span class="string">'Thi'</span>,<span class="var type1" id="S53T4U3016">mThi</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,474" id="srcline474">474</a></span><span class="line">              <span class="string">'Ttt'</span>,<span class="var type1" id="S54T4U3018">mTtt</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,475" id="srcline475">475</a></span><span class="line">              <span class="string">'Tht'</span>,<span class="var type1" id="S55T4U3020">mTht</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,476" id="srcline476">476</a></span><span class="line">              <span class="string">'ploss'</span>,<span class="var type1" id="S31T4U3022">mploss</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,477" id="srcline477">477</a></span><span class="line">              <span class="string">'pd'</span>,<span class="var type1" id="S33T5U3024">mpd</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,478" id="srcline478">478</a></span><span class="line">              <span class="string">'epd'</span>,<span class="var type1" id="S34T5U3026">mepd</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,479" id="srcline479">479</a></span><span class="line">              <span class="string">'nbpen'</span>,<span class="var type1" id="S49T5U3028">mnbpen</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,480" id="srcline480">480</a></span><span class="line">              <span class="string">'pflag'</span>,<span class="var type1" id="S30T6U3030">mpflag</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,481" id="srcline481">481</a></span><span class="line">              <span class="string">'mask'</span>,<span class="var type1" id="S2T1U3032">mmask</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,482" id="srcline482">482</a></span><span class="line">              <span class="string">'npb'</span>,<span class="var type1" id="S120T1U3034">mnpb</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,483" id="srcline483">483</a></span><span class="line">         </span></span>
<span class="srcline"><span class="lineno"><a href="1,484" id="srcline484">484</a></span><span class="line"><span class="keyword">else</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,485" id="srcline485">485</a></span><span class="line">    <span class="mxinfo " id="T2:U2203"><span class="var type1" id="S3T2U3038">m</span> = struct(<span class="string">'shi'</span>,<span class="var type1" id="S43T3U3042">mshi</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,486" id="srcline486">486</a></span><span class="line">              <span class="string">'sti'</span>,<span class="var type1" id="S35T3U3044">msti</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,487" id="srcline487">487</a></span><span class="line">              <span class="string">'stt'</span>,<span class="var type1" id="S36T3U3046">mstt</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,488" id="srcline488">488</a></span><span class="line">              <span class="string">'sht'</span>,<span class="var type1" id="S44T3U3048">msht</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,489" id="srcline489">489</a></span><span class="line">              <span class="string">'sho'</span>,<span class="var type1" id="S48T3U3050">msho</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,490" id="srcline490">490</a></span><span class="line">              <span class="string">'sto'</span>,<span class="var type1" id="S46T3U3052">msto</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,491" id="srcline491">491</a></span><span class="line">              <span class="string">'str'</span>,<span class="var type1" id="S45T3U3054">mstr</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,492" id="srcline492">492</a></span><span class="line">              <span class="string">'shr'</span>,<span class="var type1" id="S47T3U3056">mshr</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,493" id="srcline493">493</a></span><span class="line">              <span class="string">'Tti'</span>,<span class="var type1" id="S52T4U3058">mTti</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,494" id="srcline494">494</a></span><span class="line">              <span class="string">'Thi'</span>,<span class="var type1" id="S53T4U3060">mThi</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,495" id="srcline495">495</a></span><span class="line">              <span class="string">'Ttt'</span>,<span class="var type1" id="S54T4U3062">mTtt</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,496" id="srcline496">496</a></span><span class="line">              <span class="string">'Tht'</span>,<span class="var type1" id="S55T4U3064">mTht</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,497" id="srcline497">497</a></span><span class="line">              <span class="string">'ploss'</span>,<span class="var type1" id="S31T4U3066">mploss</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,498" id="srcline498">498</a></span><span class="line">              <span class="string">'pd'</span>,<span class="var type1" id="S33T5U3068">mpd</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,499" id="srcline499">499</a></span><span class="line">              <span class="string">'epd'</span>,<span class="var type1" id="S34T5U3070">mepd</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,500" id="srcline500">500</a></span><span class="line">              <span class="string">'nbpen'</span>,<span class="var type1" id="S49T5U3072">mnbpen</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,501" id="srcline501">501</a></span><span class="line">              <span class="string">'pflag'</span>,<span class="var type1" id="S30T6U3074">mpflag</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,502" id="srcline502">502</a></span><span class="line">              <span class="string">'mask'</span>,<span class="var type1" id="S2T1U3076">mmask</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,503" id="srcline503">503</a></span><span class="line">               <span class="string">'npb'</span>,<span class="var type1" id="S120T1U3078">mnpb</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,504" id="srcline504">504</a></span><span class="line">          </span></span>
<span class="srcline"><span class="lineno"><a href="1,505" id="srcline505">505</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,506" id="srcline506">506</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,507" id="srcline507">507</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,508" id="srcline508">508</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,509" id="srcline509">509</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,510" id="srcline510">510</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,511" id="srcline511">511</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,512" id="srcline512">512</a></span><span class="line"> </span></span>
<span class="srcline"><span class="lineno"><a href="1,513" id="srcline513">513</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,514" id="srcline514">514</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,515" id="srcline515">515</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,516" id="srcline516">516</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,517" id="srcline517">517</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,518" id="srcline518">518</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,519" id="srcline519">519</a></span><span class="line"></span></span>
</pre>
</body>
</html>
