<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">m</span>] = Masking_Olivier_global (<span class="var type1" id="S3T7U6">P1_re</span>, <span class="var type1" id="S4T7U7">P2_re</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% Checks if it is blocked between P1 and P2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">% Authors: Francesco Mani &lt;francesco.mani@uclouvain.be&gt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%          Mingming Gan   &lt;gan@ftw.at&gt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% History:  2011.9.28</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="keyword">global</span> <span class="var type0" id="S5T0U9">eta</span> <span class="var type0" id="S6T0U10">K</span> <span class="var type0" id="S7T0U11">Nblock</span> <span class="var type0" id="S8T0U12">vnfaces</span> <span class="var type0" id="S9T0U13">wedges</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="mxinfo " id="T7:U4"><span class="var type1" id="S10T7U16">ehi</span>             = <span class="mxinfo " id="T7:U6">zeros(<span class="mxinfo " id="T6:U7">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="mxinfo " id="T7:U8"><span class="var type1" id="S12T7U23">eti</span>             = <span class="mxinfo " id="T7:U10">zeros(<span class="mxinfo " id="T6:U11">3</span>,1)</span></span>; <span class="comment">% (OR): parallel &amp; perpendicular incident vectors (1st interface)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="mxinfo " id="T7:U12"><span class="var type1" id="S13T7U30">ett</span>             = <span class="mxinfo " id="T7:U14">zeros(<span class="mxinfo " id="T6:U15">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="mxinfo " id="T7:U16"><span class="var type1" id="S14T7U37">eht</span>             = <span class="mxinfo " id="T7:U18">zeros(<span class="mxinfo " id="T6:U19">3</span>,1)</span></span>; <span class="comment">% (OR): parallel &amp; perpendicular transmitted vectors (1st interface)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="mxinfo " id="T7:U20"><span class="var type1" id="S15T7U44">eho</span>             = <span class="mxinfo " id="T7:U22">zeros(<span class="mxinfo " id="T6:U23">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="mxinfo " id="T7:U24"><span class="var type1" id="S16T7U51">eto</span>             = <span class="mxinfo " id="T7:U26">zeros(<span class="mxinfo " id="T6:U27">3</span>,1)</span></span>; <span class="comment">% (OR): parallel &amp; perpendicular incident vectors (2nd interface)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="mxinfo " id="T7:U28"><span class="var type1" id="S17T7U58">etr</span>             = <span class="mxinfo " id="T7:U30">zeros(<span class="mxinfo " id="T6:U31">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="mxinfo " id="T7:U32"><span class="var type1" id="S18T7U65">ehr</span>             = <span class="mxinfo " id="T7:U34">zeros(<span class="mxinfo " id="T6:U35">3</span>,1)</span></span>; <span class="comment">% (OR): parallel &amp; perpendicular transmitted vectors (2nd interface)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="mxinfo " id="T7:U36"><span class="var type1" id="S19T7U72">P1</span>              = <span class="mxinfo " id="T7:U38">zeros(<span class="mxinfo " id="T6:U39">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="mxinfo " id="T7:U40"><span class="var type1" id="S20T7U79">P2</span>              = <span class="mxinfo " id="T7:U42">zeros(<span class="mxinfo " id="T6:U43">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="mxinfo " id="T7:U44"><span class="mxinfo " id="T7:U45"><span class="var type1" id="S19T7U87">P1</span>(<span class="mxinfo " id="T8:U47">:</span>,<span class="mxinfo " id="T9:U48">1</span>)</span>         = <span class="var type1" id="S3T7U90">P1_re</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="mxinfo " id="T7:U50"><span class="mxinfo " id="T7:U51"><span class="var type1" id="S20T7U94">P2</span>(<span class="mxinfo " id="T8:U53">:</span>,<span class="mxinfo " id="T9:U54">1</span>)</span>         = <span class="var type1" id="S4T7U97">P2_re</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="mxinfo " id="T10:U56"><span class="var type1" id="S21T10U100">ppt</span>             = <span class="mxinfo " id="T10:U58">zeros(<span class="mxinfo " id="T6:U59">3</span>,<span class="mxinfo " id="T6:U60">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="mxinfo " id="T11:U61"><span class="var type1" id="S22T11U107">nb</span>              = <span class="mxinfo " id="T11:U63">zeros(<span class="mxinfo " id="T6:U64">2</span>,<span class="mxinfo " id="T6:U65">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="mxinfo " id="T7:U66"><span class="var type1" id="S23T7U114">n</span>               = <span class="mxinfo " id="T7:U68">zeros(<span class="mxinfo " id="T6:U69">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="mxinfo " id="T12:U70"><span class="var type1" id="S24T12U121">face</span>            = <span class="mxinfo " id="T12:U72">zeros(<span class="mxinfo " id="T6:U73">2</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="mxinfo " id="T6:U74"><span class="var type1" id="S25T6U128">msk</span>             = <span class="mxinfo " id="T6:U76">0</span></span>; <span class="comment">% no masking</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="mxinfo " id="T7:U77"><span class="var type1" id="S26T7U132">dP</span>              = <span class="mxinfo " id="T7:U79"><span class="var type1" id="S20T7U134">P2</span>-<span class="var type1" id="S19T7U135">P1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo " id="T6:U82"><span class="var type1" id="S27T6U138">dt</span>              = <span class="mxinfo " id="T6:U84">norm(<span class="var type1" id="S26T7U141">dP</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="mxinfo " id="T7:U86"><span class="var type1" id="S29T7U144">sdp</span>             = <span class="mxinfo " id="T7:U88"><span class="var type1" id="S26T7U146">dP</span>/<span class="var type1" id="S27T6U147">dt</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="mxinfo " id="T6:U91"><span class="var type1" id="S30T6U150">cnt</span>             = <span class="mxinfo " id="T6:U93">0</span></span>; <span class="comment">% count the number of penetration per path</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="mxinfo " id="T6:U94"><span class="var type1" id="S31T6U154">i</span>               = <span class="mxinfo " id="T6:U96">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="mxinfo " id="T13:U97"><span class="var type1" id="S32T13U158">uno</span>             = <span class="mxinfo " id="T13:U99">complex(1,0)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo " id="T14:U100"><span class="var type1" id="S34T14U165">tpp</span>             = <span class="mxinfo " id="T14:U102">zeros(<span class="mxinfo " id="T6:U103">1e3</span>,<span class="mxinfo " id="T6:U104">2</span>,<span class="mxinfo " id="T6:U105">3</span>)</span></span>; <span class="comment">% (OR): (nb_penetrations_per_path x [P1 P2] x 3D_coordinates)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="mxinfo " id="T15:U106"><span class="var type1" id="S35T15U173">tff</span>             = <span class="mxinfo " id="T15:U108">zeros(<span class="mxinfo " id="T6:U109">1e3</span>,<span class="mxinfo " id="T6:U110">2</span>,<span class="mxinfo " id="T6:U111">2</span>)</span></span>; <span class="comment">% (OR): (nb_penetrations_per_path x [P1 P2] x [nb_block nb_face])</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="mxinfo " id="T12:U112"><span class="var type1" id="S36T12U181">dist</span>            = <span class="mxinfo " id="T12:U114">zeros(<span class="mxinfo " id="T6:U115">2</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="keyword">while</span> (<span class="mxinfo " id="T16:U116"><span class="var type1" id="S31T6U190">i</span> &lt;= <span class="var type1" id="S7T6U191">Nblock</span></span>) &amp;&amp; (<span class="var type1" id="S25T6U194">msk</span> ~= 1) <span class="comment">% continue until the end of the blocks or until it is masked</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line">    <span class="mxinfo " id="T6:U120"><span class="var type1" id="S37T6U198">count</span>       = <span class="mxinfo " id="T6:U122">0</span></span>; <span class="comment">% count the number of intersection point</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">    <span class="mxinfo " id="T6:U123"><span class="var type1" id="S38T6U202">j</span>           = <span class="mxinfo " id="T6:U125">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line">    <span class="keyword">while</span> (<span class="mxinfo " id="T16:U126"><span class="var type1" id="S38T6U209">j</span> &lt;= <span class="mxinfo " id="T6:U128">6</span></span>) &amp;&amp; (<span class="var type1" id="S25T6U213">msk</span> ~= 1) &amp;&amp; (<span class="mxinfo " id="T16:U130"><span class="var type1" id="S37T6U217">count</span> &lt; <span class="mxinfo " id="T6:U132">2</span></span>) <span class="comment">% for each block, continue (i): until the end of the faces, </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line">        <span class="mxinfo " id="T6:U133"><span class="mxinfo " id="T6:U134"><span class="var type1" id="S24T12U222">face</span>(<span class="mxinfo " id="T9:U136">1</span>)</span> = <span class="var type1" id="S31T6U224">i</span></span>;                            <span class="comment">% (ii): until it is masked, or (iii): both the input and output points are found</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line">        <span class="mxinfo " id="T6:U138"><span class="mxinfo " id="T6:U139"><span class="var type1" id="S24T12U228">face</span>(<span class="mxinfo " id="T9:U141">2</span>)</span> = <span class="var type1" id="S38T6U230">j</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">        <span class="mxinfo " id="T7:U143"><span class="mxinfo " id="T7:U144"><span class="var type1" id="S23T7U234">n</span>(<span class="mxinfo " id="T8:U146">:</span>,<span class="mxinfo " id="T9:U147">1</span>)</span>  = <span class="mxinfo " id="T17:U148"><span class="var type1" id="S8T18U238">vnfaces</span>(<span class="var type1" id="S31T6U239">i</span>,<span class="var type1" id="S38T6U240">j</span>,<span class="mxinfo " id="T8:U152">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">        <span class="mxinfo " id="T6:U153"><span class="var type1" id="S39T6U244">c</span>       = <span class="mxinfo " id="T6:U155"><span class="mxinfo " id="T19:U156"><span class="var type1" id="S26T7U247">dP</span>'</span>*<span class="var type1" id="S23T7U248">n</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T16:U159"><span class="mxinfo " id="T6:U160">abs(<span class="var type1" id="S39T6U255">c</span>)</span> &gt; <span class="mxinfo " id="T6:U162">1.0e-3</span></span>) <span class="comment">% if the path is not parallel to the face, then look for the intersections</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line">            <span class="mxinfo " id="T6:U163"><span class="var type1" id="S41T6U259">x1</span>  = <span class="mxinfo " id="T6:U165"><span class="var type1" id="S9T20U261">wedges</span>(<span class="var type1" id="S31T6U262">i</span>,<span class="var type1" id="S38T6U263">j</span>,<span class="mxinfo " id="T6:U169">1</span>,<span class="mxinfo " id="T6:U170">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line">            <span class="mxinfo " id="T6:U171"><span class="var type1" id="S42T6U268">y1</span>  = <span class="mxinfo " id="T6:U173"><span class="var type1" id="S9T20U270">wedges</span>(<span class="var type1" id="S31T6U271">i</span>,<span class="var type1" id="S38T6U272">j</span>,<span class="mxinfo " id="T6:U177">1</span>,<span class="mxinfo " id="T6:U178">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">            <span class="mxinfo " id="T6:U179"><span class="var type1" id="S43T6U277">z1</span>  = <span class="mxinfo " id="T6:U181"><span class="var type1" id="S9T20U279">wedges</span>(<span class="var type1" id="S31T6U280">i</span>,<span class="var type1" id="S38T6U281">j</span>,<span class="mxinfo " id="T6:U185">1</span>,<span class="mxinfo " id="T6:U186">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">            <span class="mxinfo " id="T6:U187"><span class="var type1" id="S44T6U286">x2</span>  = <span class="mxinfo " id="T6:U189"><span class="var type1" id="S9T20U288">wedges</span>(<span class="var type1" id="S31T6U289">i</span>,<span class="var type1" id="S38T6U290">j</span>,<span class="mxinfo " id="T6:U193">2</span>,<span class="mxinfo " id="T6:U194">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line">            <span class="mxinfo " id="T6:U195"><span class="var type1" id="S45T6U295">y2</span>  = <span class="mxinfo " id="T6:U197"><span class="var type1" id="S9T20U297">wedges</span>(<span class="var type1" id="S31T6U298">i</span>,<span class="var type1" id="S38T6U299">j</span>,<span class="mxinfo " id="T6:U201">2</span>,<span class="mxinfo " id="T6:U202">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">            <span class="mxinfo " id="T6:U203"><span class="var type1" id="S46T6U304">z2</span>  = <span class="mxinfo " id="T6:U205"><span class="var type1" id="S9T20U306">wedges</span>(<span class="var type1" id="S31T6U307">i</span>,<span class="var type1" id="S38T6U308">j</span>,<span class="mxinfo " id="T6:U209">2</span>,<span class="mxinfo " id="T6:U210">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">            <span class="mxinfo " id="T6:U211"><span class="var type1" id="S47T6U313">x0</span>  = <span class="mxinfo " id="T6:U213"><span class="var type1" id="S9T20U315">wedges</span>(<span class="var type1" id="S31T6U316">i</span>,<span class="var type1" id="S38T6U317">j</span>,<span class="mxinfo " id="T6:U217">3</span>,<span class="mxinfo " id="T6:U218">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">            <span class="mxinfo " id="T6:U219"><span class="var type1" id="S48T6U322">y0</span>  = <span class="mxinfo " id="T6:U221"><span class="var type1" id="S9T20U324">wedges</span>(<span class="var type1" id="S31T6U325">i</span>,<span class="var type1" id="S38T6U326">j</span>,<span class="mxinfo " id="T6:U225">3</span>,<span class="mxinfo " id="T6:U226">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">            <span class="mxinfo " id="T6:U227"><span class="var type1" id="S49T6U331">z0</span>  = <span class="mxinfo " id="T6:U229"><span class="var type1" id="S9T20U333">wedges</span>(<span class="var type1" id="S31T6U334">i</span>,<span class="var type1" id="S38T6U335">j</span>,<span class="mxinfo " id="T6:U233">3</span>,<span class="mxinfo " id="T6:U234">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">            <span class="mxinfo " id="T6:U235"><span class="var type1" id="S50T6U340">dtr</span> = <span class="mxinfo " id="T6:U237"><span class="mxinfo " id="T6:U238"><span class="mxinfo " id="T6:U239">(<span class="mxinfo " id="T6:U240"><span class="mxinfo " id="T6:U241"><span class="var type1" id="S19T7U347">P1</span>(<span class="mxinfo " id="T9:U243">1</span>)</span>-<span class="mxinfo " id="T6:U244"><span class="var type1" id="S20T7U350">P2</span>(<span class="mxinfo " id="T6:U246">1</span>)</span></span>)*(<span class="mxinfo " id="T6:U247"><span class="mxinfo " id="T6:U248">(<span class="mxinfo " id="T6:U249"><span class="var type1" id="S42T6U357">y1</span>-<span class="var type1" id="S48T6U358">y0</span></span>)*(<span class="mxinfo " id="T6:U252"><span class="var type1" id="S46T6U361">z2</span>-<span class="var type1" id="S49T6U362">z0</span></span>)</span>-<span class="mxinfo " id="T6:U255">(<span class="mxinfo " id="T6:U256"><span class="var type1" id="S45T6U366">y2</span>-<span class="var type1" id="S48T6U367">y0</span></span>)*(<span class="mxinfo " id="T6:U259"><span class="var type1" id="S43T6U370">z1</span>-<span class="var type1" id="S49T6U371">z0</span></span>)</span></span>)</span>- <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">                  <span class="mxinfo " id="T6:U262">(<span class="mxinfo " id="T6:U263"><span class="mxinfo " id="T6:U264"><span class="var type1" id="S19T7U376">P1</span>(<span class="mxinfo " id="T6:U266">2</span>)</span>-<span class="mxinfo " id="T6:U267"><span class="var type1" id="S20T7U379">P2</span>(<span class="mxinfo " id="T6:U269">2</span>)</span></span>)*(<span class="mxinfo " id="T6:U270"><span class="mxinfo " id="T6:U271">(<span class="mxinfo " id="T6:U272"><span class="var type1" id="S41T6U386">x1</span>-<span class="var type1" id="S47T6U387">x0</span></span>)*(<span class="mxinfo " id="T6:U275"><span class="var type1" id="S46T6U390">z2</span>-<span class="var type1" id="S49T6U391">z0</span></span>)</span>-<span class="mxinfo " id="T6:U278">(<span class="mxinfo " id="T6:U279"><span class="var type1" id="S44T6U395">x2</span>-<span class="var type1" id="S47T6U396">x0</span></span>)*(<span class="mxinfo " id="T6:U282"><span class="var type1" id="S43T6U399">z1</span>-<span class="var type1" id="S49T6U400">z0</span></span>)</span></span>)</span></span>+ <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">                  <span class="mxinfo " id="T6:U285">(<span class="mxinfo " id="T6:U286"><span class="mxinfo " id="T6:U287"><span class="var type1" id="S19T7U405">P1</span>(<span class="mxinfo " id="T6:U289">3</span>)</span>-<span class="mxinfo " id="T6:U290"><span class="var type1" id="S20T7U408">P2</span>(<span class="mxinfo " id="T6:U292">3</span>)</span></span>)*(<span class="mxinfo " id="T6:U293"><span class="mxinfo " id="T6:U294">(<span class="mxinfo " id="T6:U295"><span class="var type1" id="S41T6U415">x1</span>-<span class="var type1" id="S47T6U416">x0</span></span>)*(<span class="mxinfo " id="T6:U298"><span class="var type1" id="S45T6U419">y2</span>-<span class="var type1" id="S48T6U420">y0</span></span>)</span>-<span class="mxinfo " id="T6:U301">(<span class="mxinfo " id="T6:U302"><span class="var type1" id="S44T6U424">x2</span>-<span class="var type1" id="S47T6U425">x0</span></span>)*(<span class="mxinfo " id="T6:U305"><span class="var type1" id="S42T6U428">y1</span>-<span class="var type1" id="S48T6U429">y0</span></span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T16:U308"><span class="var type1" id="S50T6U434">dtr</span> == <span class="mxinfo " id="T6:U310">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">                error(<span class="string">'   Error: the determinant is equal to zero in blocking function!'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">                <span class="mxinfo " id="T6:U311"><span class="var type1" id="S52T6U443">t</span> = <span class="mxinfo " id="T6:U313">(<span class="mxinfo " id="T6:U314"><span class="mxinfo " id="T6:U315"><span class="mxinfo " id="T6:U316">(<span class="mxinfo " id="T6:U317"><span class="mxinfo " id="T6:U318"><span class="var type1" id="S19T7U452">P1</span>(<span class="mxinfo " id="T9:U320">1</span>)</span>-<span class="var type1" id="S47T6U454">x0</span></span>)*(<span class="mxinfo " id="T6:U322"><span class="mxinfo " id="T6:U323">(<span class="mxinfo " id="T6:U324"><span class="var type1" id="S42T6U460">y1</span>-<span class="var type1" id="S48T6U461">y0</span></span>)*(<span class="mxinfo " id="T6:U327"><span class="var type1" id="S46T6U464">z2</span>-<span class="var type1" id="S49T6U465">z0</span></span>)</span>-<span class="mxinfo " id="T6:U330">(<span class="mxinfo " id="T6:U331"><span class="var type1" id="S45T6U469">y2</span>-<span class="var type1" id="S48T6U470">y0</span></span>)*(<span class="mxinfo " id="T6:U334"><span class="var type1" id="S43T6U473">z1</span>-<span class="var type1" id="S49T6U474">z0</span></span>)</span></span>)</span>+ <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">                    <span class="mxinfo " id="T6:U337">(<span class="mxinfo " id="T6:U338"><span class="mxinfo " id="T6:U339"><span class="var type1" id="S19T7U479">P1</span>(<span class="mxinfo " id="T6:U341">2</span>)</span>-<span class="var type1" id="S48T6U481">y0</span></span>)*(<span class="mxinfo " id="T6:U343"><span class="mxinfo " id="T6:U344">(<span class="mxinfo " id="T6:U345"><span class="var type1" id="S44T6U487">x2</span>-<span class="var type1" id="S47T6U488">x0</span></span>)*(<span class="mxinfo " id="T6:U348"><span class="var type1" id="S43T6U491">z1</span>-<span class="var type1" id="S49T6U492">z0</span></span>)</span>-<span class="mxinfo " id="T6:U351">(<span class="mxinfo " id="T6:U352"><span class="var type1" id="S41T6U496">x1</span>-<span class="var type1" id="S47T6U497">x0</span></span>)*(<span class="mxinfo " id="T6:U355"><span class="var type1" id="S46T6U500">z2</span>-<span class="var type1" id="S49T6U501">z0</span></span>)</span></span>)</span></span>+ <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">                    <span class="mxinfo " id="T6:U358">(<span class="mxinfo " id="T6:U359"><span class="mxinfo " id="T6:U360"><span class="var type1" id="S19T7U506">P1</span>(<span class="mxinfo " id="T6:U362">3</span>)</span>-<span class="var type1" id="S49T6U508">z0</span></span>)*(<span class="mxinfo " id="T6:U364"><span class="mxinfo " id="T6:U365">(<span class="mxinfo " id="T6:U366"><span class="var type1" id="S41T6U514">x1</span>-<span class="var type1" id="S47T6U515">x0</span></span>)*(<span class="mxinfo " id="T6:U369"><span class="var type1" id="S45T6U518">y2</span>-<span class="var type1" id="S48T6U519">y0</span></span>)</span>-<span class="mxinfo " id="T6:U372">(<span class="mxinfo " id="T6:U373"><span class="var type1" id="S44T6U523">x2</span>-<span class="var type1" id="S47T6U524">x0</span></span>)*(<span class="mxinfo " id="T6:U376"><span class="var type1" id="S42T6U527">y1</span>-<span class="var type1" id="S48T6U528">y0</span></span>)</span></span>)</span></span>)/<span class="var type1" id="S50T6U529">dtr</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">                <span class="keyword">if</span> (<span class="mxinfo " id="T16:U380"><span class="var type1" id="S52T6U535">t</span> &gt; <span class="mxinfo " id="T6:U382">-<span class="mxinfo " id="T6:U383">1.0e-6</span></span></span>) &amp;&amp; (<span class="mxinfo " id="T16:U384"><span class="var type1" id="S52T6U540">t</span> &lt; (<span class="mxinfo " id="T6:U386"><span class="mxinfo " id="T6:U387">1</span>+<span class="mxinfo " id="T6:U388">1.0e-6</span></span>)</span>) <span class="comment">% if t&gt;0 &amp;&amp; t&lt;1, intersection point is in-between P1 and P2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">                    <span class="mxinfo " id="T7:U389"><span class="var type1" id="S53T7U547">ip</span>               = <span class="mxinfo " id="T7:U391"><span class="var type1" id="S20T7U549">P2</span>-<span class="var type1" id="S19T7U550">P1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">                    <span class="mxinfo " id="T7:U394"><span class="var type1" id="S53T7U553">ip</span>               = <span class="mxinfo " id="T7:U396"><span class="var type1" id="S19T7U555">P1</span>+<span class="mxinfo " id="T7:U398"><span class="var type1" id="S52T6U557">t</span>*<span class="var type1" id="S53T7U558">ip</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">                    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line"><span class="comment">%                     af = AppFace(ip,face);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line"><span class="comment">%                     Atemp(:) = wedges(face(1),face(2),[1 2 4],:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line"><span class="comment">%                     af = AppFace(ip,Atemp);%Loe_20161013, af = AppFace(ip,face);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">                    <span class="mxinfo " id="T6:U401"><span class="var type1" id="S54T6U561">af</span>               = <span class="mxinfo " id="T6:U403"><span class="fcn" id="F159N2:B563">AppFace2</span>(<span class="var type1" id="S53T7U564">ip</span>,<span class="mxinfo " id="T21:U405"><span class="mxinfo " id="T22:U406">reshape(<span class="mxinfo " id="T23:U407"><span class="var type1" id="S9T20U569">wedges</span>(<span class="mxinfo " id="T6:U409"><span class="var type1" id="S24T12U571">face</span>(<span class="mxinfo " id="T9:U411">1</span>)</span>,<span class="mxinfo " id="T6:U412"><span class="var type1" id="S24T12U574">face</span>(<span class="mxinfo " id="T9:U414">2</span>)</span>,<span class="mxinfo " id="T24:U415">:</span>,<span class="mxinfo " id="T8:U416">:</span>)</span>,[],3)</span>.'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">                    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">                    <span class="keyword">if</span> (<span class="mxinfo " id="T16:U417"><span class="var type1" id="S54T6U585">af</span> == <span class="mxinfo " id="T6:U419">1</span></span>) <span class="comment">% intersection point is found</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">                        <span class="mxinfo " id="T6:U420"><span class="var type1" id="S37T6U589">count</span>        = <span class="mxinfo " id="T6:U422"><span class="var type1" id="S37T6U591">count</span>+<span class="mxinfo " id="T6:U424">1</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">                        <span class="mxinfo " id="T7:U425"><span class="mxinfo " id="T7:U426"><span class="var type1" id="S21T10U596">ppt</span>(<span class="mxinfo " id="T8:U428">:</span>,<span class="var type1" id="S37T6U598">count</span>)</span> = <span class="var type1" id="S53T7U599">ip</span></span>; <span class="comment">% coordinates of the intersection point</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">                        <span class="mxinfo " id="T6:U431"><span class="mxinfo " id="T6:U432"><span class="var type1" id="S22T11U603">nb</span>(<span class="mxinfo " id="T6:U434">1</span>,<span class="var type1" id="S37T6U605">count</span>)</span>  = <span class="var type1" id="S31T6U606">i</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">                        <span class="mxinfo " id="T6:U437"><span class="mxinfo " id="T6:U438"><span class="var type1" id="S22T11U610">nb</span>(<span class="mxinfo " id="T6:U440">2</span>,<span class="var type1" id="S37T6U612">count</span>)</span>  = <span class="var type1" id="S38T6U613">j</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T16:U443"><span class="var type1" id="S37T6U619">count</span> == <span class="mxinfo " id="T6:U445">2</span></span>) &amp;&amp; (<span class="var type1" id="S25T6U623">msk</span> ~= 1) <span class="comment">% if the two intersection points are found and there is no masking</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">            <span class="mxinfo " id="T7:U447"><span class="var type1" id="S57T7U627">d1</span>                   = <span class="mxinfo " id="T7:U449"><span class="var type1" id="S19T7U629">P1</span>-<span class="mxinfo " id="T7:U451"><span class="var type1" id="S21T10U631">ppt</span>(<span class="mxinfo " id="T8:U453">:</span>,<span class="mxinfo " id="T6:U454">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">            <span class="mxinfo " id="T7:U455"><span class="var type1" id="S58T7U636">d2</span>                   = <span class="mxinfo " id="T7:U457"><span class="var type1" id="S19T7U638">P1</span>-<span class="mxinfo " id="T7:U459"><span class="var type1" id="S21T10U640">ppt</span>(<span class="mxinfo " id="T8:U461">:</span>,<span class="mxinfo " id="T6:U462">2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">            <span class="mxinfo " id="T6:U463"><span class="mxinfo " id="T6:U464"><span class="var type1" id="S36T12U646">dist</span>(<span class="mxinfo " id="T9:U466">1</span>)</span>              = <span class="mxinfo " id="T6:U467">norm(<span class="var type1" id="S57T7U650">d1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">            <span class="mxinfo " id="T6:U469"><span class="mxinfo " id="T6:U470"><span class="var type1" id="S36T12U654">dist</span>(<span class="mxinfo " id="T9:U472">2</span>)</span>              = <span class="mxinfo " id="T6:U473">norm(<span class="var type1" id="S58T7U658">d2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T16:U475"><span class="mxinfo " id="T6:U476">abs(<span class="mxinfo " id="T6:U477"><span class="mxinfo " id="T6:U478"><span class="var type1" id="S36T12U667">dist</span>(<span class="mxinfo " id="T9:U480">1</span>)</span>-<span class="mxinfo " id="T6:U481"><span class="var type1" id="S36T12U670">dist</span>(<span class="mxinfo " id="T6:U483">2</span>)</span></span>)</span> &gt; <span class="mxinfo " id="T6:U484">1.0e-8</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">                <span class="mxinfo " id="T6:U485"><span class="var type1" id="S30T6U675">cnt</span>              = <span class="mxinfo " id="T6:U487"><span class="var type1" id="S30T6U677">cnt</span>+<span class="mxinfo " id="T6:U489">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">                [<span class="mxinfo " id="T12:U490">~</span>,<span class="var type1" id="S59T12U683">ord</span>]          = sort(<span class="var type1" id="S36T12U686">dist</span>,<span class="string">'ascend'</span>); <span class="comment">% order the intersection points starting from the closer </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">                                                        <span class="comment">% to the virtual transmitter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">                <span class="mxinfo " id="T25:U493"><span class="mxinfo " id="T25:U494"><span class="var type1" id="S34T14U691">tpp</span>(<span class="var type1" id="S30T6U692">cnt</span>,<span class="mxinfo " id="T26:U497"><span class="mxinfo " id="T6:U498">1</span>:<span class="mxinfo " id="T6:U499">2</span></span>,<span class="mxinfo " id="T8:U500">:</span>)</span>   = <span class="mxinfo " id="T27:U501"><span class="mxinfo " id="T10:U502"><span class="var type1" id="S21T10U699">ppt</span>(<span class="mxinfo " id="T8:U504">:</span>,<span class="var type1" id="S59T12U701">ord</span>)</span>.'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">                <span class="mxinfo " id="T28:U506"><span class="mxinfo " id="T28:U507"><span class="var type1" id="S35T15U705">tff</span>(<span class="var type1" id="S30T6U706">cnt</span>,<span class="mxinfo " id="T26:U510"><span class="mxinfo " id="T6:U511">1</span>:<span class="mxinfo " id="T6:U512">2</span></span>,<span class="mxinfo " id="T29:U513">:</span>)</span>   = <span class="mxinfo " id="T11:U514"><span class="mxinfo " id="T11:U515"><span class="var type1" id="S22T11U713">nb</span>(<span class="mxinfo " id="T29:U517">:</span>,<span class="var type1" id="S59T12U715">ord</span>)</span>.'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">        <span class="mxinfo " id="T6:U519"><span class="var type1" id="S38T6U718">j</span>                        = <span class="mxinfo " id="T6:U521"><span class="var type1" id="S38T6U720">j</span>+<span class="mxinfo " id="T6:U523">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">    <span class="mxinfo " id="T6:U524"><span class="var type1" id="S31T6U724">i</span>                            = <span class="mxinfo " id="T6:U526"><span class="var type1" id="S31T6U726">i</span>+<span class="mxinfo " id="T6:U528">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line"><span class="mxinfo " id="T4:U529"><span class="var type1" id="S36T4U730">dist</span>                             = <span class="mxinfo " id="T4:U531">[<span class="var type1" id="S36T12U733">dist</span> ; <span class="mxinfo " id="T30:U533">zeros(<span class="mxinfo " id="T6:U534">max(<span class="mxinfo " id="T26:U535">[<span class="mxinfo " id="T6:U536">0</span> <span class="mxinfo " id="T6:U537"><span class="var type1" id="S30T6U743">cnt</span>-<span class="mxinfo " id="T6:U539">2</span></span>]</span>)</span>,1)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line"><span class="mxinfo " id="T7:U540"><span class="var type1" id="S57T7U748">d1</span>                               = <span class="mxinfo " id="T7:U542">zeros(<span class="mxinfo " id="T6:U543">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line"><span class="keyword">if</span> (<span class="var type1" id="S25T6U757">msk</span> ~= 1)</span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">    <span class="mxinfo " id="T7:U545"><span class="var type1" id="S62T7U761">tpp_re</span>             = <span class="mxinfo " id="T7:U547">zeros(<span class="mxinfo " id="T6:U548">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S63T6U768">k</span> = <span class="mxinfo " id="T6:U550">1</span>:<span class="var type1" id="S30T6U771">cnt</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">        <span class="mxinfo " id="T7:U552"><span class="mxinfo " id="T7:U553"><span class="var type1" id="S62T7U775">tpp_re</span>(<span class="mxinfo " id="T8:U555">:</span>,<span class="mxinfo " id="T6:U556">1</span>)</span>    = <span class="mxinfo " id="T17:U557"><span class="var type1" id="S34T14U779">tpp</span>(<span class="var type1" id="S63T6U780">k</span>,<span class="mxinfo " id="T6:U560">1</span>,<span class="mxinfo " id="T8:U561">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">        <span class="mxinfo " id="T7:U562"><span class="mxinfo " id="T7:U563"><span class="var type1" id="S57T7U786">d1</span>(<span class="mxinfo " id="T8:U565">:</span>,<span class="mxinfo " id="T9:U566">1</span>)</span>        = <span class="mxinfo " id="T7:U567"><span class="var type1" id="S19T7U790">P1</span>-<span class="var type1" id="S62T7U791">tpp_re</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">        <span class="mxinfo " id="T6:U570"><span class="mxinfo " id="T6:U571"><span class="var type1" id="S36T4U795">dist</span>(<span class="var type1" id="S63T6U796">k</span>)</span>        = <span class="mxinfo " id="T6:U574">norm(<span class="var type1" id="S57T7U799">d1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T16:U576"><span class="var type1" id="S30T6U804">cnt</span> &gt; <span class="mxinfo " id="T6:U578">1</span></span>) <span class="comment">% if more than one penetration is found during the path, they are ordered from </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">                 <span class="comment">% beginning from the closest to P1 - insertion sort</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">        [<span class="mxinfo " id="T4:U579">~</span>,<span class="var type1" id="S59T4U810">ord</span>]        = sort(<span class="var type1" id="S36T4U813">dist</span>,<span class="string">'ascend'</span>); <span class="comment">% order the penetrations starting from the closer </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">                                              <span class="comment">% to the virtual transmitter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">        <span class="mxinfo " id="T4:U582"><span class="var type1" id="S36T4U818">dist</span>(:)        = <span class="mxinfo " id="T4:U584"><span class="var type1" id="S36T4U821">dist</span>(<span class="var type1" id="S59T4U822">ord</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">        <span class="mxinfo " id="T31:U587"><span class="mxinfo " id="T31:U588"><span class="var type1" id="S34T14U826">tpp</span>(<span class="mxinfo " id="T32:U590"><span class="mxinfo " id="T6:U591">1</span>:length(<span class="var type1" id="S59T4U831">ord</span>)</span>,<span class="mxinfo " id="T29:U593">:</span>,<span class="mxinfo " id="T8:U594">:</span>)</span> = <span class="mxinfo " id="T31:U595"><span class="var type1" id="S34T14U835">tpp</span>(<span class="var type1" id="S59T4U836">ord</span>,<span class="mxinfo " id="T29:U598">:</span>,<span class="mxinfo " id="T8:U599">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line">        <span class="mxinfo " id="T33:U600"><span class="mxinfo " id="T33:U601"><span class="var type1" id="S35T15U842">tff</span>(<span class="mxinfo " id="T32:U603"><span class="mxinfo " id="T6:U604">1</span>:length(<span class="var type1" id="S59T4U847">ord</span>)</span>,<span class="mxinfo " id="T29:U606">:</span>,<span class="mxinfo " id="T29:U607">:</span>)</span> = <span class="mxinfo " id="T33:U608"><span class="var type1" id="S35T15U851">tff</span>(<span class="var type1" id="S59T4U852">ord</span>,<span class="mxinfo " id="T29:U611">:</span>,<span class="mxinfo " id="T29:U612">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line"><span class="comment">% computing the parameters of penetration</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line"><span class="mxinfo " id="T12:U613"><span class="var type1" id="S65T12U857">flag</span>       = <span class="mxinfo " id="T12:U615">zeros(<span class="mxinfo " id="T6:U616">2</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line"><span class="mxinfo " id="T7:U617"><span class="var type1" id="S66T7U864">vnfaces_re</span> = <span class="mxinfo " id="T7:U619">zeros(<span class="mxinfo " id="T6:U620">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line"><span class="mxinfo " id="T7:U621"><span class="var type1" id="S67T7U871">tp</span>         = <span class="mxinfo " id="T7:U623">zeros(<span class="mxinfo " id="T6:U624">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line"><span class="mxinfo " id="T4:U625"><span class="var type1" id="S68T4U878">mnbpen</span>     = <span class="mxinfo " id="T4:U627">zeros(<span class="var type1" id="S30T6U881">cnt</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line"><span class="mxinfo " id="T34:U629"><span class="var type1" id="S69T34U885">mpflag</span>     = <span class="mxinfo " id="T34:U631">zeros(<span class="var type1" id="S30T6U888">cnt</span>,<span class="mxinfo " id="T6:U633">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line"><span class="mxinfo " id="T35:U634"><span class="var type1" id="S70T35U892">mploss</span>     = <span class="mxinfo " id="T35:U636">complex(<span class="mxinfo " id="T4:U637">zeros(<span class="var type1" id="S30T6U897">cnt</span>,1)</span>,<span class="mxinfo " id="T4:U639">zeros(<span class="var type1" id="S30T6U901">cnt</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line"><span class="mxinfo " id="T4:U641"><span class="var type1" id="S71T4U905">mpd</span>        = <span class="mxinfo " id="T4:U643">zeros(<span class="var type1" id="S30T6U908">cnt</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line"><span class="mxinfo " id="T4:U645"><span class="var type1" id="S72T4U912">mepd</span>       = <span class="mxinfo " id="T4:U647">zeros(<span class="var type1" id="S30T6U915">cnt</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line"><span class="mxinfo " id="T2:U649"><span class="var type1" id="S73T2U919">msti</span>       = <span class="mxinfo " id="T2:U651">complex(<span class="mxinfo " id="T36:U652">zeros(<span class="var type1" id="S30T6U924">cnt</span>,<span class="mxinfo " id="T6:U654">3</span>)</span>,<span class="mxinfo " id="T36:U655">zeros(<span class="var type1" id="S30T6U928">cnt</span>,<span class="mxinfo " id="T6:U657">3</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line"><span class="mxinfo " id="T2:U658"><span class="var type1" id="S74T2U932">mstt</span>       = <span class="mxinfo " id="T2:U660">complex(<span class="mxinfo " id="T36:U661">zeros(<span class="var type1" id="S30T6U937">cnt</span>,<span class="mxinfo " id="T6:U663">3</span>)</span>,<span class="mxinfo " id="T36:U664">zeros(<span class="var type1" id="S30T6U941">cnt</span>,<span class="mxinfo " id="T6:U666">3</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line"><span class="mxinfo " id="T2:U667"><span class="var type1" id="S75T2U945">mshi</span>       = <span class="mxinfo " id="T2:U669">complex(<span class="mxinfo " id="T36:U670">zeros(<span class="var type1" id="S30T6U950">cnt</span>,<span class="mxinfo " id="T6:U672">3</span>)</span>,<span class="mxinfo " id="T36:U673">zeros(<span class="var type1" id="S30T6U954">cnt</span>,<span class="mxinfo " id="T6:U675">3</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line"><span class="mxinfo " id="T2:U676"><span class="var type1" id="S76T2U958">msht</span>       = <span class="mxinfo " id="T2:U678">complex(<span class="mxinfo " id="T36:U679">zeros(<span class="var type1" id="S30T6U963">cnt</span>,<span class="mxinfo " id="T6:U681">3</span>)</span>,<span class="mxinfo " id="T36:U682">zeros(<span class="var type1" id="S30T6U967">cnt</span>,<span class="mxinfo " id="T6:U684">3</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line"><span class="mxinfo " id="T2:U685"><span class="var type1" id="S77T2U971">mstr</span>       = <span class="mxinfo " id="T2:U687">complex(<span class="mxinfo " id="T36:U688">zeros(<span class="var type1" id="S30T6U976">cnt</span>,<span class="mxinfo " id="T6:U690">3</span>)</span>,<span class="mxinfo " id="T36:U691">zeros(<span class="var type1" id="S30T6U980">cnt</span>,<span class="mxinfo " id="T6:U693">3</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line"><span class="mxinfo " id="T2:U694"><span class="var type1" id="S78T2U984">msto</span>       = <span class="mxinfo " id="T2:U696">complex(<span class="mxinfo " id="T36:U697">zeros(<span class="var type1" id="S30T6U989">cnt</span>,<span class="mxinfo " id="T6:U699">3</span>)</span>,<span class="mxinfo " id="T36:U700">zeros(<span class="var type1" id="S30T6U993">cnt</span>,<span class="mxinfo " id="T6:U702">3</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line"><span class="mxinfo " id="T2:U703"><span class="var type1" id="S79T2U997">mshr</span>       = <span class="mxinfo " id="T2:U705">complex(<span class="mxinfo " id="T36:U706">zeros(<span class="var type1" id="S30T6U1002">cnt</span>,<span class="mxinfo " id="T6:U708">3</span>)</span>,<span class="mxinfo " id="T36:U709">zeros(<span class="var type1" id="S30T6U1006">cnt</span>,<span class="mxinfo " id="T6:U711">3</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line"><span class="mxinfo " id="T2:U712"><span class="var type1" id="S80T2U1010">msho</span>       = <span class="mxinfo " id="T2:U714">complex(<span class="mxinfo " id="T36:U715">zeros(<span class="var type1" id="S30T6U1015">cnt</span>,<span class="mxinfo " id="T6:U717">3</span>)</span>,<span class="mxinfo " id="T36:U718">zeros(<span class="var type1" id="S30T6U1019">cnt</span>,<span class="mxinfo " id="T6:U720">3</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line"><span class="mxinfo " id="T35:U721"><span class="var type1" id="S81T35U1023">mTti</span>       = <span class="mxinfo " id="T35:U723">complex(<span class="mxinfo " id="T4:U724">zeros(<span class="var type1" id="S30T6U1028">cnt</span>,1)</span>,<span class="mxinfo " id="T4:U726">zeros(<span class="var type1" id="S30T6U1032">cnt</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line"><span class="mxinfo " id="T35:U728"><span class="var type1" id="S82T35U1036">mThi</span>       = <span class="mxinfo " id="T35:U730">complex(<span class="mxinfo " id="T4:U731">zeros(<span class="var type1" id="S30T6U1041">cnt</span>,1)</span>,<span class="mxinfo " id="T4:U733">zeros(<span class="var type1" id="S30T6U1045">cnt</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line"><span class="mxinfo " id="T35:U735"><span class="var type1" id="S83T35U1049">mTtt</span>       = <span class="mxinfo " id="T35:U737">complex(<span class="mxinfo " id="T4:U738">zeros(<span class="var type1" id="S30T6U1054">cnt</span>,1)</span>,<span class="mxinfo " id="T4:U740">zeros(<span class="var type1" id="S30T6U1058">cnt</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line"><span class="mxinfo " id="T35:U742"><span class="var type1" id="S84T35U1062">mTht</span>       = <span class="mxinfo " id="T35:U744">complex(<span class="mxinfo " id="T4:U745">zeros(<span class="var type1" id="S30T6U1067">cnt</span>,1)</span>,<span class="mxinfo " id="T4:U747">zeros(<span class="var type1" id="S30T6U1071">cnt</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line"><span class="mxinfo " id="T6:U749"><span class="var type1" id="S85T6U1075">l</span>                   = <span class="mxinfo " id="T6:U751">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line"><span class="keyword">while</span> (<span class="mxinfo " id="T16:U752"><span class="var type1" id="S85T6U1081">l</span> &lt;= <span class="var type1" id="S30T6U1082">cnt</span></span>) &amp;&amp; (<span class="mxinfo " id="T16:U755"><span class="var type1" id="S25T6U1085">msk</span> ~= <span class="mxinfo " id="T6:U757">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line">    <span class="mxinfo " id="T12:U758"><span class="mxinfo " id="T12:U759"><span class="var type1" id="S65T12U1090">flag</span>(<span class="mxinfo " id="T29:U761">:</span>,<span class="mxinfo " id="T6:U762">1</span>)</span>       = <span class="mxinfo " id="T12:U763"><span class="mxinfo " id="T26:U764">[<span class="mxinfo " id="T6:U765">0</span> <span class="mxinfo " id="T6:U766">0</span>]</span>.'</span></span>; <span class="comment">% -&gt; flag(1,1) = {0,1,2,3}</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line">                               <span class="comment">% -&gt; flag(2,1) = {0,4,5,6}, respectively</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line">    <span class="mxinfo " id="T6:U767"><span class="var type1" id="S86T6U1100">f1</span>              = <span class="mxinfo " id="T6:U769"><span class="fcn" id="F240N3:B1102">BlockCheck</span>(<span class="mxinfo " id="T6:U770"><span class="var type1" id="S35T15U1104">tff</span>(<span class="var type1" id="S85T6U1105">l</span>,<span class="mxinfo " id="T9:U773">1</span>,<span class="mxinfo " id="T9:U774">1</span>)</span>,<span class="mxinfo " id="T17:U775"><span class="var type1" id="S34T14U1109">tpp</span>(<span class="var type1" id="S85T6U1110">l</span>,<span class="mxinfo " id="T9:U778">1</span>,<span class="mxinfo " id="T8:U779">:</span>)</span>)</span></span>; <span class="comment">% checks if the input penetration point belongs to some other </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line">                                                         <span class="comment">% block (-1 if not)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T16:U780"><span class="var type1" id="S85T6U1119">l</span> == <span class="mxinfo " id="T6:U782">1</span></span>) &amp;&amp; (<span class="mxinfo " id="T16:U783"><span class="var type1" id="S86T6U1123">f1</span> ~= <span class="mxinfo " id="T6:U785">-<span class="mxinfo " id="T6:U786">1</span></span></span>) &amp;&amp; (<span class="mxinfo " id="T16:U787"><span class="mxinfo " id="T6:U788"><span class="var type1" id="S36T4U1129">dist</span>(<span class="var type1" id="S85T6U1130">l</span>)</span> &gt; <span class="mxinfo " id="T6:U791">0.005</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line">        fprintf(<span class="string">'      Error: Cannot be 1st penetration! \n'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line">        <span class="mxinfo " id="T6:U792"><span class="var type1" id="S25T6U1138">msk</span>         = <span class="mxinfo " id="T6:U794">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line">        <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line">    <span class="mxinfo " id="T6:U795"><span class="var type1" id="S89T6U1143">f2</span>              = <span class="mxinfo " id="T6:U797"><span class="fcn" id="F240N3:B1145">BlockCheck</span>(<span class="mxinfo " id="T6:U798"><span class="var type1" id="S35T15U1147">tff</span>(<span class="var type1" id="S85T6U1148">l</span>,<span class="mxinfo " id="T9:U801">2</span>,<span class="mxinfo " id="T9:U802">1</span>)</span>,<span class="mxinfo " id="T17:U803"><span class="var type1" id="S34T14U1152">tpp</span>(<span class="var type1" id="S85T6U1153">l</span>,<span class="mxinfo " id="T9:U806">2</span>,<span class="mxinfo " id="T8:U807">:</span>)</span>)</span></span>; <span class="comment">% checks if the output penetration point belongs to some other </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line">                                                         <span class="comment">% block (-1 if not)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line">    <span class="mxinfo " id="T6:U808"><span class="var type1" id="S90T6U1158">dist2</span>           = <span class="mxinfo " id="T6:U810">norm(<span class="mxinfo " id="T7:U811"><span class="var type1" id="S20T7U1162">P2</span>-<span class="mxinfo " id="T7:U813">squeeze(<span class="mxinfo " id="T17:U814"><span class="var type1" id="S34T14U1166">tpp</span>(<span class="var type1" id="S85T6U1167">l</span>,<span class="mxinfo " id="T9:U817">2</span>,<span class="mxinfo " id="T8:U818">:</span>)</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T16:U819"><span class="var type1" id="S85T6U1176">l</span> == <span class="var type1" id="S30T6U1177">cnt</span></span>) &amp;&amp; (<span class="mxinfo " id="T16:U822"><span class="var type1" id="S89T6U1180">f2</span> ~= <span class="mxinfo " id="T6:U824">-<span class="mxinfo " id="T6:U825">1</span></span></span>) &amp;&amp; (<span class="mxinfo " id="T16:U826"><span class="var type1" id="S90T6U1185">dist2</span> &gt; <span class="mxinfo " id="T6:U828">0.005</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line">        fprintf(<span class="string">'      Error: Cannot be last penetration! \n'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line">        <span class="mxinfo " id="T6:U829"><span class="var type1" id="S25T6U1193">msk</span>         = <span class="mxinfo " id="T6:U831">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line">        <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197">197</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198">198</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T16:U832"><span class="var type1" id="S89T6U1200">f2</span> ~= <span class="mxinfo " id="T6:U834">-<span class="mxinfo " id="T6:U835">1</span></span></span>) <span class="comment">% output penetration point also belongs to another block</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199">199</a></span><span class="line">		<span class="mxinfo " id="T6:U836"><span class="var type1" id="S92T6U1205">fe</span>          = <span class="mxinfo " id="T6:U838">1</span></span>; <span class="comment">% -&gt; to be used in next loop execution</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200">200</a></span><span class="line">	<span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201">201</a></span><span class="line">		<span class="mxinfo " id="T6:U839"><span class="var type1" id="S92T6U1210">fe</span>          = <span class="mxinfo " id="T6:U841">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,202" id="srcline202">202</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,203" id="srcline203">203</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,204" id="srcline204">204</a></span><span class="line">    <span class="mxinfo " id="T6:U842"><span class="var type1" id="S90T6U1214">dist2</span>           = <span class="mxinfo " id="T6:U844">norm(<span class="mxinfo " id="T7:U845"><span class="var type1" id="S19T7U1218">P1</span>-<span class="mxinfo " id="T7:U847">squeeze(<span class="mxinfo " id="T17:U848"><span class="var type1" id="S34T14U1222">tpp</span>(<span class="var type1" id="S85T6U1223">l</span>,<span class="mxinfo " id="T9:U851">2</span>,<span class="mxinfo " id="T8:U852">:</span>)</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205">205</a></span><span class="line">	<span class="mxinfo " id="T6:U853"><span class="var type1" id="S93T6U1228">dp</span>              = <span class="mxinfo " id="T6:U855">abs(<span class="mxinfo " id="T6:U856"><span class="mxinfo " id="T6:U857"><span class="var type1" id="S36T4U1233">dist</span>(<span class="var type1" id="S85T6U1234">l</span>)</span>-<span class="var type1" id="S90T6U1235">dist2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206">206</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207">207</a></span><span class="line">	<span class="keyword">if</span> (<span class="mxinfo " id="T16:U861"><span class="var type1" id="S85T6U1241">l</span> == <span class="mxinfo " id="T6:U863">1</span></span>) &amp;&amp; (<span class="mxinfo " id="T16:U864"><span class="var type1" id="S86T6U1245">f1</span> ~= <span class="mxinfo " id="T6:U866">-<span class="mxinfo " id="T6:U867">1</span></span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208">208</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T16:U868"><span class="mxinfo " id="T6:U869">real(<span class="mxinfo " id="T13:U870"><span class="var type1" id="S5T37U1255">eta</span>(<span class="mxinfo " id="T6:U872"><span class="var type1" id="S35T15U1257">tff</span>(<span class="var type1" id="S85T6U1258">l</span>,<span class="mxinfo " id="T9:U875">1</span>,<span class="mxinfo " id="T9:U876">1</span>)</span>)</span>)</span> == <span class="mxinfo " id="T6:U877">real(<span class="mxinfo " id="T13:U878"><span class="var type1" id="S5T37U1264">eta</span>(<span class="var type1" id="S86T6U1265">f1</span>)</span>)</span></span>) </span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209">209</a></span><span class="line">            <span class="mxinfo " id="T6:U881"><span class="var type1" id="S25T6U1268">msk</span>     = <span class="mxinfo " id="T6:U883">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210">210</a></span><span class="line">            <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,211" id="srcline211">211</a></span><span class="line">        <span class="keyword">else</span> <span class="comment">% flag(1) to distinguish different possibilities when f1 ~= -1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,212" id="srcline212">212</a></span><span class="line">			<span class="mxinfo " id="T6:U884"><span class="mxinfo " id="T6:U885"><span class="var type1" id="S65T12U1275">flag</span>(<span class="mxinfo " id="T6:U887">1</span>)</span> = <span class="mxinfo " id="T6:U888">1</span></span>; <span class="comment">% -&gt; 1st penetration point is P1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,213" id="srcline213">213</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,214" id="srcline214">214</a></span><span class="line">	<span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,215" id="srcline215">215</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T16:U889"><span class="var type1" id="S85T6U1284">l</span> &gt; <span class="mxinfo " id="T6:U891">1</span></span>) &amp;&amp; (<span class="mxinfo " id="T16:U892"><span class="var type1" id="S86T6U1288">f1</span> ~= <span class="mxinfo " id="T6:U894">-<span class="mxinfo " id="T6:U895">1</span></span></span>) &amp;&amp; (<span class="mxinfo " id="T16:U896"><span class="var type1" id="S92T6U1293">fe</span> == <span class="mxinfo " id="T6:U898">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,216" id="srcline216">216</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T16:U899"><span class="mxinfo " id="T6:U900">real(<span class="mxinfo " id="T13:U901"><span class="var type1" id="S5T37U1302">eta</span>(<span class="mxinfo " id="T6:U903"><span class="var type1" id="S35T15U1304">tff</span>(<span class="var type1" id="S85T6U1305">l</span>,<span class="mxinfo " id="T9:U906">1</span>,<span class="mxinfo " id="T9:U907">1</span>)</span>)</span>)</span> == <span class="mxinfo " id="T6:U908">real(<span class="mxinfo " id="T13:U909"><span class="var type1" id="S5T37U1311">eta</span>(<span class="var type1" id="S86T6U1312">f1</span>)</span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,217" id="srcline217">217</a></span><span class="line">            <span class="mxinfo " id="T6:U912"><span class="mxinfo " id="T6:U913"><span class="var type1" id="S65T12U1316">flag</span>(<span class="mxinfo " id="T6:U915">1</span>)</span> = <span class="mxinfo " id="T6:U916">2</span></span>; <span class="comment">% input penetration point is an output penetration point of a previous penetration in the same path - same epsilon</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,218" id="srcline218">218</a></span><span class="line">		<span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,219" id="srcline219">219</a></span><span class="line">			<span class="mxinfo " id="T6:U917"><span class="mxinfo " id="T6:U918"><span class="var type1" id="S65T12U1323">flag</span>(<span class="mxinfo " id="T6:U920">1</span>)</span> = <span class="mxinfo " id="T6:U921">3</span></span>; <span class="comment">% as above but different epsilon</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,220" id="srcline220">220</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,221" id="srcline221">221</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,222" id="srcline222">222</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223">223</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224">224</a></span><span class="line">    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,225" id="srcline225">225</a></span><span class="line">    <span class="mxinfo " id="T7:U922"><span class="var type1" id="S95T7U1328">si</span>              = <span class="var type1" id="S29T7U1329">sdp</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,226" id="srcline226">226</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,227" id="srcline227">227</a></span><span class="line">    <span class="mxinfo " id="T7:U925"><span class="mxinfo " id="T7:U926"><span class="var type1" id="S66T7U1333">vnfaces_re</span>(<span class="mxinfo " id="T8:U928">:</span>,<span class="mxinfo " id="T9:U929">1</span>)</span> = <span class="mxinfo " id="T17:U930"><span class="var type1" id="S8T18U1337">vnfaces</span>(<span class="mxinfo " id="T6:U932"><span class="var type1" id="S35T15U1339">tff</span>(<span class="var type1" id="S85T6U1340">l</span>,<span class="mxinfo " id="T9:U935">1</span>,<span class="mxinfo " id="T9:U936">1</span>)</span>,<span class="mxinfo " id="T6:U937"><span class="var type1" id="S35T15U1344">tff</span>(<span class="var type1" id="S85T6U1345">l</span>,<span class="mxinfo " id="T9:U940">1</span>,<span class="mxinfo " id="T9:U941">2</span>)</span>,<span class="mxinfo " id="T8:U942">:</span>)</span></span>; <span class="comment">% (OR): vector normal to 1st face of block</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,228" id="srcline228">228</a></span><span class="line">    <span class="mxinfo " id="T7:U943"><span class="var type1" id="S96T7U1351">et</span>              = <span class="mxinfo " id="T7:U945">cross(<span class="var type1" id="S95T7U1354">si</span>,<span class="var type1" id="S66T7U1355">vnfaces_re</span>)</span></span>;             <span class="comment">% (OR): perpendicular vector of the incident wave</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,229" id="srcline229">229</a></span><span class="line">    <span class="mxinfo " id="T13:U948"><span class="var type1" id="S98T13U1358">sti2</span>            = <span class="mxinfo " id="T13:U950">complex(<span class="mxinfo " id="T6:U951"><span class="mxinfo " id="T6:U952">norm(<span class="var type1" id="S96T7U1364">et</span>)</span>^2</span>,<span class="mxinfo " id="T6:U954">0</span>)</span></span>;            <span class="comment">% (OR): sine square of the incident angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,230" id="srcline230">230</a></span><span class="line">    <span class="mxinfo " id="T13:U955"><span class="var type1" id="S99T13U1369">cti</span>             = <span class="mxinfo " id="T13:U957">complex(<span class="mxinfo " id="T6:U958">sqrt(<span class="mxinfo " id="T6:U959"><span class="mxinfo " id="T6:U960">1</span>-<span class="mxinfo " id="T6:U961">real(<span class="var type1" id="S98T13U1378">sti2</span>)</span></span>)</span>,<span class="mxinfo " id="T6:U963">0</span>)</span></span>;    <span class="comment">% (OR): cosine of the incident angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,231" id="srcline231">231</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,232" id="srcline232">232</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T16:U964"><span class="mxinfo " id="T6:U965"><span class="var type1" id="S65T12U1386">flag</span>(<span class="mxinfo " id="T9:U967">1</span>)</span> == <span class="mxinfo " id="T6:U968">0</span></span>) || (<span class="mxinfo " id="T16:U969"><span class="mxinfo " id="T6:U970"><span class="var type1" id="S65T12U1392">flag</span>(<span class="mxinfo " id="T9:U972">1</span>)</span> == <span class="mxinfo " id="T6:U973">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,233" id="srcline233">233</a></span><span class="line">        <span class="mxinfo " id="T13:U974"><span class="var type1" id="S101T13U1397">teps</span>        = <span class="mxinfo " id="T13:U976"><span class="var type1" id="S5T37U1399">eta</span>(<span class="mxinfo " id="T6:U978"><span class="var type1" id="S35T15U1401">tff</span>(<span class="var type1" id="S85T6U1402">l</span>,<span class="mxinfo " id="T9:U981">1</span>,<span class="mxinfo " id="T9:U982">1</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,234" id="srcline234">234</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,235" id="srcline235">235</a></span><span class="line">        <span class="mxinfo " id="T13:U983"><span class="var type1" id="S101T13U1408">teps</span>        = <span class="mxinfo " id="T13:U985"><span class="mxinfo " id="T13:U986"><span class="var type1" id="S5T37U1411">eta</span>(<span class="mxinfo " id="T6:U988"><span class="var type1" id="S35T15U1413">tff</span>(<span class="var type1" id="S85T6U1414">l</span>,<span class="mxinfo " id="T9:U991">1</span>,<span class="mxinfo " id="T9:U992">1</span>)</span>)</span>/<span class="mxinfo " id="T13:U993"><span class="var type1" id="S5T37U1418">eta</span>(<span class="var type1" id="S86T6U1419">f1</span>)</span></span></span>; <span class="comment">% (OR): no square root (-&gt; modified on 19.02.2017)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,236" id="srcline236">236</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,237" id="srcline237">237</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,238" id="srcline238">238</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T16:U996"><span class="mxinfo " id="T6:U997">norm(<span class="var type1" id="S96T7U1426">et</span>)</span> &gt; <span class="mxinfo " id="T6:U999">real(<span class="var type1" id="S101T13U1429">teps</span>)</span></span>) <span class="comment">% total internal reflection</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,239" id="srcline239">239</a></span><span class="line">        <span class="mxinfo " id="T6:U1001"><span class="var type1" id="S25T6U1432">msk</span>         = <span class="mxinfo " id="T6:U1003">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,240" id="srcline240">240</a></span><span class="line">        <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,241" id="srcline241">241</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,242" id="srcline242">242</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,243" id="srcline243">243</a></span><span class="line">    [<span class="var type1" id="S12T7U1438">eti</span>,<span class="var type1" id="S10T7U1439">ehi</span>]       = <span class="fcn" id="F338N5:B1441">cart2rayfixed</span>(<span class="var type1" id="S95T7U1442">si</span>); <span class="comment">% (OR): eti -&gt; unitary parallel vector (incident field) --- 1st interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,244" id="srcline244">244</a></span><span class="line">                                         <span class="comment">%       ehi -&gt; unitary perpendicular vector (incident field) --- 1st interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,245" id="srcline245">245</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,246" id="srcline246">246</a></span><span class="line">    <span class="mxinfo " id="T13:U1007"><span class="var type1" id="S103T13U1445">eoe</span>             = <span class="mxinfo " id="T13:U1009">1/<span class="var type1" id="S101T13U1448">teps</span></span></span>; <span class="comment">% (OR): no square root (-&gt; modified on 19.02.2017)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,247" id="srcline247">247</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,248" id="srcline248">248</a></span><span class="line">    <span class="mxinfo " id="T6:U1011"><span class="var type1" id="S104T6U1451">ksi</span>             = <span class="mxinfo " id="T6:U1013">real(<span class="var type1" id="S103T13U1454">eoe</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,249" id="srcline249">249</a></span><span class="line">    <span class="mxinfo " id="T6:U1015"><span class="var type1" id="S105T6U1457">kn</span>              = <span class="mxinfo " id="T6:U1017">(<span class="mxinfo " id="T6:U1018"><span class="var type1" id="S104T6U1461">ksi</span>*<span class="mxinfo " id="T6:U1020">real(<span class="var type1" id="S99T13U1464">cti</span>)</span></span>)-<span class="mxinfo " id="T6:U1022">sqrt(<span class="mxinfo " id="T6:U1023"><span class="mxinfo " id="T6:U1024">1</span>-<span class="mxinfo " id="T6:U1025"><span class="mxinfo " id="T6:U1026"><span class="var type1" id="S104T6U1471">ksi</span>^2</span>*(<span class="mxinfo " id="T6:U1028"><span class="mxinfo " id="T6:U1029">1</span>-<span class="mxinfo " id="T6:U1030"><span class="mxinfo " id="T6:U1031">real(<span class="var type1" id="S99T13U1479">cti</span>)</span>^2</span></span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,250" id="srcline250">250</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,251" id="srcline251">251</a></span><span class="line">    <span class="mxinfo " id="T7:U1033"><span class="var type1" id="S106T7U1483">st</span>              = <span class="mxinfo " id="T7:U1035">(<span class="mxinfo " id="T7:U1036"><span class="var type1" id="S104T6U1487">ksi</span>*<span class="var type1" id="S95T7U1488">si</span></span>)+(<span class="mxinfo " id="T7:U1039"><span class="var type1" id="S105T6U1491">kn</span>*<span class="var type1" id="S66T7U1492">vnfaces_re</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,252" id="srcline252">252</a></span><span class="line">    <span class="mxinfo " id="T7:U1042"><span class="var type1" id="S106T7U1495">st</span>              = <span class="mxinfo " id="T7:U1044"><span class="var type1" id="S106T7U1497">st</span>/<span class="mxinfo " id="T6:U1046">norm(<span class="var type1" id="S106T7U1500">st</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,253" id="srcline253">253</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,254" id="srcline254">254</a></span><span class="line">    [<span class="var type1" id="S13T7U1504">ett</span>,<span class="var type1" id="S14T7U1505">eht</span>]       = <span class="fcn" id="F338N5:B1507">cart2rayfixed</span>(<span class="var type1" id="S106T7U1508">st</span>); <span class="comment">% (OR): ett -&gt; unitary parallel vector (transmission field) --- 1st interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,255" id="srcline255">255</a></span><span class="line">                                         <span class="comment">%       eht -&gt; unitary perpendicular vector (transmission field) --- 1st interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,256" id="srcline256">256</a></span><span class="line">    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,257" id="srcline257">257</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,258" id="srcline258">258</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,259" id="srcline259">259</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T16:U1051"><span class="var type1" id="S89T6U1514">f2</span> ~= <span class="mxinfo " id="T6:U1053">-<span class="mxinfo " id="T6:U1054">1</span></span></span>) &amp;&amp; (<span class="mxinfo " id="T16:U1055"><span class="var type1" id="S85T6U1519">l</span> == <span class="var type1" id="S30T6U1520">cnt</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,260" id="srcline260">260</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T16:U1058"><span class="mxinfo " id="T6:U1059">real(<span class="mxinfo " id="T13:U1060"><span class="var type1" id="S5T37U1528">eta</span>(<span class="mxinfo " id="T6:U1062"><span class="var type1" id="S35T15U1530">tff</span>(<span class="var type1" id="S85T6U1531">l</span>,<span class="mxinfo " id="T9:U1065">2</span>,<span class="mxinfo " id="T9:U1066">1</span>)</span>)</span>)</span> == <span class="mxinfo " id="T6:U1067">real(<span class="mxinfo " id="T13:U1068"><span class="var type1" id="S5T37U1537">eta</span>(<span class="var type1" id="S89T6U1538">f2</span>)</span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,261" id="srcline261">261</a></span><span class="line">            <span class="mxinfo " id="T6:U1071"><span class="var type1" id="S25T6U1541">msk</span>     = <span class="mxinfo " id="T6:U1073">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,262" id="srcline262">262</a></span><span class="line">            <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,263" id="srcline263">263</a></span><span class="line">        <span class="keyword">else</span> <span class="comment">% flag(2) to distinguish different possibilities when f2 ~= -1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,264" id="srcline264">264</a></span><span class="line">            <span class="mxinfo " id="T6:U1074"><span class="mxinfo " id="T6:U1075"><span class="var type1" id="S65T12U1548">flag</span>(<span class="mxinfo " id="T6:U1077">2</span>)</span> = <span class="mxinfo " id="T6:U1078">4</span></span>; <span class="comment">% -&gt; 2nd penetration point is P2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,265" id="srcline265">265</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,266" id="srcline266">266</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,267" id="srcline267">267</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T16:U1079"><span class="var type1" id="S89T6U1557">f2</span> ~= <span class="mxinfo " id="T6:U1081">-<span class="mxinfo " id="T6:U1082">1</span></span></span>) &amp;&amp; (<span class="mxinfo " id="T16:U1083"><span class="var type1" id="S85T6U1562">l</span> &gt; <span class="mxinfo " id="T6:U1085">1</span></span>) &amp;&amp; (<span class="mxinfo " id="T16:U1086"><span class="var type1" id="S85T6U1566">l</span> ~= <span class="var type1" id="S30T6U1567">cnt</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,268" id="srcline268">268</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T16:U1089"><span class="mxinfo " id="T6:U1090">real(<span class="mxinfo " id="T13:U1091"><span class="var type1" id="S5T37U1575">eta</span>(<span class="mxinfo " id="T6:U1093"><span class="var type1" id="S35T15U1577">tff</span>(<span class="var type1" id="S85T6U1578">l</span>,<span class="mxinfo " id="T9:U1096">2</span>,<span class="mxinfo " id="T9:U1097">1</span>)</span>)</span>)</span> == <span class="mxinfo " id="T6:U1098">real(<span class="mxinfo " id="T13:U1099"><span class="var type1" id="S5T37U1584">eta</span>(<span class="var type1" id="S89T6U1585">f2</span>)</span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,269" id="srcline269">269</a></span><span class="line">            <span class="mxinfo " id="T6:U1102"><span class="mxinfo " id="T6:U1103"><span class="var type1" id="S65T12U1589">flag</span>(<span class="mxinfo " id="T6:U1105">2</span>)</span> = <span class="mxinfo " id="T6:U1106">5</span></span>; <span class="comment">% output penetration point is an input penetration point of a following penetration in the same path - same epsilon</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,270" id="srcline270">270</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,271" id="srcline271">271</a></span><span class="line">            <span class="mxinfo " id="T6:U1107"><span class="mxinfo " id="T6:U1108"><span class="var type1" id="S65T12U1596">flag</span>(<span class="mxinfo " id="T6:U1110">2</span>)</span> = <span class="mxinfo " id="T6:U1111">6</span></span>; <span class="comment">% as above but different epsilon</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,272" id="srcline272">272</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,273" id="srcline273">273</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,274" id="srcline274">274</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,275" id="srcline275">275</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,276" id="srcline276">276</a></span><span class="line">    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,277" id="srcline277">277</a></span><span class="line">    <span class="mxinfo " id="T7:U1112"><span class="mxinfo " id="T7:U1113"><span class="var type1" id="S67T7U1602">tp</span>(<span class="mxinfo " id="T8:U1115">:</span>,<span class="mxinfo " id="T9:U1116">1</span>)</span>         = <span class="mxinfo " id="T17:U1117">-<span class="mxinfo " id="T17:U1118"><span class="var type1" id="S8T18U1607">vnfaces</span>(<span class="mxinfo " id="T6:U1120"><span class="var type1" id="S35T15U1609">tff</span>(<span class="var type1" id="S85T6U1610">l</span>,<span class="mxinfo " id="T9:U1123">2</span>,<span class="mxinfo " id="T9:U1124">1</span>)</span>,<span class="mxinfo " id="T6:U1125"><span class="var type1" id="S35T15U1614">tff</span>(<span class="var type1" id="S85T6U1615">l</span>,<span class="mxinfo " id="T9:U1128">2</span>,<span class="mxinfo " id="T9:U1129">2</span>)</span>,<span class="mxinfo " id="T8:U1130">:</span>)</span></span></span>; <span class="comment">% (OR): vector normal to 2nd face of block</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,278" id="srcline278">278</a></span><span class="line">	<span class="mxinfo " id="T7:U1131"><span class="var type1" id="S96T7U1621">et</span>              = <span class="mxinfo " id="T7:U1133">cross(<span class="var type1" id="S106T7U1624">st</span>,<span class="var type1" id="S67T7U1625">tp</span>)</span></span>;                      <span class="comment">% (OR): perpendicular vector of the penetrated wave</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,279" id="srcline279">279</a></span><span class="line">	<span class="mxinfo " id="T13:U1136"><span class="var type1" id="S107T13U1628">str2</span>            = <span class="mxinfo " id="T13:U1138">complex(<span class="mxinfo " id="T6:U1139"><span class="mxinfo " id="T6:U1140">norm(<span class="var type1" id="S96T7U1634">et</span>)</span>^2</span>,<span class="mxinfo " id="T6:U1142">0</span>)</span></span>;             <span class="comment">% (OR): sine square of the penetrated angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,280" id="srcline280">280</a></span><span class="line">	<span class="mxinfo " id="T13:U1143"><span class="var type1" id="S108T13U1639">ctr</span>             = <span class="mxinfo " id="T13:U1145">sqrt(<span class="mxinfo " id="T13:U1146">complex(<span class="mxinfo " id="T6:U1147"><span class="mxinfo " id="T6:U1148">1</span>-<span class="mxinfo " id="T6:U1149">real(<span class="var type1" id="S107T13U1648">str2</span>)</span></span>)</span>)</span></span>;       <span class="comment">% (OR): cosine of the penetrated angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,281" id="srcline281">281</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,282" id="srcline282">282</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T16:U1151"><span class="mxinfo " id="T6:U1152"><span class="var type1" id="S65T12U1655">flag</span>(<span class="mxinfo " id="T9:U1154">2</span>)</span> == <span class="mxinfo " id="T6:U1155">0</span></span>) || (<span class="mxinfo " id="T16:U1156"><span class="mxinfo " id="T6:U1157"><span class="var type1" id="S65T12U1661">flag</span>(<span class="mxinfo " id="T9:U1159">2</span>)</span> == <span class="mxinfo " id="T6:U1160">4</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,283" id="srcline283">283</a></span><span class="line">        <span class="mxinfo " id="T13:U1161"><span class="var type1" id="S101T13U1666">teps</span>        = <span class="mxinfo " id="T13:U1163">1/<span class="mxinfo " id="T13:U1164"><span class="var type1" id="S5T37U1670">eta</span>(<span class="mxinfo " id="T6:U1166"><span class="var type1" id="S35T15U1672">tff</span>(<span class="var type1" id="S85T6U1673">l</span>,<span class="mxinfo " id="T9:U1169">2</span>,<span class="mxinfo " id="T9:U1170">1</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,284" id="srcline284">284</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,285" id="srcline285">285</a></span><span class="line">        <span class="mxinfo " id="T13:U1171"><span class="var type1" id="S101T13U1679">teps</span>        = <span class="mxinfo " id="T13:U1173"><span class="mxinfo " id="T13:U1174"><span class="var type1" id="S5T37U1682">eta</span>(<span class="var type1" id="S89T6U1683">f2</span>)</span>/<span class="mxinfo " id="T13:U1177"><span class="var type1" id="S5T37U1685">eta</span>(<span class="mxinfo " id="T6:U1179"><span class="var type1" id="S35T15U1687">tff</span>(<span class="var type1" id="S85T6U1688">l</span>,<span class="mxinfo " id="T9:U1182">2</span>,<span class="mxinfo " id="T9:U1183">1</span>)</span>)</span></span></span>; <span class="comment">% (OR): no square root (-&gt; modified on 19.02.2017)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,286" id="srcline286">286</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,287" id="srcline287">287</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,288" id="srcline288">288</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T16:U1184"><span class="mxinfo " id="T6:U1185">norm(<span class="var type1" id="S96T7U1697">et</span>)</span> &gt; <span class="mxinfo " id="T6:U1187">real(<span class="var type1" id="S101T13U1700">teps</span>)</span></span>) <span class="comment">% total internal reflection</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,289" id="srcline289">289</a></span><span class="line">        <span class="mxinfo " id="T6:U1189"><span class="var type1" id="S25T6U1703">msk</span> = <span class="mxinfo " id="T6:U1191">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,290" id="srcline290">290</a></span><span class="line">        <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,291" id="srcline291">291</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,292" id="srcline292">292</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,293" id="srcline293">293</a></span><span class="line">    <span class="mxinfo " id="T7:U1192"><span class="var type1" id="S109T7U1708">sr</span>              = <span class="var type1" id="S106T7U1709">st</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,294" id="srcline294">294</a></span><span class="line">    [<span class="var type1" id="S17T7U1713">etr</span>,<span class="var type1" id="S18T7U1714">ehr</span>]       = <span class="fcn" id="F338N5:B1716">cart2rayfixed</span>(<span class="var type1" id="S109T7U1717">sr</span>); <span class="comment">% (OR): etr -&gt; unitary parallel vector (incident field) --- 2nd interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,295" id="srcline295">295</a></span><span class="line">                                         <span class="comment">%       ehr -&gt; unitary perpendicular vector (incident field) --- 2nd interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,296" id="srcline296">296</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,297" id="srcline297">297</a></span><span class="line">    <span class="mxinfo " id="T13:U1198"><span class="var type1" id="S103T13U1720">eoe</span>             = <span class="mxinfo " id="T13:U1200">1/<span class="var type1" id="S101T13U1723">teps</span></span></span>; <span class="comment">% (OR): no square root (-&gt; modified on 19.02.2017)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,298" id="srcline298">298</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,299" id="srcline299">299</a></span><span class="line">    <span class="mxinfo " id="T6:U1202"><span class="var type1" id="S104T6U1726">ksi</span>             = <span class="mxinfo " id="T6:U1204">real(<span class="var type1" id="S103T13U1729">eoe</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,300" id="srcline300">300</a></span><span class="line">    <span class="mxinfo " id="T6:U1206"><span class="var type1" id="S105T6U1732">kn</span>              = <span class="mxinfo " id="T6:U1208">(<span class="mxinfo " id="T6:U1209"><span class="var type1" id="S104T6U1736">ksi</span>*<span class="mxinfo " id="T6:U1211">real(<span class="var type1" id="S108T13U1739">ctr</span>)</span></span>)-<span class="mxinfo " id="T6:U1213">sqrt(<span class="mxinfo " id="T6:U1214"><span class="mxinfo " id="T6:U1215">1</span>-<span class="mxinfo " id="T6:U1216"><span class="mxinfo " id="T6:U1217"><span class="var type1" id="S104T6U1746">ksi</span>^2</span>*(<span class="mxinfo " id="T6:U1219"><span class="mxinfo " id="T6:U1220">1</span>-<span class="mxinfo " id="T6:U1221"><span class="mxinfo " id="T6:U1222">real(<span class="var type1" id="S108T13U1754">ctr</span>)</span>^2</span></span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,301" id="srcline301">301</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,302" id="srcline302">302</a></span><span class="line">    <span class="mxinfo " id="T7:U1224"><span class="var type1" id="S110T7U1758">so</span>              = <span class="mxinfo " id="T7:U1226">(<span class="mxinfo " id="T7:U1227"><span class="var type1" id="S104T6U1762">ksi</span>*<span class="var type1" id="S109T7U1763">sr</span></span>)+(<span class="mxinfo " id="T7:U1230"><span class="var type1" id="S105T6U1766">kn</span>*<span class="var type1" id="S66T7U1767">vnfaces_re</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,303" id="srcline303">303</a></span><span class="line">    <span class="mxinfo " id="T7:U1233"><span class="var type1" id="S110T7U1770">so</span>              = <span class="mxinfo " id="T7:U1235"><span class="var type1" id="S110T7U1772">so</span>/<span class="mxinfo " id="T6:U1237">norm(<span class="var type1" id="S110T7U1775">so</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,304" id="srcline304">304</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,305" id="srcline305">305</a></span><span class="line">    [<span class="var type1" id="S16T7U1779">eto</span>,<span class="var type1" id="S15T7U1780">eho</span>]       = <span class="fcn" id="F338N5:B1782">cart2rayfixed</span>(<span class="var type1" id="S110T7U1783">so</span>); <span class="comment">% (OR): ett -&gt; unitary parallel vector (transmission field) --- 2nd interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,306" id="srcline306">306</a></span><span class="line">                                         <span class="comment">%       eht -&gt; unitary perpendicular vector (transmission field) --- 2nd interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,307" id="srcline307">307</a></span><span class="line">    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,308" id="srcline308">308</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,309" id="srcline309">309</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,310" id="srcline310">310</a></span><span class="line">    <span class="keyword">if</span> (<span class="mxinfo " id="T16:U1242"><span class="var type1" id="S25T6U1788">msk</span> ~= <span class="mxinfo " id="T6:U1244">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,311" id="srcline311">311</a></span><span class="line">		<span class="mxinfo " id="T13:U1245"><span class="var type1" id="S111T13U1792">sqreta</span>         = <span class="mxinfo " id="T13:U1247">sqrt(<span class="mxinfo " id="T13:U1248"><span class="var type1" id="S5T37U1796">eta</span>(<span class="mxinfo " id="T6:U1250"><span class="var type1" id="S35T15U1798">tff</span>(<span class="var type1" id="S85T6U1799">l</span>,<span class="mxinfo " id="T9:U1253">1</span>,<span class="mxinfo " id="T9:U1254">1</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,312" id="srcline312">312</a></span><span class="line"><span class="comment">% 		sqrem1         = uno-sqreta; % (OR): no "1-[<span class="keyword">...</span><span class="comment">]" (-&gt; modified on 28.09.2017)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,313" id="srcline313">313</a></span><span class="line">		<span class="mxinfo " id="T13:U1255"><span class="var type1" id="S112T13U1804">sqrem1</span>         = <span class="mxinfo " id="T13:U1257">-<span class="var type1" id="S111T13U1806">sqreta</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,314" id="srcline314">314</a></span><span class="line">		<span class="mxinfo " id="T13:U1259"><span class="var type1" id="S113T13U1809">kdp</span>            = <span class="mxinfo " id="T13:U1261">complex(<span class="mxinfo " id="T6:U1262">0</span>,<span class="mxinfo " id="T6:U1263"><span class="var type1" id="S6T6U1814">K</span>*<span class="var type1" id="S93T6U1815">dp</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,315" id="srcline315">315</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,316" id="srcline316">316</a></span><span class="line">        <span class="mxinfo " id="T6:U1266"><span class="mxinfo " id="T6:U1267"><span class="var type1" id="S68T4U1819">mnbpen</span>(<span class="var type1" id="S85T6U1820">l</span>,<span class="mxinfo " id="T9:U1270">:</span>)</span>    = <span class="mxinfo " id="T6:U1271"><span class="var type1" id="S35T15U1823">tff</span>(<span class="var type1" id="S85T6U1824">l</span>,<span class="mxinfo " id="T6:U1274">1</span>,<span class="mxinfo " id="T6:U1275">1</span>)</span></span>; <span class="comment">% block number</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,317" id="srcline317">317</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,318" id="srcline318">318</a></span><span class="line">        <span class="mxinfo " id="T26:U1276"><span class="mxinfo " id="T26:U1277"><span class="var type1" id="S69T34U1830">mpflag</span>(<span class="var type1" id="S85T6U1831">l</span>,<span class="mxinfo " id="T29:U1280">:</span>)</span>    = <span class="mxinfo " id="T12:U1281"><span class="var type1" id="S65T12U1834">flag</span>(<span class="mxinfo " id="T26:U1283"><span class="mxinfo " id="T6:U1284">1</span>:<span class="mxinfo " id="T6:U1285">2</span></span>)</span></span>; <span class="comment">% vector flag</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,319" id="srcline319">319</a></span><span class="line">        <span class="mxinfo " id="T13:U1286"><span class="mxinfo " id="T13:U1287"><span class="var type1" id="S70T35U1841">mploss</span>(<span class="var type1" id="S85T6U1842">l</span>,<span class="mxinfo " id="T9:U1290">:</span>)</span>    = <span class="mxinfo " id="T13:U1291">exp(<span class="mxinfo " id="T13:U1292"><span class="var type1" id="S113T13U1847">kdp</span>*<span class="var type1" id="S112T13U1848">sqrem1</span></span>)</span></span>; <span class="comment">% penetration loss</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,320" id="srcline320">320</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,321" id="srcline321">321</a></span><span class="line">        <span class="mxinfo " id="T6:U1295"><span class="mxinfo " id="T6:U1296"><span class="var type1" id="S71T4U1852">mpd</span>(<span class="var type1" id="S85T6U1853">l</span>,<span class="mxinfo " id="T9:U1299">:</span>)</span>       = <span class="var type1" id="S93T6U1855">dp</span></span>; <span class="comment">% length of the penetration path</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,322" id="srcline322">322</a></span><span class="line">        <span class="mxinfo " id="T6:U1301"><span class="mxinfo " id="T6:U1302"><span class="var type1" id="S72T4U1859">mepd</span>(<span class="var type1" id="S85T6U1860">l</span>,<span class="mxinfo " id="T9:U1305">:</span>)</span>      = <span class="mxinfo " id="T6:U1306"><span class="var type1" id="S93T6U1863">dp</span>*<span class="mxinfo " id="T6:U1308">sqrt(<span class="mxinfo " id="T6:U1309">real(<span class="mxinfo " id="T13:U1310"><span class="var type1" id="S5T37U1869">eta</span>(<span class="mxinfo " id="T6:U1312"><span class="var type1" id="S35T15U1871">tff</span>(<span class="var type1" id="S85T6U1872">l</span>,<span class="mxinfo " id="T9:U1315">1</span>,<span class="mxinfo " id="T9:U1316">1</span>)</span>)</span>)</span>)</span></span></span>; <span class="comment">% effective length of the penetration path</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,323" id="srcline323">323</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,324" id="srcline324">324</a></span><span class="line">        <span class="mxinfo " id="T38:U1317"><span class="mxinfo " id="T38:U1318"><span class="var type1" id="S73T2U1878">msti</span>(<span class="var type1" id="S85T6U1879">l</span>,<span class="mxinfo " id="T8:U1321">:</span>)</span>      = <span class="var type1" id="S12T7U1881">eti</span></span>; <span class="comment">% perpendicular and parallel polarization vectors at each interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,325" id="srcline325">325</a></span><span class="line">        <span class="mxinfo " id="T38:U1323"><span class="mxinfo " id="T38:U1324"><span class="var type1" id="S74T2U1885">mstt</span>(<span class="var type1" id="S85T6U1886">l</span>,<span class="mxinfo " id="T8:U1327">:</span>)</span>      = <span class="var type1" id="S13T7U1888">ett</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,326" id="srcline326">326</a></span><span class="line">        <span class="mxinfo " id="T38:U1329"><span class="mxinfo " id="T38:U1330"><span class="var type1" id="S75T2U1892">mshi</span>(<span class="var type1" id="S85T6U1893">l</span>,<span class="mxinfo " id="T8:U1333">:</span>)</span>      = <span class="var type1" id="S10T7U1895">ehi</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,327" id="srcline327">327</a></span><span class="line">        <span class="mxinfo " id="T38:U1335"><span class="mxinfo " id="T38:U1336"><span class="var type1" id="S76T2U1899">msht</span>(<span class="var type1" id="S85T6U1900">l</span>,<span class="mxinfo " id="T8:U1339">:</span>)</span>      = <span class="var type1" id="S14T7U1902">eht</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,328" id="srcline328">328</a></span><span class="line">        <span class="mxinfo " id="T38:U1341"><span class="mxinfo " id="T38:U1342"><span class="var type1" id="S77T2U1906">mstr</span>(<span class="var type1" id="S85T6U1907">l</span>,<span class="mxinfo " id="T8:U1345">:</span>)</span>      = <span class="var type1" id="S17T7U1909">etr</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,329" id="srcline329">329</a></span><span class="line">        <span class="mxinfo " id="T38:U1347"><span class="mxinfo " id="T38:U1348"><span class="var type1" id="S78T2U1913">msto</span>(<span class="var type1" id="S85T6U1914">l</span>,<span class="mxinfo " id="T8:U1351">:</span>)</span>      = <span class="var type1" id="S16T7U1916">eto</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,330" id="srcline330">330</a></span><span class="line">        <span class="mxinfo " id="T38:U1353"><span class="mxinfo " id="T38:U1354"><span class="var type1" id="S79T2U1920">mshr</span>(<span class="var type1" id="S85T6U1921">l</span>,<span class="mxinfo " id="T8:U1357">:</span>)</span>      = <span class="var type1" id="S18T7U1923">ehr</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,331" id="srcline331">331</a></span><span class="line">  		<span class="mxinfo " id="T38:U1359"><span class="mxinfo " id="T38:U1360"><span class="var type1" id="S80T2U1927">msho</span>(<span class="var type1" id="S85T6U1928">l</span>,<span class="mxinfo " id="T8:U1363">:</span>)</span>      = <span class="var type1" id="S15T7U1930">eho</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,332" id="srcline332">332</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,333" id="srcline333">333</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T16:U1365"><span class="mxinfo " id="T6:U1366"><span class="var type1" id="S65T12U1936">flag</span>(<span class="mxinfo " id="T9:U1368">1</span>)</span> == <span class="mxinfo " id="T6:U1369">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,334" id="srcline334">334</a></span><span class="line">            <span class="mxinfo " id="T13:U1370"><span class="mxinfo " id="T13:U1371"><span class="var type1" id="S81T35U1942">mTti</span>(<span class="var type1" id="S85T6U1943">l</span>,<span class="mxinfo " id="T9:U1374">:</span>)</span>  = <span class="mxinfo " id="T6:U1375">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,335" id="srcline335">335</a></span><span class="line">            <span class="mxinfo " id="T13:U1376"><span class="mxinfo " id="T13:U1377"><span class="var type1" id="S82T35U1949">mThi</span>(<span class="var type1" id="S85T6U1950">l</span>,<span class="mxinfo " id="T9:U1380">:</span>)</span>  = <span class="mxinfo " id="T6:U1381">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,336" id="srcline336">336</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,337" id="srcline337">337</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T16:U1382"><span class="mxinfo " id="T6:U1383"><span class="var type1" id="S65T12U1958">flag</span>(<span class="mxinfo " id="T9:U1385">2</span>)</span> == <span class="mxinfo " id="T6:U1386">4</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,338" id="srcline338">338</a></span><span class="line">            <span class="mxinfo " id="T13:U1387"><span class="mxinfo " id="T13:U1388"><span class="var type1" id="S83T35U1964">mTtt</span>(<span class="var type1" id="S85T6U1965">l</span>,<span class="mxinfo " id="T9:U1391">:</span>)</span>  = <span class="mxinfo " id="T6:U1392">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,339" id="srcline339">339</a></span><span class="line">            <span class="mxinfo " id="T13:U1393"><span class="mxinfo " id="T13:U1394"><span class="var type1" id="S84T35U1971">mTht</span>(<span class="var type1" id="S85T6U1972">l</span>,<span class="mxinfo " id="T9:U1397">:</span>)</span>  = <span class="mxinfo " id="T6:U1398">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,340" id="srcline340">340</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,341" id="srcline341">341</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,342" id="srcline342">342</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T16:U1399"><span class="mxinfo " id="T6:U1400"><span class="var type1" id="S65T12U1981">flag</span>(<span class="mxinfo " id="T9:U1402">1</span>)</span> == <span class="mxinfo " id="T6:U1403">0</span></span>) || (<span class="mxinfo " id="T16:U1404"><span class="mxinfo " id="T6:U1405"><span class="var type1" id="S65T12U1987">flag</span>(<span class="mxinfo " id="T9:U1407">1</span>)</span> == <span class="mxinfo " id="T6:U1408">3</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,343" id="srcline343">343</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T16:U1409"><span class="mxinfo " id="T6:U1410"><span class="var type1" id="S65T12U1995">flag</span>(<span class="mxinfo " id="T9:U1412">1</span>)</span> == <span class="mxinfo " id="T6:U1413">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,344" id="srcline344">344</a></span><span class="line">                <span class="mxinfo " id="T13:U1414"><span class="var type1" id="S115T13U2000">sqes</span>   = <span class="mxinfo " id="T13:U1416">sqrt(<span class="mxinfo " id="T13:U1417"><span class="mxinfo " id="T13:U1418"><span class="var type1" id="S5T37U2005">eta</span>(<span class="mxinfo " id="T6:U1420"><span class="var type1" id="S35T15U2007">tff</span>(<span class="var type1" id="S85T6U2008">l</span>,<span class="mxinfo " id="T9:U1423">1</span>,<span class="mxinfo " id="T9:U1424">1</span>)</span>)</span>-<span class="var type1" id="S98T13U2011">sti2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,345" id="srcline345">345</a></span><span class="line">                <span class="mxinfo " id="T13:U1426"><span class="var type1" id="S116T13U2014">inveta</span> = <span class="mxinfo " id="T13:U1428">1/<span class="mxinfo " id="T13:U1429"><span class="var type1" id="S5T37U2018">eta</span>(<span class="mxinfo " id="T6:U1431"><span class="var type1" id="S35T15U2020">tff</span>(<span class="var type1" id="S85T6U2021">l</span>,<span class="mxinfo " id="T9:U1434">1</span>,<span class="mxinfo " id="T9:U1435">1</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,346" id="srcline346">346</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,347" id="srcline347">347</a></span><span class="line">                <span class="mxinfo " id="T13:U1436"><span class="var type1" id="S115T13U2027">sqes</span>   = <span class="mxinfo " id="T13:U1438">sqrt(<span class="mxinfo " id="T13:U1439"><span class="mxinfo " id="T13:U1440"><span class="mxinfo " id="T13:U1441"><span class="var type1" id="S5T37U2033">eta</span>(<span class="mxinfo " id="T6:U1443"><span class="var type1" id="S35T15U2035">tff</span>(<span class="var type1" id="S85T6U2036">l</span>,<span class="mxinfo " id="T9:U1446">1</span>,<span class="mxinfo " id="T9:U1447">1</span>)</span>)</span>/<span class="mxinfo " id="T13:U1448"><span class="var type1" id="S5T37U2040">eta</span>(<span class="var type1" id="S86T6U2041">f1</span>)</span></span>-<span class="var type1" id="S98T13U2042">sti2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,348" id="srcline348">348</a></span><span class="line">                <span class="mxinfo " id="T13:U1452"><span class="var type1" id="S116T13U2045">inveta</span> = <span class="mxinfo " id="T13:U1454"><span class="mxinfo " id="T13:U1455"><span class="var type1" id="S5T37U2048">eta</span>(<span class="var type1" id="S86T6U2049">f1</span>)</span>/<span class="mxinfo " id="T13:U1458"><span class="var type1" id="S5T37U2051">eta</span>(<span class="mxinfo " id="T6:U1460"><span class="var type1" id="S35T15U2053">tff</span>(<span class="var type1" id="S85T6U2054">l</span>,<span class="mxinfo " id="T9:U1463">1</span>,<span class="mxinfo " id="T9:U1464">1</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,349" id="srcline349">349</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,350" id="srcline350">350</a></span><span class="line">            <span class="mxinfo " id="T13:U1465"><span class="mxinfo " id="T13:U1466"><span class="var type1" id="S81T35U2060">mTti</span>(<span class="var type1" id="S85T6U2061">l</span>,<span class="mxinfo " id="T9:U1469">:</span>)</span>  = <span class="mxinfo " id="T13:U1470">(<span class="mxinfo " id="T13:U1471"><span class="mxinfo " id="T6:U1472">2</span>*<span class="var type1" id="S99T13U2067">cti</span></span>)/(<span class="mxinfo " id="T13:U1474"><span class="var type1" id="S99T13U2070">cti</span>+<span class="var type1" id="S115T13U2071">sqes</span></span>)</span></span>; <span class="comment">% parallel and perpendicular transmission coefficients at 1st interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,351" id="srcline351">351</a></span><span class="line">            <span class="mxinfo " id="T13:U1477"><span class="mxinfo " id="T13:U1478"><span class="var type1" id="S82T35U2075">mThi</span>(<span class="var type1" id="S85T6U2076">l</span>,<span class="mxinfo " id="T9:U1481">:</span>)</span>  = <span class="mxinfo " id="T13:U1482">(<span class="mxinfo " id="T13:U1483"><span class="mxinfo " id="T13:U1484"><span class="mxinfo " id="T6:U1485">2</span>*<span class="mxinfo " id="T13:U1486">sqrt(<span class="var type1" id="S116T13U2085">inveta</span>)</span></span>*<span class="var type1" id="S99T13U2086">cti</span></span>)/(<span class="mxinfo " id="T13:U1489"><span class="var type1" id="S99T13U2089">cti</span>+<span class="mxinfo " id="T13:U1491"><span class="mxinfo " id="T13:U1492">sqrt(<span class="var type1" id="S116T13U2093">inveta</span>)</span>*<span class="mxinfo " id="T13:U1494">sqrt(<span class="mxinfo " id="T13:U1495"><span class="var type1" id="S32T13U2097">uno</span>-<span class="mxinfo " id="T13:U1497"><span class="var type1" id="S116T13U2099">inveta</span>*<span class="var type1" id="S98T13U2100">sti2</span></span></span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,352" id="srcline352">352</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,353" id="srcline353">353</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,354" id="srcline354">354</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T16:U1500"><span class="mxinfo " id="T6:U1501"><span class="var type1" id="S65T12U2107">flag</span>(<span class="mxinfo " id="T9:U1503">2</span>)</span> == <span class="mxinfo " id="T6:U1504">0</span></span>) || (<span class="mxinfo " id="T16:U1505"><span class="mxinfo " id="T6:U1506"><span class="var type1" id="S65T12U2113">flag</span>(<span class="mxinfo " id="T9:U1508">2</span>)</span> == <span class="mxinfo " id="T6:U1509">6</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,355" id="srcline355">355</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T16:U1510"><span class="mxinfo " id="T6:U1511"><span class="var type1" id="S65T12U2121">flag</span>(<span class="mxinfo " id="T9:U1513">2</span>)</span> == <span class="mxinfo " id="T6:U1514">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,356" id="srcline356">356</a></span><span class="line">                <span class="mxinfo " id="T13:U1515"><span class="var type1" id="S115T13U2126">sqes</span>   = <span class="mxinfo " id="T13:U1517">sqrt(<span class="mxinfo " id="T13:U1518">(<span class="mxinfo " id="T13:U1519">1/<span class="mxinfo " id="T13:U1520"><span class="var type1" id="S5T37U2134">eta</span>(<span class="mxinfo " id="T6:U1522"><span class="var type1" id="S35T15U2136">tff</span>(<span class="var type1" id="S85T6U2137">l</span>,<span class="mxinfo " id="T9:U1525">1</span>,<span class="mxinfo " id="T9:U1526">1</span>)</span>)</span></span>)-<span class="var type1" id="S107T13U2140">str2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,357" id="srcline357">357</a></span><span class="line">                <span class="mxinfo " id="T13:U1528"><span class="var type1" id="S116T13U2143">inveta</span> = <span class="mxinfo " id="T13:U1530"><span class="var type1" id="S5T37U2145">eta</span>(<span class="mxinfo " id="T6:U1532"><span class="var type1" id="S35T15U2147">tff</span>(<span class="var type1" id="S85T6U2148">l</span>,<span class="mxinfo " id="T9:U1535">1</span>,<span class="mxinfo " id="T9:U1536">1</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,358" id="srcline358">358</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,359" id="srcline359">359</a></span><span class="line">                <span class="mxinfo " id="T13:U1537"><span class="var type1" id="S115T13U2154">sqes</span>   = <span class="mxinfo " id="T13:U1539">sqrt(<span class="mxinfo " id="T13:U1540">(<span class="mxinfo " id="T13:U1541"><span class="mxinfo " id="T13:U1542"><span class="var type1" id="S5T37U2161">eta</span>(<span class="var type1" id="S89T6U2162">f2</span>)</span>/<span class="mxinfo " id="T13:U1545"><span class="var type1" id="S5T37U2164">eta</span>(<span class="mxinfo " id="T6:U1547"><span class="var type1" id="S35T15U2166">tff</span>(<span class="var type1" id="S85T6U2167">l</span>,<span class="mxinfo " id="T9:U1550">2</span>,<span class="mxinfo " id="T9:U1551">1</span>)</span>)</span></span>)-<span class="var type1" id="S107T13U2170">str2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,360" id="srcline360">360</a></span><span class="line">                <span class="mxinfo " id="T13:U1553"><span class="var type1" id="S116T13U2173">inveta</span> = <span class="mxinfo " id="T13:U1555"><span class="mxinfo " id="T13:U1556"><span class="var type1" id="S5T37U2176">eta</span>(<span class="mxinfo " id="T6:U1558"><span class="var type1" id="S35T15U2178">tff</span>(<span class="var type1" id="S85T6U2179">l</span>,<span class="mxinfo " id="T9:U1561">2</span>,<span class="mxinfo " id="T9:U1562">1</span>)</span>)</span>/<span class="mxinfo " id="T13:U1563"><span class="var type1" id="S5T37U2183">eta</span>(<span class="var type1" id="S89T6U2184">f2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,361" id="srcline361">361</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,362" id="srcline362">362</a></span><span class="line">            <span class="mxinfo " id="T13:U1566"><span class="mxinfo " id="T13:U1567"><span class="var type1" id="S83T35U2188">mTtt</span>(<span class="var type1" id="S85T6U2189">l</span>,<span class="mxinfo " id="T9:U1570">:</span>)</span>  = <span class="mxinfo " id="T13:U1571">(<span class="mxinfo " id="T13:U1572"><span class="mxinfo " id="T6:U1573">2</span>*<span class="var type1" id="S108T13U2195">ctr</span></span>)/(<span class="mxinfo " id="T13:U1575"><span class="var type1" id="S108T13U2198">ctr</span>+<span class="var type1" id="S115T13U2199">sqes</span></span>)</span></span>; <span class="comment">% parallel and perpendicular transmission coefficients at 2nd interface</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,363" id="srcline363">363</a></span><span class="line">            <span class="mxinfo " id="T13:U1578"><span class="mxinfo " id="T13:U1579"><span class="var type1" id="S84T35U2203">mTht</span>(<span class="var type1" id="S85T6U2204">l</span>,<span class="mxinfo " id="T9:U1582">:</span>)</span>  = <span class="mxinfo " id="T13:U1583">(<span class="mxinfo " id="T13:U1584"><span class="mxinfo " id="T13:U1585"><span class="mxinfo " id="T6:U1586">2</span>*<span class="mxinfo " id="T13:U1587">sqrt(<span class="var type1" id="S116T13U2213">inveta</span>)</span></span>*<span class="var type1" id="S108T13U2214">ctr</span></span>)/(<span class="mxinfo " id="T13:U1590"><span class="var type1" id="S108T13U2217">ctr</span>+<span class="mxinfo " id="T13:U1592"><span class="mxinfo " id="T13:U1593">sqrt(<span class="var type1" id="S116T13U2221">inveta</span>)</span>*<span class="mxinfo " id="T13:U1595">sqrt(<span class="mxinfo " id="T13:U1596"><span class="var type1" id="S32T13U2225">uno</span>-<span class="mxinfo " id="T13:U1598"><span class="var type1" id="S116T13U2227">inveta</span>*<span class="var type1" id="S107T13U2228">str2</span></span></span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,364" id="srcline364">364</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,365" id="srcline365">365</a></span><span class="line">        <span class="mxinfo " id="T6:U1601"><span class="var type1" id="S25T6U2231">msk</span>            = <span class="mxinfo " id="T6:U1603">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,366" id="srcline366">366</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,367" id="srcline367">367</a></span><span class="line">    <span class="mxinfo " id="T6:U1604"><span class="var type1" id="S85T6U2235">l</span>                  = <span class="mxinfo " id="T6:U1606"><span class="var type1" id="S85T6U2237">l</span>+<span class="mxinfo " id="T6:U1608">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,368" id="srcline368">368</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,369" id="srcline369">369</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,370" id="srcline370">370</a></span><span class="line"><span class="mxinfo " id="T6:U1609"><span class="var type1" id="S117T6U2241">mmask</span>                  = <span class="var type1" id="S25T6U2242">msk</span></span>; <span class="comment">% 1 -&gt; masking, 2 -&gt; penetration, and 0 -&gt; nothing</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,371" id="srcline371">371</a></span><span class="line"><span class="mxinfo " id="T6:U1612"><span class="var type1" id="S118T6U2245">mnpb</span>                   = <span class="var type1" id="S30T6U2246">cnt</span></span>; <span class="comment">% number of penetrations per path</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,372" id="srcline372">372</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,373" id="srcline373">373</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo " id="T16:U1615"><span class="var type1" id="S117T6U2251">mmask</span> == <span class="mxinfo " id="T6:U1617">2</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,374" id="srcline374">374</a></span><span class="line">   <span class="mxinfo " id="T1:U1618"><span class="var type1" id="S2T1U2255">m</span> = struct(<span class="string">'shi'</span>,<span class="var type1" id="S75T2U2259">mshi</span>,<span class="string">'sti'</span>,<span class="var type1" id="S73T2U2261">msti</span>,<span class="string">'stt'</span>,<span class="var type1" id="S74T2U2263">mstt</span>,<span class="string">'sht'</span>,<span class="var type1" id="S76T2U2265">msht</span>,<span class="string">'sho'</span>,<span class="var type1" id="S80T2U2267">msho</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,375" id="srcline375">375</a></span><span class="line">              <span class="string">'sto'</span>,<span class="var type1" id="S78T2U2269">msto</span>,<span class="string">'str'</span>,<span class="var type1" id="S77T2U2271">mstr</span>,<span class="string">'shr'</span>,<span class="var type1" id="S79T2U2273">mshr</span>,<span class="string">'Tti'</span>,<span class="var type1" id="S81T35U2275">mTti</span>,<span class="string">'Thi'</span>,<span class="var type1" id="S82T35U2277">mThi</span>,<span class="string">'Ttt'</span>,<span class="var type1" id="S83T35U2279">mTtt</span>,<span class="string">'Tht'</span>,<span class="var type1" id="S84T35U2281">mTht</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,376" id="srcline376">376</a></span><span class="line">              <span class="string">'ploss'</span>,<span class="var type1" id="S70T35U2283">mploss</span>,<span class="string">'pd'</span>,<span class="var type1" id="S71T4U2285">mpd</span>,<span class="string">'epd'</span>,<span class="var type1" id="S72T4U2287">mepd</span>,<span class="string">'nbpen'</span>,<span class="var type1" id="S68T4U2289">mnbpen</span>,<span class="string">'pflag'</span>,<span class="var type1" id="S69T34U2291">mpflag</span>,<span class="string">'mask'</span>,<span class="var type1" id="S117T6U2293">mmask</span>,<span class="string">'npb'</span>,<span class="var type1" id="S118T6U2295">mnpb</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,377" id="srcline377">377</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,378" id="srcline378">378</a></span><span class="line">    <span class="mxinfo " id="T1:U1639"><span class="var type1" id="S2T1U2299">m</span> = struct(<span class="string">'shi'</span>,<span class="mxinfo " id="T38:U1641">complex(<span class="mxinfo " id="T19:U1642">zeros(<span class="mxinfo " id="T6:U1643">1</span>,<span class="mxinfo " id="T6:U1644">3</span>)</span>,<span class="mxinfo " id="T19:U1645">zeros(<span class="mxinfo " id="T6:U1646">1</span>,<span class="mxinfo " id="T6:U1647">3</span>)</span>)</span>,<span class="string">'sti'</span>,<span class="mxinfo " id="T38:U1648">complex(<span class="mxinfo " id="T19:U1649">zeros(<span class="mxinfo " id="T6:U1650">1</span>,<span class="mxinfo " id="T6:U1651">3</span>)</span>,<span class="mxinfo " id="T19:U1652">zeros(<span class="mxinfo " id="T6:U1653">1</span>,<span class="mxinfo " id="T6:U1654">3</span>)</span>)</span>,<span class="string">'stt'</span>,<span class="mxinfo " id="T38:U1655">complex(<span class="mxinfo " id="T19:U1656">zeros(<span class="mxinfo " id="T6:U1657">1</span>,<span class="mxinfo " id="T6:U1658">3</span>)</span>,<span class="mxinfo " id="T19:U1659">zeros(<span class="mxinfo " id="T6:U1660">1</span>,<span class="mxinfo " id="T6:U1661">3</span>)</span>)</span>,<span class="string">'sht'</span>,<span class="mxinfo " id="T38:U1662">complex(<span class="mxinfo " id="T19:U1663">zeros(<span class="mxinfo " id="T6:U1664">1</span>,<span class="mxinfo " id="T6:U1665">3</span>)</span>,<span class="mxinfo " id="T19:U1666">zeros(<span class="mxinfo " id="T6:U1667">1</span>,<span class="mxinfo " id="T6:U1668">3</span>)</span>)</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,379" id="srcline379">379</a></span><span class="line">               <span class="string">'sho'</span>,<span class="mxinfo " id="T38:U1669">complex(<span class="mxinfo " id="T19:U1670">zeros(<span class="mxinfo " id="T6:U1671">1</span>,<span class="mxinfo " id="T6:U1672">3</span>)</span>,<span class="mxinfo " id="T19:U1673">zeros(<span class="mxinfo " id="T6:U1674">1</span>,<span class="mxinfo " id="T6:U1675">3</span>)</span>)</span>,<span class="string">'sto'</span>,<span class="mxinfo " id="T38:U1676">complex(<span class="mxinfo " id="T19:U1677">zeros(<span class="mxinfo " id="T6:U1678">1</span>,<span class="mxinfo " id="T6:U1679">3</span>)</span>,<span class="mxinfo " id="T19:U1680">zeros(<span class="mxinfo " id="T6:U1681">1</span>,<span class="mxinfo " id="T6:U1682">3</span>)</span>)</span>,<span class="string">'str'</span>,<span class="mxinfo " id="T38:U1683">complex(<span class="mxinfo " id="T19:U1684">zeros(<span class="mxinfo " id="T6:U1685">1</span>,<span class="mxinfo " id="T6:U1686">3</span>)</span>,<span class="mxinfo " id="T19:U1687">zeros(<span class="mxinfo " id="T6:U1688">1</span>,<span class="mxinfo " id="T6:U1689">3</span>)</span>)</span>,<span class="string">'shr'</span>,<span class="mxinfo " id="T38:U1690">complex(<span class="mxinfo " id="T19:U1691">zeros(<span class="mxinfo " id="T6:U1692">1</span>,<span class="mxinfo " id="T6:U1693">3</span>)</span>,<span class="mxinfo " id="T19:U1694">zeros(<span class="mxinfo " id="T6:U1695">1</span>,<span class="mxinfo " id="T6:U1696">3</span>)</span>)</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,380" id="srcline380">380</a></span><span class="line">               <span class="string">'Tti'</span>,<span class="mxinfo " id="T38:U1697">complex(<span class="mxinfo " id="T19:U1698">zeros(<span class="mxinfo " id="T6:U1699">1</span>,<span class="mxinfo " id="T6:U1700">3</span>)</span>,<span class="mxinfo " id="T19:U1701">zeros(<span class="mxinfo " id="T6:U1702">1</span>,<span class="mxinfo " id="T6:U1703">3</span>)</span>)</span>,<span class="string">'Thi'</span>,<span class="mxinfo " id="T38:U1704">complex(<span class="mxinfo " id="T19:U1705">zeros(<span class="mxinfo " id="T6:U1706">1</span>,<span class="mxinfo " id="T6:U1707">3</span>)</span>,<span class="mxinfo " id="T19:U1708">zeros(<span class="mxinfo " id="T6:U1709">1</span>,<span class="mxinfo " id="T6:U1710">3</span>)</span>)</span>,<span class="string">'Ttt'</span>,<span class="mxinfo " id="T38:U1711">complex(<span class="mxinfo " id="T19:U1712">zeros(<span class="mxinfo " id="T6:U1713">1</span>,<span class="mxinfo " id="T6:U1714">3</span>)</span>,<span class="mxinfo " id="T19:U1715">zeros(<span class="mxinfo " id="T6:U1716">1</span>,<span class="mxinfo " id="T6:U1717">3</span>)</span>)</span>,<span class="string">'Tht'</span>,<span class="mxinfo " id="T38:U1718">complex(<span class="mxinfo " id="T19:U1719">zeros(<span class="mxinfo " id="T6:U1720">1</span>,<span class="mxinfo " id="T6:U1721">3</span>)</span>,<span class="mxinfo " id="T19:U1722">zeros(<span class="mxinfo " id="T6:U1723">1</span>,<span class="mxinfo " id="T6:U1724">3</span>)</span>)</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,381" id="srcline381">381</a></span><span class="line">               <span class="string">'ploss'</span>,<span class="mxinfo " id="T38:U1725">complex(<span class="mxinfo " id="T19:U1726">zeros(<span class="mxinfo " id="T6:U1727">1</span>,<span class="mxinfo " id="T6:U1728">3</span>)</span>,<span class="mxinfo " id="T19:U1729">zeros(<span class="mxinfo " id="T6:U1730">1</span>,<span class="mxinfo " id="T6:U1731">3</span>)</span>)</span>,<span class="string">'pd'</span>,<span class="mxinfo " id="T6:U1732">0</span>,<span class="string">'epd'</span>,<span class="mxinfo " id="T6:U1733">0</span>,<span class="string">'nbpen'</span>,<span class="mxinfo " id="T6:U1734">0</span>,<span class="string">'pflag'</span>,<span class="mxinfo " id="T39:U1735">[]</span>,<span class="string">'mask'</span>,<span class="var type1" id="S117T6U2455">mmask</span>,<span class="string">'npb'</span>,<span class="var type1" id="S118T6U2457">mnpb</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,382" id="srcline382">382</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
</body>
</html>
