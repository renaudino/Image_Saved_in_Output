<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="35,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T5U3">Pbreak</span> = Breakthrough(<span class="var type1" id="S3T10U6">face</span>, <span class="var type1" id="S4T7U7">Pnneg_re</span>, <span class="var type1" id="S5T5U8">Pnpos_re</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="35,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% Calculates the breakthrough point in the face                                </span></span></span>
<span class="srcline"><span class="lineno"><a href="35,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% Pneg : point on the negative normal vector side                          </span></span></span>
<span class="srcline"><span class="lineno"><a href="35,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% Ppos : point on the positive normal vector side </span></span></span>
<span class="srcline"><span class="lineno"><a href="35,5" id="srcline5"> 5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% Authors: Francesco Mani &lt;francesco.mani@uclouvain.be&gt; and Mingming Gan &lt;gan@ftw.at&gt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">% History:  2011.9.19</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% Updated by: Xuhong Li &lt;xuhong@ftw.at&gt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,10" id="srcline10">10</a></span><span class="line"><span class="comment">% History: 2013.08.01</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,12" id="srcline12">12</a></span><span class="line"><span class="keyword">global</span> <span class="var type0" id="S6T0U10">wedges</span> <span class="var type0" id="S7T0U11">vnfaces</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T5:U5"><span class="var type1" id="S8T5U14">wedges_re</span> = <span class="mxinfo " id="T5:U7">zeros(<span class="mxinfo " id="T1:U8">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T7:U9"><span class="var type1" id="S10T7U21">Pnneg</span> = <span class="var type1" id="S4T7U22">Pnneg_re</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T5:U12"><span class="var type1" id="S11T5U25">Pnpos</span> = <span class="var type1" id="S5T5U26">Pnpos_re</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T5:U15"><span class="var type1" id="S2T5U29">Pbreak</span> = <span class="mxinfo " id="T5:U17">zeros(<span class="mxinfo " id="T1:U18">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T5:U19"><span class="var type1" id="S12T5U36">n</span> = <span class="mxinfo " id="T5:U21">zeros(<span class="mxinfo " id="T1:U22">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T5:U23"><span class="var type1" id="S13T5U43">rp</span> = <span class="mxinfo " id="T5:U25">zeros(<span class="mxinfo " id="T1:U26">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T5:U27"><span class="var type1" id="S14T5U50">ri</span> = <span class="mxinfo " id="T5:U29">zeros(<span class="mxinfo " id="T1:U30">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,20" id="srcline20">20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,21" id="srcline21">21</a></span><span class="line"><span class="comment">% if(face(1) == 0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,22" id="srcline22">22</a></span><span class="line"><span class="keyword">if</span>(<span class="mxinfo " id="T12:U31"><span class="mxinfo " id="T1:U32"><span class="var type1" id="S3T10U61">face</span>(<span class="mxinfo " id="T3:U34">1</span>)</span> == <span class="mxinfo " id="T1:U35">0</span></span> &amp;&amp; <span class="mxinfo " id="T12:U36"><span class="mxinfo " id="T1:U37"><span class="var type1" id="S3T10U66">face</span>(<span class="mxinfo " id="T3:U39">2</span>)</span> == <span class="mxinfo " id="T1:U40">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="35,23" id="srcline23">23</a></span><span class="line">    <span class="mxinfo " id="T5:U41"><span class="var type1" id="S12T5U71">n</span> = <span class="mxinfo " id="T5:U43">[<span class="mxinfo " id="T1:U44">0</span>;<span class="mxinfo " id="T1:U45">0</span>;<span class="mxinfo " id="T1:U46">1</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,24" id="srcline24">24</a></span><span class="line">    <span class="mxinfo " id="T5:U47"><span class="mxinfo " id="T5:U48"><span class="var type1" id="S13T5U82">rp</span>(<span class="mxinfo " id="T6:U50">:</span>,<span class="mxinfo " id="T1:U51">1</span>)</span> = <span class="mxinfo " id="T5:U52">-<span class="mxinfo " id="T5:U53"><span class="var type1" id="S11T5U87">Pnpos</span>(<span class="mxinfo " id="T6:U55">:</span>,<span class="mxinfo " id="T1:U56">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,25" id="srcline25">25</a></span><span class="line">    <span class="mxinfo " id="T5:U57"><span class="mxinfo " id="T5:U58"><span class="var type1" id="S14T5U93">ri</span>(<span class="mxinfo " id="T6:U60">:</span>,<span class="mxinfo " id="T1:U61">1</span>)</span> = <span class="mxinfo " id="T5:U62"><span class="mxinfo " id="T1:U63"><span class="var type1" id="S10T7U98">Pnneg</span>(<span class="mxinfo " id="T3:U65">:</span>,<span class="mxinfo " id="T1:U66">1</span>)</span> - <span class="mxinfo " id="T5:U67"><span class="var type1" id="S11T5U102">Pnpos</span>(<span class="mxinfo " id="T6:U69">:</span>,<span class="mxinfo " id="T1:U70">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,26" id="srcline26">26</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo " id="T5:U71"><span class="mxinfo " id="T5:U72"><span class="var type1" id="S12T5U109">n</span>(<span class="mxinfo " id="T6:U74">:</span>,<span class="mxinfo " id="T1:U75">1</span>)</span> = <span class="mxinfo " id="T7:U76"><span class="var type1" id="S7T17U113">vnfaces</span>(<span class="mxinfo " id="T1:U78"><span class="var type1" id="S3T10U115">face</span>(<span class="mxinfo " id="T3:U80">1</span>)</span>,<span class="mxinfo " id="T1:U81"><span class="var type1" id="S3T10U118">face</span>(<span class="mxinfo " id="T3:U83">2</span>)</span>,<span class="mxinfo " id="T6:U84">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo " id="T5:U85"><span class="mxinfo " id="T5:U86"><span class="var type1" id="S8T5U124">wedges_re</span>(<span class="mxinfo " id="T6:U88">:</span>,<span class="mxinfo " id="T1:U89">1</span>)</span> = <span class="mxinfo " id="T13:U90"><span class="var type1" id="S6T15U128">wedges</span>(<span class="mxinfo " id="T1:U92"><span class="var type1" id="S3T10U130">face</span>(<span class="mxinfo " id="T3:U94">1</span>)</span>,<span class="mxinfo " id="T1:U95"><span class="var type1" id="S3T10U133">face</span>(<span class="mxinfo " id="T3:U97">2</span>)</span>,<span class="mxinfo " id="T1:U98">3</span>,<span class="mxinfo " id="T6:U99">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo " id="T5:U100"><span class="mxinfo " id="T5:U101"><span class="var type1" id="S13T5U140">rp</span>(<span class="mxinfo " id="T6:U103">:</span>,<span class="mxinfo " id="T1:U104">1</span>)</span> = <span class="mxinfo " id="T5:U105"><span class="var type1" id="S8T5U144">wedges_re</span> - <span class="mxinfo " id="T5:U107"><span class="var type1" id="S11T5U146">Pnpos</span>(<span class="mxinfo " id="T6:U109">:</span>,<span class="mxinfo " id="T1:U110">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo " id="T5:U111"><span class="mxinfo " id="T5:U112"><span class="var type1" id="S14T5U152">ri</span>(<span class="mxinfo " id="T6:U114">:</span>,<span class="mxinfo " id="T1:U115">1</span>)</span> = <span class="mxinfo " id="T5:U116"><span class="mxinfo " id="T1:U117"><span class="var type1" id="S10T7U157">Pnneg</span>(<span class="mxinfo " id="T3:U119">:</span>,<span class="mxinfo " id="T1:U120">1</span>)</span> - <span class="mxinfo " id="T5:U121"><span class="var type1" id="S11T5U161">Pnpos</span>(<span class="mxinfo " id="T6:U123">:</span>,<span class="mxinfo " id="T1:U124">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,31" id="srcline31">31</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,32" id="srcline32">32</a></span><span class="line"><span class="comment">%num = dot(n,rp);</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,33" id="srcline33">33</a></span><span class="line"><span class="comment">%den = dot(n,ri);</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo " id="T1:U125"><span class="var type1" id="S15T1U166">num</span> = <span class="mxinfo " id="T1:U127"><span class="mxinfo " id="T9:U128"><span class="var type1" id="S12T5U169">n</span>'</span>*<span class="var type1" id="S13T5U170">rp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T1:U131"><span class="var type1" id="S16T1U173">den</span> = <span class="mxinfo " id="T1:U133"><span class="mxinfo " id="T9:U134"><span class="var type1" id="S12T5U176">n</span>'</span>*<span class="var type1" id="S14T5U177">ri</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo " id="T5:U137"><span class="mxinfo " id="T5:U138"><span class="var type1" id="S2T5U181">Pbreak</span>(<span class="mxinfo " id="T6:U140">:</span>,<span class="mxinfo " id="T1:U141">1</span>)</span> = <span class="mxinfo " id="T5:U142"><span class="mxinfo " id="T5:U143"><span class="var type1" id="S11T5U186">Pnpos</span>(<span class="mxinfo " id="T6:U145">:</span>,<span class="mxinfo " id="T1:U146">1</span>)</span> + <span class="mxinfo " id="T5:U147">(<span class="mxinfo " id="T1:U148"><span class="var type1" id="S15T1U192">num</span>/<span class="var type1" id="S16T1U193">den</span></span>)*<span class="mxinfo " id="T5:U151"><span class="var type1" id="S14T5U195">ri</span>(<span class="mxinfo " id="T6:U153">:</span>,<span class="mxinfo " id="T3:U154">1</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,37" id="srcline37">37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,38" id="srcline38">38</a></span><span class="line">      </span></span>
</pre>
