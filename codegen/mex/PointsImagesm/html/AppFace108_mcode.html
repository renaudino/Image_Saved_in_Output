<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="40,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">appface</span> = AppFace(<span class="var type1" id="S3T5U6">point_re</span>,<span class="var type1" id="S4T2U7">face</span>) <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% Calculates if the point belongs to the face</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,3" id="srcline3"> 3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="40,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% Authors: Francesco Mani &lt;francesco.mani@uclouvain.be&gt; and Mingming Gan &lt;gan@ftw.at&gt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% History:  2011.9.19</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,6" id="srcline6"> 6</a></span><span class="line"><span class="keyword">global</span> <span class="var type0" id="S5T0U9">wedges</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,7" id="srcline7"> 7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="40,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T5:U4"><span class="var type1" id="S6T5U12">point</span> = <span class="mxinfo " id="T5:U6">reshape(<span class="var type1" id="S3T5U15">point_re</span>,3,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T5:U8"><span class="var type1" id="S8T5U20">VectP1</span> = <span class="mxinfo " id="T5:U10">zeros(<span class="mxinfo " id="T1:U11">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T5:U12"><span class="var type1" id="S10T5U27">VectP2</span> = <span class="mxinfo " id="T5:U14">zeros(<span class="mxinfo " id="T1:U15">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,11" id="srcline11">11</a></span><span class="line"><span class="mxinfo " id="T5:U16"><span class="var type1" id="S11T5U34">VectP4</span> = <span class="mxinfo " id="T5:U18">zeros(<span class="mxinfo " id="T1:U19">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T5:U20"><span class="var type1" id="S12T5U41">u</span> = <span class="mxinfo " id="T5:U22">zeros(<span class="mxinfo " id="T1:U23">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T5:U24"><span class="var type1" id="S13T5U48">v</span> = <span class="mxinfo " id="T5:U26">zeros(<span class="mxinfo " id="T1:U27">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,14" id="srcline14">14</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="40,15" id="srcline15">15</a></span><span class="line"><span class="comment">%p1(:,1) = wedges(face(1),face(2),1,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,16" id="srcline16">16</a></span><span class="line"><span class="comment">%p2(:,1) = wedges(face(1),face(2),2,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,17" id="srcline17">17</a></span><span class="line"><span class="comment">%p3(:,1) = wedges(face(1),face(2),4,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,18" id="srcline18">18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="40,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T5:U28"><span class="var type1" id="S14T5U55">p1</span> = <span class="mxinfo " id="T5:U30">reshape(<span class="mxinfo " id="T13:U31"><span class="var type1" id="S5T15U59">wedges</span>(<span class="mxinfo " id="T1:U33"><span class="var type1" id="S4T2U61">face</span>(<span class="mxinfo " id="T3:U35">1</span>)</span>,<span class="mxinfo " id="T1:U36"><span class="var type1" id="S4T2U64">face</span>(<span class="mxinfo " id="T3:U38">2</span>)</span>,<span class="mxinfo " id="T3:U39">1</span>,<span class="mxinfo " id="T6:U40">:</span>)</span>,3,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo " id="T5:U41"><span class="var type1" id="S15T5U72">p2</span> = <span class="mxinfo " id="T5:U43">reshape(<span class="mxinfo " id="T13:U44"><span class="var type1" id="S5T15U76">wedges</span>(<span class="mxinfo " id="T1:U46"><span class="var type1" id="S4T2U78">face</span>(<span class="mxinfo " id="T3:U48">1</span>)</span>,<span class="mxinfo " id="T1:U49"><span class="var type1" id="S4T2U81">face</span>(<span class="mxinfo " id="T3:U51">2</span>)</span>,<span class="mxinfo " id="T3:U52">2</span>,<span class="mxinfo " id="T6:U53">:</span>)</span>,3,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T5:U54"><span class="var type1" id="S16T5U89">p3</span> = <span class="mxinfo " id="T5:U56">reshape(<span class="mxinfo " id="T13:U57"><span class="var type1" id="S5T15U93">wedges</span>(<span class="mxinfo " id="T1:U59"><span class="var type1" id="S4T2U95">face</span>(<span class="mxinfo " id="T3:U61">1</span>)</span>,<span class="mxinfo " id="T1:U62"><span class="var type1" id="S4T2U98">face</span>(<span class="mxinfo " id="T3:U64">2</span>)</span>,<span class="mxinfo " id="T3:U65">4</span>,<span class="mxinfo " id="T6:U66">:</span>)</span>,3,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,22" id="srcline22">22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="40,23" id="srcline23">23</a></span><span class="line"><span class="comment">%u(:,1) = wedges(face(1),face(2),2,:) - wedges(face(1),face(2),1,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,24" id="srcline24">24</a></span><span class="line"><span class="comment">%v(:,1) = wedges(face(1),face(2),4,:) - wedges(face(1),face(2),1,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T5:U67"><span class="mxinfo " id="T5:U68"><span class="var type1" id="S12T5U107">u</span>(<span class="mxinfo " id="T6:U70">:</span>,<span class="mxinfo " id="T3:U71">1</span>)</span> = <span class="mxinfo " id="T5:U72"><span class="var type1" id="S15T5U111">p2</span> - <span class="var type1" id="S14T5U112">p1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo " id="T5:U75"><span class="mxinfo " id="T5:U76"><span class="var type1" id="S13T5U116">v</span>(<span class="mxinfo " id="T6:U78">:</span>,<span class="mxinfo " id="T3:U79">1</span>)</span> = <span class="mxinfo " id="T5:U80"><span class="var type1" id="S16T5U120">p3</span> - <span class="var type1" id="S14T5U121">p1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,27" id="srcline27">27</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="40,28" id="srcline28">28</a></span><span class="line"><span class="mxinfo " id="T5:U83"><span class="mxinfo " id="T5:U84"><span class="var type1" id="S8T5U125">VectP1</span>(<span class="mxinfo " id="T6:U86">:</span>,<span class="mxinfo " id="T3:U87">1</span>)</span> = <span class="mxinfo " id="T5:U88"><span class="var type1" id="S14T5U129">p1</span> - <span class="var type1" id="S6T5U130">point</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,29" id="srcline29">29</a></span><span class="line"><span class="mxinfo " id="T5:U91"><span class="mxinfo " id="T5:U92"><span class="var type1" id="S10T5U134">VectP2</span>(<span class="mxinfo " id="T6:U94">:</span>,<span class="mxinfo " id="T3:U95">1</span>)</span> = <span class="mxinfo " id="T5:U96"><span class="var type1" id="S15T5U138">p2</span> - <span class="var type1" id="S6T5U139">point</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo " id="T5:U99"><span class="mxinfo " id="T5:U100"><span class="var type1" id="S11T5U143">VectP4</span>(<span class="mxinfo " id="T6:U102">:</span>,<span class="mxinfo " id="T3:U103">1</span>)</span> = <span class="mxinfo " id="T5:U104"><span class="var type1" id="S16T5U147">p3</span> - <span class="var type1" id="S6T5U148">point</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,31" id="srcline31">31</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="40,32" id="srcline32">32</a></span><span class="line"><span class="comment">%resu1 = dot(VectP1,u);</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,33" id="srcline33">33</a></span><span class="line"><span class="comment">%resu2 = dot(VectP2,u);</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo " id="T1:U107"><span class="var type1" id="S17T1U151">resu1</span> = <span class="mxinfo " id="T1:U109"><span class="mxinfo " id="T9:U110"><span class="var type1" id="S8T5U154">VectP1</span>'</span>*<span class="var type1" id="S12T5U155">u</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T1:U113"><span class="var type1" id="S18T1U158">resu2</span> = <span class="mxinfo " id="T1:U115"><span class="mxinfo " id="T9:U116"><span class="var type1" id="S10T5U161">VectP2</span>'</span>*<span class="var type1" id="S12T5U162">u</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo " id="T1:U119"><span class="var type1" id="S19T1U165">test1</span> = <span class="mxinfo " id="T1:U121"><span class="var type1" id="S17T1U167">resu1</span>*<span class="var type1" id="S18T1U168">resu2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,37" id="srcline37">37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="40,38" id="srcline38">38</a></span><span class="line"><span class="comment">%resu1 = dot(VectP1,v);</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,39" id="srcline39">39</a></span><span class="line"><span class="comment">%resu2 = dot(VectP4,v);</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,40" id="srcline40">40</a></span><span class="line"><span class="mxinfo " id="T1:U124"><span class="var type1" id="S17T1U171">resu1</span> = <span class="mxinfo " id="T1:U126"><span class="mxinfo " id="T9:U127"><span class="var type1" id="S8T5U174">VectP1</span>'</span>*<span class="var type1" id="S13T5U175">v</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,41" id="srcline41">41</a></span><span class="line"><span class="mxinfo " id="T1:U130"><span class="var type1" id="S18T1U178">resu2</span> = <span class="mxinfo " id="T1:U132"><span class="mxinfo " id="T9:U133"><span class="var type1" id="S11T5U181">VectP4</span>'</span>*<span class="var type1" id="S13T5U182">v</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,42" id="srcline42">42</a></span><span class="line"><span class="mxinfo " id="T1:U136"><span class="var type1" id="S20T1U185">test2</span> = <span class="mxinfo " id="T1:U138"><span class="var type1" id="S17T1U187">resu1</span>*<span class="var type1" id="S18T1U188">resu2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,43" id="srcline43">43</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="40,44" id="srcline44">44</a></span><span class="line"><span class="mxinfo " id="T1:U141"><span class="var type1" id="S21T1U191">det</span>  = <span class="mxinfo " id="T1:U143"><span class="mxinfo " id="T1:U144"><span class="mxinfo " id="T1:U145">(<span class="mxinfo " id="T1:U146"><span class="mxinfo " id="T1:U147">(<span class="mxinfo " id="T1:U148"><span class="mxinfo " id="T1:U149"><span class="var type1" id="S15T5U201">p2</span>(<span class="mxinfo " id="T3:U151">2</span>)</span>-<span class="mxinfo " id="T1:U152"><span class="var type1" id="S14T5U204">p1</span>(<span class="mxinfo " id="T1:U154">2</span>)</span></span>)*(<span class="mxinfo " id="T1:U155"><span class="mxinfo " id="T1:U156"><span class="var type1" id="S16T5U209">p3</span>(<span class="mxinfo " id="T1:U158">3</span>)</span>-<span class="mxinfo " id="T1:U159"><span class="var type1" id="S14T5U212">p1</span>(<span class="mxinfo " id="T1:U161">3</span>)</span></span>)</span>-<span class="mxinfo " id="T1:U162">(<span class="mxinfo " id="T1:U163"><span class="mxinfo " id="T1:U164"><span class="var type1" id="S16T5U218">p3</span>(<span class="mxinfo " id="T1:U166">2</span>)</span>-<span class="mxinfo " id="T1:U167"><span class="var type1" id="S14T5U221">p1</span>(<span class="mxinfo " id="T1:U169">2</span>)</span></span>)*(<span class="mxinfo " id="T1:U170"><span class="mxinfo " id="T1:U171"><span class="var type1" id="S15T5U226">p2</span>(<span class="mxinfo " id="T1:U173">3</span>)</span>-<span class="mxinfo " id="T1:U174"><span class="var type1" id="S14T5U229">p1</span>(<span class="mxinfo " id="T1:U176">3</span>)</span></span>)</span></span>)*(<span class="mxinfo " id="T1:U177"><span class="mxinfo " id="T1:U178"><span class="var type1" id="S6T5U234">point</span>(<span class="mxinfo " id="T1:U180">1</span>)</span>-<span class="mxinfo " id="T1:U181"><span class="var type1" id="S14T5U237">p1</span>(<span class="mxinfo " id="T1:U183">1</span>)</span></span>)</span> + <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,45" id="srcline45">45</a></span><span class="line">       <span class="mxinfo " id="T1:U184">(<span class="mxinfo " id="T1:U185"><span class="mxinfo " id="T1:U186">(<span class="mxinfo " id="T1:U187"><span class="mxinfo " id="T1:U188"><span class="var type1" id="S15T5U246">p2</span>(<span class="mxinfo " id="T1:U190">3</span>)</span>-<span class="mxinfo " id="T1:U191"><span class="var type1" id="S14T5U249">p1</span>(<span class="mxinfo " id="T1:U193">3</span>)</span></span>)*(<span class="mxinfo " id="T1:U194"><span class="mxinfo " id="T1:U195"><span class="var type1" id="S16T5U254">p3</span>(<span class="mxinfo " id="T1:U197">1</span>)</span>-<span class="mxinfo " id="T1:U198"><span class="var type1" id="S14T5U257">p1</span>(<span class="mxinfo " id="T1:U200">1</span>)</span></span>)</span>-<span class="mxinfo " id="T1:U201">(<span class="mxinfo " id="T1:U202"><span class="mxinfo " id="T1:U203"><span class="var type1" id="S16T5U263">p3</span>(<span class="mxinfo " id="T1:U205">3</span>)</span>-<span class="mxinfo " id="T1:U206"><span class="var type1" id="S14T5U266">p1</span>(<span class="mxinfo " id="T1:U208">3</span>)</span></span>)*(<span class="mxinfo " id="T1:U209"><span class="mxinfo " id="T1:U210"><span class="var type1" id="S15T5U271">p2</span>(<span class="mxinfo " id="T1:U212">1</span>)</span>-<span class="mxinfo " id="T1:U213"><span class="var type1" id="S14T5U274">p1</span>(<span class="mxinfo " id="T1:U215">1</span>)</span></span>)</span></span>)*(<span class="mxinfo " id="T1:U216"><span class="mxinfo " id="T1:U217"><span class="var type1" id="S6T5U279">point</span>(<span class="mxinfo " id="T1:U219">2</span>)</span>-<span class="mxinfo " id="T1:U220"><span class="var type1" id="S14T5U282">p1</span>(<span class="mxinfo " id="T1:U222">2</span>)</span></span>)</span></span> + <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="40,46" id="srcline46">46</a></span><span class="line">       <span class="mxinfo " id="T1:U223">(<span class="mxinfo " id="T1:U224"><span class="mxinfo " id="T1:U225">(<span class="mxinfo " id="T1:U226"><span class="mxinfo " id="T1:U227"><span class="var type1" id="S15T5U291">p2</span>(<span class="mxinfo " id="T1:U229">1</span>)</span>-<span class="mxinfo " id="T1:U230"><span class="var type1" id="S14T5U294">p1</span>(<span class="mxinfo " id="T1:U232">1</span>)</span></span>)*(<span class="mxinfo " id="T1:U233"><span class="mxinfo " id="T1:U234"><span class="var type1" id="S16T5U299">p3</span>(<span class="mxinfo " id="T1:U236">2</span>)</span>-<span class="mxinfo " id="T1:U237"><span class="var type1" id="S14T5U302">p1</span>(<span class="mxinfo " id="T1:U239">2</span>)</span></span>)</span>-<span class="mxinfo " id="T1:U240">(<span class="mxinfo " id="T1:U241"><span class="mxinfo " id="T1:U242"><span class="var type1" id="S16T5U308">p3</span>(<span class="mxinfo " id="T1:U244">1</span>)</span>-<span class="mxinfo " id="T1:U245"><span class="var type1" id="S14T5U311">p1</span>(<span class="mxinfo " id="T1:U247">1</span>)</span></span>)*(<span class="mxinfo " id="T1:U248"><span class="mxinfo " id="T1:U249"><span class="var type1" id="S15T5U316">p2</span>(<span class="mxinfo " id="T1:U251">2</span>)</span>-<span class="mxinfo " id="T1:U252"><span class="var type1" id="S14T5U319">p1</span>(<span class="mxinfo " id="T1:U254">2</span>)</span></span>)</span></span>)*(<span class="mxinfo " id="T1:U255"><span class="mxinfo " id="T1:U256"><span class="var type1" id="S6T5U324">point</span>(<span class="mxinfo " id="T1:U258">3</span>)</span>-<span class="mxinfo " id="T1:U259"><span class="var type1" id="S14T5U327">p1</span>(<span class="mxinfo " id="T1:U261">3</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,47" id="srcline47">47</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="40,48" id="srcline48">48</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo " id="T12:U262"><span class="var type1" id="S19T1U335">test1</span> &lt;= <span class="mxinfo " id="T1:U264">1.0e-10</span></span>) &amp;&amp; (<span class="mxinfo " id="T12:U265"><span class="var type1" id="S20T1U339">test2</span> &lt;= <span class="mxinfo " id="T1:U267">1.0e-10</span></span>) &amp;&amp; (<span class="mxinfo " id="T12:U268"><span class="mxinfo " id="T1:U269">abs(<span class="var type1" id="S21T1U345">det</span>)</span> &lt;= <span class="mxinfo " id="T1:U271">1.0e-8</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="40,49" id="srcline49">49</a></span><span class="line">    <span class="mxinfo " id="T1:U272"><span class="var type1" id="S2T1U349">appface</span> = <span class="mxinfo " id="T1:U274">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,50" id="srcline50">50</a></span><span class="line"><span class="keyword">else</span> </span></span>
<span class="srcline"><span class="lineno"><a href="40,51" id="srcline51">51</a></span><span class="line">    <span class="mxinfo " id="T1:U275"><span class="var type1" id="S2T1U354">appface</span> = <span class="mxinfo " id="T1:U277">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="40,52" id="srcline52">52</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
