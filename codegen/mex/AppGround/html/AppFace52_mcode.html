<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="24,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">appface</span> = AppFace(<span class="var type1" id="S3T3U6">point_re</span>,<span class="var type1" id="S4T4U7">face</span>) <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="24,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% Calculates if the point belongs to the face</span></span></span>
<span class="srcline"><span class="lineno"><a href="24,3" id="srcline3"> 3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="24,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% Authors: Francesco Mani &lt;francesco.mani@uclouvain.be&gt; and Mingming Gan &lt;gan@ftw.at&gt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="24,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% History:  2011.9.19</span></span></span>
<span class="srcline"><span class="lineno"><a href="24,6" id="srcline6"> 6</a></span><span class="line"><span class="keyword">global</span> <span class="var type1" id="S5T2U9">wedges</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,7" id="srcline7"> 7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="24,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo" id="T3:U5"><span class="var type1" id="S6T3U12">point</span> = <span class="mxinfo" id="T3:U7">reshape(<span class="var type1" id="S3T3U15">point_re</span>,3,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo" id="T3:U9"><span class="var type1" id="S8T3U20">VectP1</span> = <span class="mxinfo" id="T3:U11">zeros(<span class="mxinfo" id="T1:U12">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo" id="T3:U13"><span class="var type1" id="S10T3U27">VectP2</span> = <span class="mxinfo" id="T3:U15">zeros(<span class="mxinfo" id="T1:U16">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,11" id="srcline11">11</a></span><span class="line"><span class="mxinfo" id="T3:U17"><span class="var type1" id="S11T3U34">VectP4</span> = <span class="mxinfo" id="T3:U19">zeros(<span class="mxinfo" id="T1:U20">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo" id="T3:U21"><span class="var type1" id="S12T3U41">u</span> = <span class="mxinfo" id="T3:U23">zeros(<span class="mxinfo" id="T1:U24">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo" id="T3:U25"><span class="var type1" id="S13T3U48">v</span> = <span class="mxinfo" id="T3:U27">zeros(<span class="mxinfo" id="T1:U28">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,14" id="srcline14">14</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="24,15" id="srcline15">15</a></span><span class="line"><span class="comment">%p1(:,1) = wedges(face(1),face(2),1,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="24,16" id="srcline16">16</a></span><span class="line"><span class="comment">%p2(:,1) = wedges(face(1),face(2),2,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="24,17" id="srcline17">17</a></span><span class="line"><span class="comment">%p3(:,1) = wedges(face(1),face(2),4,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="24,18" id="srcline18">18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="24,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo" id="T3:U29"><span class="var type1" id="S14T3U55">p1</span> = <span class="mxinfo" id="T3:U31">reshape(<span class="mxinfo" id="T11:U32"><span class="var type1" id="S5T2U59">wedges</span>(<span class="mxinfo" id="T1:U34"><span class="var type1" id="S4T4U61">face</span>(<span class="mxinfo" id="T1:U36">1</span>)</span>,<span class="mxinfo" id="T1:U37"><span class="var type1" id="S4T4U64">face</span>(<span class="mxinfo" id="T1:U39">2</span>)</span>,<span class="mxinfo" id="T1:U40">1</span>,:)</span>,3,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo" id="T3:U41"><span class="var type1" id="S15T3U72">p2</span> = <span class="mxinfo" id="T3:U43">reshape(<span class="mxinfo" id="T11:U44"><span class="var type1" id="S5T2U76">wedges</span>(<span class="mxinfo" id="T1:U46"><span class="var type1" id="S4T4U78">face</span>(<span class="mxinfo" id="T1:U48">1</span>)</span>,<span class="mxinfo" id="T1:U49"><span class="var type1" id="S4T4U81">face</span>(<span class="mxinfo" id="T1:U51">2</span>)</span>,<span class="mxinfo" id="T1:U52">2</span>,:)</span>,3,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo" id="T3:U53"><span class="var type1" id="S16T3U89">p3</span> = <span class="mxinfo" id="T3:U55">reshape(<span class="mxinfo" id="T11:U56"><span class="var type1" id="S5T2U93">wedges</span>(<span class="mxinfo" id="T1:U58"><span class="var type1" id="S4T4U95">face</span>(<span class="mxinfo" id="T1:U60">1</span>)</span>,<span class="mxinfo" id="T1:U61"><span class="var type1" id="S4T4U98">face</span>(<span class="mxinfo" id="T1:U63">2</span>)</span>,<span class="mxinfo" id="T1:U64">4</span>,:)</span>,3,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,22" id="srcline22">22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="24,23" id="srcline23">23</a></span><span class="line"><span class="comment">%u(:,1) = wedges(face(1),face(2),2,:) - wedges(face(1),face(2),1,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="24,24" id="srcline24">24</a></span><span class="line"><span class="comment">%v(:,1) = wedges(face(1),face(2),4,:) - wedges(face(1),face(2),1,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="24,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo" id="T3:U65"><span class="mxinfo" id="T3:U66"><span class="var type1" id="S12T3U107">u</span>(:,<span class="mxinfo" id="T1:U68">1</span>)</span> = <span class="mxinfo" id="T3:U69"><span class="var type1" id="S15T3U111">p2</span> - <span class="var type1" id="S14T3U112">p1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo" id="T3:U72"><span class="mxinfo" id="T3:U73"><span class="var type1" id="S13T3U116">v</span>(:,<span class="mxinfo" id="T1:U75">1</span>)</span> = <span class="mxinfo" id="T3:U76"><span class="var type1" id="S16T3U120">p3</span> - <span class="var type1" id="S14T3U121">p1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,27" id="srcline27">27</a></span><span class="line">  </span></span>
<span class="srcline"><span class="lineno"><a href="24,28" id="srcline28">28</a></span><span class="line"><span class="mxinfo" id="T3:U79"><span class="mxinfo" id="T3:U80"><span class="var type1" id="S8T3U125">VectP1</span>(:,<span class="mxinfo" id="T1:U82">1</span>)</span> = <span class="mxinfo" id="T3:U83"><span class="var type1" id="S14T3U129">p1</span> - <span class="var type1" id="S6T3U130">point</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,29" id="srcline29">29</a></span><span class="line"><span class="mxinfo" id="T3:U86"><span class="mxinfo" id="T3:U87"><span class="var type1" id="S10T3U134">VectP2</span>(:,<span class="mxinfo" id="T1:U89">1</span>)</span> = <span class="mxinfo" id="T3:U90"><span class="var type1" id="S15T3U138">p2</span> - <span class="var type1" id="S6T3U139">point</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo" id="T3:U93"><span class="mxinfo" id="T3:U94"><span class="var type1" id="S11T3U143">VectP4</span>(:,<span class="mxinfo" id="T1:U96">1</span>)</span> = <span class="mxinfo" id="T3:U97"><span class="var type1" id="S16T3U147">p3</span> - <span class="var type1" id="S6T3U148">point</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,31" id="srcline31">31</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="24,32" id="srcline32">32</a></span><span class="line"><span class="comment">%resu1 = dot(VectP1,u);</span></span></span>
<span class="srcline"><span class="lineno"><a href="24,33" id="srcline33">33</a></span><span class="line"><span class="comment">%resu2 = dot(VectP2,u);</span></span></span>
<span class="srcline"><span class="lineno"><a href="24,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo" id="T1:U100"><span class="var type1" id="S17T1U151">resu1</span> = <span class="mxinfo" id="T1:U102"><span class="mxinfo" id="T12:U103"><span class="var type1" id="S8T3U154">VectP1</span>'</span>*<span class="var type1" id="S12T3U155">u</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo" id="T1:U106"><span class="var type1" id="S18T1U158">resu2</span> = <span class="mxinfo" id="T1:U108"><span class="mxinfo" id="T12:U109"><span class="var type1" id="S10T3U161">VectP2</span>'</span>*<span class="var type1" id="S12T3U162">u</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo" id="T1:U112"><span class="var type1" id="S19T1U165">test1</span> = <span class="mxinfo" id="T1:U114"><span class="var type1" id="S17T1U167">resu1</span>*<span class="var type1" id="S18T1U168">resu2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,37" id="srcline37">37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="24,38" id="srcline38">38</a></span><span class="line"><span class="comment">%resu1 = dot(VectP1,v);</span></span></span>
<span class="srcline"><span class="lineno"><a href="24,39" id="srcline39">39</a></span><span class="line"><span class="comment">%resu2 = dot(VectP4,v);</span></span></span>
<span class="srcline"><span class="lineno"><a href="24,40" id="srcline40">40</a></span><span class="line"><span class="mxinfo" id="T1:U117"><span class="var type1" id="S17T1U171">resu1</span> = <span class="mxinfo" id="T1:U119"><span class="mxinfo" id="T12:U120"><span class="var type1" id="S8T3U174">VectP1</span>'</span>*<span class="var type1" id="S13T3U175">v</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,41" id="srcline41">41</a></span><span class="line"><span class="mxinfo" id="T1:U123"><span class="var type1" id="S18T1U178">resu2</span> = <span class="mxinfo" id="T1:U125"><span class="mxinfo" id="T12:U126"><span class="var type1" id="S11T3U181">VectP4</span>'</span>*<span class="var type1" id="S13T3U182">v</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,42" id="srcline42">42</a></span><span class="line"><span class="mxinfo" id="T1:U129"><span class="var type1" id="S20T1U185">test2</span> = <span class="mxinfo" id="T1:U131"><span class="var type1" id="S17T1U187">resu1</span>*<span class="var type1" id="S18T1U188">resu2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,43" id="srcline43">43</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="24,44" id="srcline44">44</a></span><span class="line"><span class="mxinfo" id="T1:U134"><span class="var type1" id="S21T1U191">det</span>  = <span class="mxinfo" id="T1:U136"><span class="mxinfo" id="T1:U137"><span class="mxinfo" id="T1:U138">(<span class="mxinfo" id="T1:U139"><span class="mxinfo" id="T1:U140">(<span class="mxinfo" id="T1:U141"><span class="mxinfo" id="T1:U142"><span class="var type1" id="S15T3U201">p2</span>(<span class="mxinfo" id="T1:U144">2</span>)</span>-<span class="mxinfo" id="T1:U145"><span class="var type1" id="S14T3U204">p1</span>(<span class="mxinfo" id="T1:U147">2</span>)</span></span>)*(<span class="mxinfo" id="T1:U148"><span class="mxinfo" id="T1:U149"><span class="var type1" id="S16T3U209">p3</span>(<span class="mxinfo" id="T1:U151">3</span>)</span>-<span class="mxinfo" id="T1:U152"><span class="var type1" id="S14T3U212">p1</span>(<span class="mxinfo" id="T1:U154">3</span>)</span></span>)</span>-<span class="mxinfo" id="T1:U155">(<span class="mxinfo" id="T1:U156"><span class="mxinfo" id="T1:U157"><span class="var type1" id="S16T3U218">p3</span>(<span class="mxinfo" id="T1:U159">2</span>)</span>-<span class="mxinfo" id="T1:U160"><span class="var type1" id="S14T3U221">p1</span>(<span class="mxinfo" id="T1:U162">2</span>)</span></span>)*(<span class="mxinfo" id="T1:U163"><span class="mxinfo" id="T1:U164"><span class="var type1" id="S15T3U226">p2</span>(<span class="mxinfo" id="T1:U166">3</span>)</span>-<span class="mxinfo" id="T1:U167"><span class="var type1" id="S14T3U229">p1</span>(<span class="mxinfo" id="T1:U169">3</span>)</span></span>)</span></span>)*(<span class="mxinfo" id="T1:U170"><span class="mxinfo" id="T1:U171"><span class="var type1" id="S6T3U234">point</span>(<span class="mxinfo" id="T1:U173">1</span>)</span>-<span class="mxinfo" id="T1:U174"><span class="var type1" id="S14T3U237">p1</span>(<span class="mxinfo" id="T1:U176">1</span>)</span></span>)</span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="24,45" id="srcline45">45</a></span><span class="line"><span class="mxinfo" id="T1:U134"><span class="mxinfo" id="T1:U136"><span class="mxinfo" id="T1:U137">       <span class="mxinfo" id="T1:U177">(<span class="mxinfo" id="T1:U178"><span class="mxinfo" id="T1:U179">(<span class="mxinfo" id="T1:U180"><span class="mxinfo" id="T1:U181"><span class="var type1" id="S15T3U246">p2</span>(<span class="mxinfo" id="T1:U183">3</span>)</span>-<span class="mxinfo" id="T1:U184"><span class="var type1" id="S14T3U249">p1</span>(<span class="mxinfo" id="T1:U186">3</span>)</span></span>)*(<span class="mxinfo" id="T1:U187"><span class="mxinfo" id="T1:U188"><span class="var type1" id="S16T3U254">p3</span>(<span class="mxinfo" id="T1:U190">1</span>)</span>-<span class="mxinfo" id="T1:U191"><span class="var type1" id="S14T3U257">p1</span>(<span class="mxinfo" id="T1:U193">1</span>)</span></span>)</span>-<span class="mxinfo" id="T1:U194">(<span class="mxinfo" id="T1:U195"><span class="mxinfo" id="T1:U196"><span class="var type1" id="S16T3U263">p3</span>(<span class="mxinfo" id="T1:U198">3</span>)</span>-<span class="mxinfo" id="T1:U199"><span class="var type1" id="S14T3U266">p1</span>(<span class="mxinfo" id="T1:U201">3</span>)</span></span>)*(<span class="mxinfo" id="T1:U202"><span class="mxinfo" id="T1:U203"><span class="var type1" id="S15T3U271">p2</span>(<span class="mxinfo" id="T1:U205">1</span>)</span>-<span class="mxinfo" id="T1:U206"><span class="var type1" id="S14T3U274">p1</span>(<span class="mxinfo" id="T1:U208">1</span>)</span></span>)</span></span>)*(<span class="mxinfo" id="T1:U209"><span class="mxinfo" id="T1:U210"><span class="var type1" id="S6T3U279">point</span>(<span class="mxinfo" id="T1:U212">2</span>)</span>-<span class="mxinfo" id="T1:U213"><span class="var type1" id="S14T3U282">p1</span>(<span class="mxinfo" id="T1:U215">2</span>)</span></span>)</span></span> + <span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="24,46" id="srcline46">46</a></span><span class="line"><span class="mxinfo" id="T1:U134"><span class="mxinfo" id="T1:U136">       <span class="mxinfo" id="T1:U216">(<span class="mxinfo" id="T1:U217"><span class="mxinfo" id="T1:U218">(<span class="mxinfo" id="T1:U219"><span class="mxinfo" id="T1:U220"><span class="var type1" id="S15T3U291">p2</span>(<span class="mxinfo" id="T1:U222">1</span>)</span>-<span class="mxinfo" id="T1:U223"><span class="var type1" id="S14T3U294">p1</span>(<span class="mxinfo" id="T1:U225">1</span>)</span></span>)*(<span class="mxinfo" id="T1:U226"><span class="mxinfo" id="T1:U227"><span class="var type1" id="S16T3U299">p3</span>(<span class="mxinfo" id="T1:U229">2</span>)</span>-<span class="mxinfo" id="T1:U230"><span class="var type1" id="S14T3U302">p1</span>(<span class="mxinfo" id="T1:U232">2</span>)</span></span>)</span>-<span class="mxinfo" id="T1:U233">(<span class="mxinfo" id="T1:U234"><span class="mxinfo" id="T1:U235"><span class="var type1" id="S16T3U308">p3</span>(<span class="mxinfo" id="T1:U237">1</span>)</span>-<span class="mxinfo" id="T1:U238"><span class="var type1" id="S14T3U311">p1</span>(<span class="mxinfo" id="T1:U240">1</span>)</span></span>)*(<span class="mxinfo" id="T1:U241"><span class="mxinfo" id="T1:U242"><span class="var type1" id="S15T3U316">p2</span>(<span class="mxinfo" id="T1:U244">2</span>)</span>-<span class="mxinfo" id="T1:U245"><span class="var type1" id="S14T3U319">p1</span>(<span class="mxinfo" id="T1:U247">2</span>)</span></span>)</span></span>)*(<span class="mxinfo" id="T1:U248"><span class="mxinfo" id="T1:U249"><span class="var type1" id="S6T3U324">point</span>(<span class="mxinfo" id="T1:U251">3</span>)</span>-<span class="mxinfo" id="T1:U252"><span class="var type1" id="S14T3U327">p1</span>(<span class="mxinfo" id="T1:U254">3</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,47" id="srcline47">47</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="24,48" id="srcline48">48</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo" id="T9:U255"><span class="var type1" id="S19T1U335">test1</span> &lt;= <span class="mxinfo" id="T1:U257">1.0e-10</span></span>) &amp;&amp; (<span class="mxinfo" id="T9:U258"><span class="var type1" id="S20T1U339">test2</span> &lt;= <span class="mxinfo" id="T1:U260">1.0e-10</span></span>) &amp;&amp; (<span class="mxinfo" id="T9:U261"><span class="mxinfo" id="T1:U262">abs(<span class="var type1" id="S21T1U345">det</span>)</span> &lt;= <span class="mxinfo" id="T1:U264">1.0e-8</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="24,49" id="srcline49">49</a></span><span class="line">    <span class="mxinfo" id="T1:U265"><span class="var type1" id="S2T1U349">appface</span> = <span class="mxinfo" id="T1:U267">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,50" id="srcline50">50</a></span><span class="line"><span class="keyword">else</span> </span></span>
<span class="srcline"><span class="lineno"><a href="24,51" id="srcline51">51</a></span><span class="line">    <span class="mxinfo" id="T1:U268"><span class="var type1" id="S2T1U354">appface</span> = <span class="mxinfo" id="T1:U270">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="24,52" id="srcline52">52</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
